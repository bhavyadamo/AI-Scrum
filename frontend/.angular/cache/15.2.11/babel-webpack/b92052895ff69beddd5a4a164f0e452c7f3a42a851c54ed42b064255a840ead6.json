{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport { WorkItem } from '../../models/task.model';\nimport { debounceTime, distinctUntilChanged } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"../../services/estimation.service\";\nimport * as i3 from \"../../services/task.service\";\nimport * as i4 from \"@angular/common\";\nfunction TaskEstimationComponent_div_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 49)(1, \"small\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r0.iterationError);\n  }\n}\nfunction TaskEstimationComponent_span_30_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 50);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r1.workItems.length, \" items\");\n  }\n}\nfunction TaskEstimationComponent_div_32_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 51)(1, \"div\", 52)(2, \"span\", 53);\n    i0.ɵɵtext(3, \"Loading work items...\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"p\", 54);\n    i0.ɵɵtext(5, \"Loading work items...\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction TaskEstimationComponent_div_33_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 51)(1, \"p\", 55);\n    i0.ɵɵtext(2, \"No work items found. Please select an iteration path and click \\\"Load Items\\\".\");\n    i0.ɵɵelementEnd()();\n  }\n}\nconst _c0 = function (a0, a1, a2, a3, a4, a5, a6) {\n  return {\n    \"bg-danger\": a0,\n    \"bg-primary\": a1,\n    \"bg-warning\": a2,\n    \"bg-info\": a3,\n    \"bg-success\": a4,\n    \"bg-dark text-light\": a5,\n    \"bg-secondary\": a6\n  };\n};\nconst _c1 = function (a0, a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11) {\n  return {\n    \"badge-code-review\": a0,\n    \"badge-dev-new\": a1,\n    \"bg-info\": a2,\n    \"bg-primary\": a3,\n    \"bg-success\": a4,\n    \"bg-warning\": a5,\n    \"bg-danger\": a6,\n    \"bg-dark\": a7,\n    \"badge-ready\": a8,\n    \"badge-assigned\": a9,\n    \"bg-info text-white\": a10,\n    \"badge-na\": a11\n  };\n};\nfunction TaskEstimationComponent_div_34_tr_15_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r22 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\", 60);\n    i0.ɵɵlistener(\"click\", function TaskEstimationComponent_div_34_tr_15_Template_tr_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r22);\n      const item_r20 = restoredCtx.$implicit;\n      const ctx_r21 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r21.selectWorkItem(item_r20));\n    });\n    i0.ɵɵelementStart(1, \"td\", 61);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\")(4, \"span\", 62);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"td\")(9, \"small\");\n    i0.ɵɵelement(10, \"i\", 63);\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"td\")(13, \"span\", 64);\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const item_r20 = ctx.$implicit;\n    const ctx_r19 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassProp(\"table-primary\", (ctx_r19.selectedWorkItem == null ? null : ctx_r19.selectedWorkItem.id) === item_r20.id);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"#\", item_r20.id, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction7(9, _c0, item_r20.type === \"Bug\" || item_r20.fields && item_r20.fields[\"System.WorkItemType\"] === \"Bug\", item_r20.type === \"Feature\" || item_r20.fields && item_r20.fields[\"System.WorkItemType\"] === \"Feature\", item_r20.type === \"Change Request\" || item_r20.fields && item_r20.fields[\"System.WorkItemType\"] === \"Change Request\", item_r20.type === \"Test\" || item_r20.fields && item_r20.fields[\"System.WorkItemType\"] === \"Test\", item_r20.type === \"Requirement\" || item_r20.fields && item_r20.fields[\"System.WorkItemType\"] === \"Requirement\", item_r20.type === \"User Story\" || item_r20.fields && item_r20.fields[\"System.WorkItemType\"] === \"User Story\", !item_r20.type && (!item_r20.fields || !item_r20.fields[\"System.WorkItemType\"])));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(item_r20.fields && item_r20.fields[\"System.WorkItemType\"] || item_r20.type || \"Task\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r20.title);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r19.getAssigneeName(item_r20) || \"Unassigned\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunctionV(17, _c1, [ctx_r19.getStateDisplay(item_r20) && ctx_r19.getStateDisplay(item_r20).toLowerCase() === \"code review\", ctx_r19.getStateDisplay(item_r20) && ctx_r19.getStateDisplay(item_r20).toLowerCase() === \"dev-new\", ctx_r19.getStateDisplay(item_r20) && ctx_r19.getStateDisplay(item_r20).toLowerCase().includes(\"review\") && ctx_r19.getStateDisplay(item_r20).toLowerCase() !== \"code review\", ctx_r19.getStateDisplay(item_r20) && ctx_r19.getStateDisplay(item_r20).toLowerCase().includes(\"progress\"), ctx_r19.getStateDisplay(item_r20) && (ctx_r19.getStateDisplay(item_r20).toLowerCase().includes(\"complete\") || ctx_r19.getStateDisplay(item_r20).toLowerCase().includes(\"done\")), ctx_r19.getStateDisplay(item_r20) && (ctx_r19.getStateDisplay(item_r20).toLowerCase().includes(\"pending\") || ctx_r19.getStateDisplay(item_r20).toLowerCase().includes(\"wait\")), ctx_r19.getStateDisplay(item_r20) && (ctx_r19.getStateDisplay(item_r20).toLowerCase().includes(\"fail\") || ctx_r19.getStateDisplay(item_r20).toLowerCase().includes(\"block\")), ctx_r19.getStateDisplay(item_r20) && ctx_r19.getStateDisplay(item_r20).toLowerCase().includes(\"new\") && ctx_r19.getStateDisplay(item_r20).toLowerCase() !== \"dev-new\", ctx_r19.getStateDisplay(item_r20) && ctx_r19.getStateDisplay(item_r20).toLowerCase().includes(\"ready\"), ctx_r19.getStateDisplay(item_r20) && ctx_r19.getStateDisplay(item_r20).toLowerCase().includes(\"assign\"), ctx_r19.getStateDisplay(item_r20) && (ctx_r19.getStateDisplay(item_r20).toLowerCase().includes(\"test\") || ctx_r19.getStateDisplay(item_r20).toLowerCase().includes(\"review\") && ctx_r19.getStateDisplay(item_r20).toLowerCase() !== \"code review\"), !ctx_r19.getStateDisplay(item_r20) || ctx_r19.getStateDisplay(item_r20) === \"N/A\"]));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r19.getStateDisplay(item_r20) || \"N/A\");\n  }\n}\nfunction TaskEstimationComponent_div_34_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 56)(1, \"table\", 57)(2, \"thead\")(3, \"tr\")(4, \"th\", 58);\n    i0.ɵɵtext(5, \"ID\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"th\", 58);\n    i0.ɵɵtext(7, \"Type\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"th\", 58);\n    i0.ɵɵtext(9, \"Title\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"th\", 58);\n    i0.ɵɵtext(11, \"Assignee\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"th\", 58);\n    i0.ɵɵtext(13, \"State\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(14, \"tbody\");\n    i0.ɵɵtemplate(15, TaskEstimationComponent_div_34_tr_15_Template, 15, 30, \"tr\", 59);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(15);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r4.workItems);\n  }\n}\nfunction TaskEstimationComponent_span_39_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"Task #\", ctx_r5.selectedWorkItem.id, \" Details\");\n  }\n}\nfunction TaskEstimationComponent_span_40_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Task Details\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TaskEstimationComponent_button_48_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r24 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 65);\n    i0.ɵɵlistener(\"click\", function TaskEstimationComponent_button_48_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r23 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r23.resetForm());\n    });\n    i0.ɵɵelement(1, \"i\", 66);\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TaskEstimationComponent_div_49_small_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\");\n    i0.ɵɵtext(1, \"Title is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TaskEstimationComponent_div_49_small_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\");\n    i0.ɵɵtext(1, \"Title must be at least 5 characters\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TaskEstimationComponent_div_49_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 67);\n    i0.ɵɵtemplate(1, TaskEstimationComponent_div_49_small_1_Template, 2, 0, \"small\", 22);\n    i0.ɵɵtemplate(2, TaskEstimationComponent_div_49_small_2_Template, 2, 0, \"small\", 22);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext();\n    let tmp_0_0;\n    let tmp_1_0;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", (tmp_0_0 = ctx_r8.estimationForm.get(\"title\")) == null ? null : tmp_0_0.errors == null ? null : tmp_0_0.errors[\"required\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", (tmp_1_0 = ctx_r8.estimationForm.get(\"title\")) == null ? null : tmp_1_0.errors == null ? null : tmp_1_0.errors[\"minlength\"]);\n  }\n}\nfunction TaskEstimationComponent_div_50_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 68)(1, \"small\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r9 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Found matching work item #\", ctx_r9.selectedWorkItem.id, \"\");\n  }\n}\nfunction TaskEstimationComponent_option_57_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 69);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const type_r27 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", type_r27);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(type_r27);\n  }\n}\nfunction TaskEstimationComponent_option_65_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 69);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const member_r28 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", member_r28);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(member_r28);\n  }\n}\nfunction TaskEstimationComponent_div_70_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 70);\n    i0.ɵɵelement(1, \"input\", 71);\n    i0.ɵɵelementStart(2, \"label\", 72);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const level_r29 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"id\", \"complexity-\" + level_r29.toLowerCase())(\"value\", level_r29);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"for\", \"complexity-\" + level_r29.toLowerCase());\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", level_r29, \" \");\n  }\n}\nfunction TaskEstimationComponent_div_71_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 73)(1, \"small\");\n    i0.ɵɵelement(2, \"i\", 74);\n    i0.ɵɵtext(3, \" Complexity automatically predicted based on work item attributes\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction TaskEstimationComponent_span_77_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵelement(1, \"i\", 75);\n    i0.ɵɵtext(2, \" Estimate Time \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TaskEstimationComponent_span_78_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵelement(1, \"span\", 76);\n    i0.ɵɵtext(2, \" Estimating... \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TaskEstimationComponent_div_81_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 77);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r16 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r16.error, \" \");\n  }\n}\nfunction TaskEstimationComponent_div_82_li_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 91);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const factor_r31 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", factor_r31, \" \");\n  }\n}\nfunction TaskEstimationComponent_div_82_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 5)(1, \"div\", 78)(2, \"h4\", 7);\n    i0.ɵɵtext(3, \"Estimation Results\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"div\", 8)(5, \"div\", 17)(6, \"div\", 10)(7, \"div\", 79)(8, \"h2\", 80);\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"p\", 55);\n    i0.ɵɵtext(11, \"Total estimated time\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"div\", 81)(13, \"div\", 82)(14, \"div\", 83)(15, \"h3\", 3);\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"p\", 84);\n    i0.ɵɵtext(18, \"Development Time\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(19, \"div\", 82)(20, \"div\", 83)(21, \"h3\", 3);\n    i0.ɵɵtext(22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(23, \"p\", 84);\n    i0.ɵɵtext(24, \"Testing Time\");\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(25, \"div\", 85)(26, \"h5\");\n    i0.ɵɵtext(27, \"Prediction Confidence\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(28, \"div\", 86)(29, \"div\", 87);\n    i0.ɵɵtext(30);\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(31, \"div\", 10)(32, \"h5\");\n    i0.ɵɵtext(33, \"Factors Considered\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(34, \"ul\", 88);\n    i0.ɵɵtemplate(35, TaskEstimationComponent_div_82_li_35_Template, 2, 1, \"li\", 89);\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(36, \"div\", 90);\n    i0.ɵɵelement(37, \"i\", 74);\n    i0.ɵɵtext(38, \" These estimates are based on historical work item data from Azure DevOps, analyzing completed tasks with similar characteristics. \");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r17 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(9);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r17.estimationResult.estimatedHours, \" hours\");\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate(ctx_r17.devTimeEstimate);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(ctx_r17.testTimeEstimate);\n    i0.ɵɵadvance(7);\n    i0.ɵɵstyleProp(\"width\", ctx_r17.estimationResult.confidenceScore * 100, \"%\");\n    i0.ɵɵproperty(\"ngClass\", ctx_r17.getConfidenceClass(ctx_r17.estimationResult.confidenceScore));\n    i0.ɵɵattribute(\"aria-valuenow\", ctx_r17.estimationResult.confidenceScore * 100);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r17.formatConfidence(ctx_r17.estimationResult.confidenceScore), \" \");\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r17.estimationResult.factors);\n  }\n}\nfunction TaskEstimationComponent_div_83_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 92)(1, \"div\", 93);\n    i0.ɵɵelement(2, \"i\", 94);\n    i0.ɵɵelementStart(3, \"h4\", 95);\n    i0.ɵɵtext(4, \"Task Time Prediction\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\", 55);\n    i0.ɵɵtext(6, \"Fill in the task details and click \\\"Estimate Time\\\" to get an ML-based time estimate\");\n    i0.ɵɵelementEnd()()();\n  }\n}\nconst _c2 = function (a0) {\n  return {\n    \"is-valid\": a0\n  };\n};\nexport class TaskEstimationComponent {\n  constructor(fb, estimationService, taskService) {\n    this.fb = fb;\n    this.estimationService = estimationService;\n    this.taskService = taskService;\n    this.teamMembers = [];\n    // Include all available work item types from the enum\n    this.taskTypes = ['User Story', 'Task', 'Bug', 'Epic', 'Feature', 'Issue', 'Change Request', 'Documentation', 'Test', 'Research'];\n    this.complexityLevels = ['Low', 'Medium', 'High'];\n    this.loading = false;\n    this.error = null;\n    this.estimationResult = null;\n    this.showResult = false;\n    // New properties for iteration path functionality\n    this.manualIterationPath = ''; // Only use manual iteration path\n    this.workItems = [];\n    this.loadingIterationItems = false;\n    this.iterationError = null;\n    this.selectedWorkItem = null;\n    this.devTimeEstimate = 0;\n    this.testTimeEstimate = 0;\n    this.totalEstimate = 0;\n    this.estimationForm = this.fb.group({\n      title: ['', [Validators.required, Validators.minLength(5)]],\n      type: ['Feature', Validators.required],\n      assignee: [''],\n      complexity: ['Medium', Validators.required]\n    });\n  }\n  ngOnInit() {\n    // Load team members\n    this.loadTeamMembers();\n    // Listen for title changes to auto-fill fields\n    this.estimationForm.get('title')?.valueChanges.pipe(debounceTime(300), distinctUntilChanged()).subscribe(title => {\n      if (title && title.length > 5) {\n        this.autoPopulateFormFields(title);\n      }\n    });\n  }\n  // Load team members with better error handling\n  loadTeamMembers() {\n    this.taskService.getTeamMembers().subscribe({\n      next: response => {\n        console.log('Team members API response:', response);\n        if (Array.isArray(response)) {\n          if (response.length === 0) {\n            console.warn('No team members returned from API');\n            return;\n          }\n          if (typeof response[0] === 'string') {\n            // It's an array of strings\n            this.teamMembers = response;\n          } else {\n            // It's an array of TeamMember objects\n            this.teamMembers = response.filter(m => m && m.displayName) // Filter out invalid entries\n            .map(m => m.displayName);\n          }\n          // Add some failsafe common users based on the work items we've seen\n          const commonUsers = ['Bhavya Damodharan', 'Suresh GM', 'Ranjith Kumar S', 'Vignesh Ram Suresh kumar', 'Dinesh Kumar K'];\n          // Add any common users not already in the list\n          commonUsers.forEach(user => {\n            if (!this.teamMembers.includes(user)) {\n              this.teamMembers.push(user);\n            }\n          });\n          console.log(`Loaded ${this.teamMembers.length} team members:`, this.teamMembers);\n        }\n      },\n      error: err => {\n        console.error('Error loading team members:', err);\n        this.error = 'Failed to load team members';\n        // Fallback to a default list of common users\n        this.teamMembers = ['Bhavya Damodharan', 'Suresh GM', 'Ranjith Kumar S', 'Vignesh Ram Suresh kumar', 'Dinesh Kumar K'];\n        console.log('Using fallback team members list:', this.teamMembers);\n      }\n    });\n  }\n  // Auto-populate form fields based on entered title\n  autoPopulateFormFields(title) {\n    if (!this.workItems || this.workItems.length === 0) {\n      return; // No items to search through\n    }\n    // Find matching work item by title (full or partial match)\n    const matchingItem = this.workItems.find(item => item.title.toLowerCase().includes(title.toLowerCase()) || title.toLowerCase().includes(item.title.toLowerCase()));\n    if (matchingItem) {\n      this.selectedWorkItem = matchingItem;\n      this.populateFormWithWorkItem(matchingItem);\n    }\n  }\n  // Load work items for the selected iteration path\n  loadWorkItemsByIteration() {\n    if (!this.manualIterationPath || this.manualIterationPath.trim() === '') {\n      this.iterationError = 'Please enter an iteration path';\n      return;\n    }\n    this.loadingIterationItems = true;\n    this.workItems = [];\n    this.selectedWorkItem = null;\n    this.iterationError = null;\n    this.taskService.getTasks(this.manualIterationPath.trim()).subscribe({\n      next: items => {\n        // Process items to clean up state information\n        this.workItems = items.map(item => {\n          // Process each item to ensure it has proper state\n          const processedItem = {\n            ...item\n          };\n          // Make sure the fields object exists\n          if (!processedItem.fields) {\n            processedItem.fields = {};\n          }\n          // Fix state display - remove \"Unknown\" prefix if present\n          if (processedItem.state && processedItem.state.toLowerCase().includes('unknown')) {\n            processedItem.state = processedItem.state.replace(/unknown/i, '').trim();\n          }\n          // Also check for state in fields\n          if (processedItem.fields && processedItem.fields['System.State']) {\n            let state = processedItem.fields['System.State'];\n            if (typeof state === 'string' && state.toLowerCase().includes('unknown')) {\n              state = state.replace(/unknown/i, '').trim();\n              processedItem.fields['System.State'] = state;\n            }\n            // If item has no state but has System.State, use it\n            if (!processedItem.state) {\n              processedItem.state = state;\n            }\n          }\n          // Capture status field if present in the payload and map it to fields\n          if (item.status) {\n            processedItem.fields['status'] = item.status;\n          }\n          return processedItem;\n        });\n        this.loadingIterationItems = false;\n        console.log(`Loaded ${this.workItems.length} work items for iteration ${this.manualIterationPath}`);\n      },\n      error: err => {\n        console.error('Error loading work items:', err);\n        this.iterationError = 'Failed to load work items for the specified iteration path';\n        this.loadingIterationItems = false;\n      }\n    });\n  }\n  // Helper method to find the best matching team member for an assignee\n  findMatchingTeamMember(assigneeName) {\n    if (!assigneeName || !this.teamMembers || this.teamMembers.length === 0) {\n      return '';\n    }\n    console.log('Finding match for assignee:', assigneeName);\n    // First try exact match\n    const exactMatch = this.teamMembers.find(member => member === assigneeName);\n    if (exactMatch) {\n      console.log('Found exact match:', exactMatch);\n      return exactMatch;\n    }\n    // Then try case-insensitive exact match\n    const caseInsensitiveMatch = this.teamMembers.find(member => member.toLowerCase() === assigneeName.toLowerCase());\n    if (caseInsensitiveMatch) {\n      console.log('Found case-insensitive match:', caseInsensitiveMatch);\n      return caseInsensitiveMatch;\n    }\n    // Then try contains matches (member contains assignee or assignee contains member)\n    const containsMatch = this.teamMembers.find(member => member.toLowerCase().includes(assigneeName.toLowerCase()) || assigneeName.toLowerCase().includes(member.toLowerCase()));\n    if (containsMatch) {\n      console.log('Found contains match:', containsMatch);\n      return containsMatch;\n    }\n    // Split full names and try to match individual parts\n    // This helps with formats like \"First Last\" vs \"Last, First\"\n    const nameParts = assigneeName.toLowerCase().split(/[\\s,]+/).filter(part => part.length > 1);\n    if (nameParts.length > 1) {\n      console.log('Trying to match name parts:', nameParts);\n      // Try to find a member that contains all name parts\n      const allPartsMatch = this.teamMembers.find(member => {\n        const memberLower = member.toLowerCase();\n        return nameParts.every(part => memberLower.includes(part));\n      });\n      if (allPartsMatch) {\n        console.log('Found match containing all name parts:', allPartsMatch);\n        return allPartsMatch;\n      }\n      // Try to find a member that contains any significant name part\n      for (const part of nameParts) {\n        if (part.length < 3) continue; // Skip short parts like initials\n        const partialMatch = this.teamMembers.find(member => member.toLowerCase().includes(part));\n        if (partialMatch) {\n          console.log('Found match with name part:', part, '->', partialMatch);\n          return partialMatch;\n        }\n      }\n    }\n    // If we have a name that appears to be \"Firstname Lastname\"\n    // Try a more aggressive match against first letters + full last name\n    if (nameParts.length >= 2) {\n      const firstInitial = nameParts[0].charAt(0);\n      const lastName = nameParts[nameParts.length - 1];\n      const initialsMatch = this.teamMembers.find(member => {\n        const memberParts = member.toLowerCase().split(/[\\s,]+/);\n        if (memberParts.length >= 2) {\n          const memberFirstInitial = memberParts[0].charAt(0);\n          const memberLastName = memberParts[memberParts.length - 1];\n          return memberFirstInitial === firstInitial && memberLastName.includes(lastName);\n        }\n        return false;\n      });\n      if (initialsMatch) {\n        console.log('Found match with first initial + last name:', initialsMatch);\n        return initialsMatch;\n      }\n    }\n    // Last resort: try to match any word of length 4+ as a potential name fragment\n    const significantWords = assigneeName.toLowerCase().match(/\\b\\w{4,}\\b/g);\n    if (significantWords && significantWords.length > 0) {\n      for (const word of significantWords) {\n        const wordMatch = this.teamMembers.find(member => member.toLowerCase().includes(word));\n        if (wordMatch) {\n          console.log('Found match with significant word:', word, '->', wordMatch);\n          return wordMatch;\n        }\n      }\n    }\n    // If no match found after all attempts, return the original name\n    console.log('No match found, using original name:', assigneeName);\n    return assigneeName;\n  }\n  // Select a work item for estimation\n  selectWorkItem(item) {\n    this.selectedWorkItem = item;\n    this.populateFormWithWorkItem(item);\n  }\n  // Populate the form with selected work item details\n  populateFormWithWorkItem(item) {\n    const complexity = this.determineComplexity(item);\n    // Extract assignee name, trying 'System.AssignedTo' first\n    let assignee = '';\n    let originalAssignee = '';\n    // Debug log the item details\n    console.log('Selected work item:', item);\n    // Check for fields property which might contain System.AssignedTo\n    if (item.fields && item.fields['System.AssignedTo']) {\n      const assignedTo = item.fields['System.AssignedTo'];\n      if (typeof assignedTo === 'string') {\n        originalAssignee = assignedTo;\n        assignee = assignedTo;\n      } else if (typeof assignedTo === 'object' && assignedTo !== null) {\n        // Try to get displayName property\n        if (assignedTo.displayName) {\n          originalAssignee = assignedTo.displayName;\n          assignee = assignedTo.displayName;\n        }\n      }\n    }\n    // Check for direct assignee property which is most common in Azure DevOps API\n    else if (item.assignedTo) {\n      originalAssignee = typeof item.assignedTo === 'string' ? item.assignedTo : item.assignedTo.displayName || '';\n      assignee = originalAssignee;\n    }\n    console.log('Original assignee from work item:', originalAssignee);\n    console.log('Available team members:', this.teamMembers);\n    // If we have an assignee name, find the matching team member\n    if (assignee) {\n      const previousAssignee = assignee;\n      assignee = this.findMatchingTeamMember(assignee);\n      console.log(`Matching team member: '${previousAssignee}' -> '${assignee}'`);\n    }\n    // Get type, trying both System.WorkItemType and type property\n    let itemType = '';\n    // First try to get from Azure DevOps fields\n    if (item.fields) {\n      if (item.fields['System.WorkItemType']) {\n        itemType = item.fields['System.WorkItemType'];\n      }\n    }\n    // If not found, fallback to type property\n    if (!itemType && item.type) {\n      itemType = item.type;\n    }\n    // If still not found, try to determine from title\n    if (!itemType) {\n      const title = item.title.toLowerCase();\n      if (title.includes('bug') || title.includes('fix') || title.includes('issue')) {\n        itemType = 'Bug';\n      } else if (title.includes('feature') || title.includes('implement') || title.includes('add new')) {\n        itemType = 'Feature';\n      } else if (title.includes('change') || title.includes('modify') || title.includes('update')) {\n        itemType = 'Change Request';\n      } else if (title.includes('requirement') || title.includes('must have')) {\n        itemType = 'Requirement';\n      } else {\n        // Default to Feature\n        itemType = 'Feature';\n      }\n    }\n    // Ensure the type is available in our task types list\n    if (itemType && !this.taskTypes.includes(itemType)) {\n      // Add to taskTypes if not already there\n      this.taskTypes.push(itemType);\n    }\n    // Update form with extracted values\n    this.estimationForm.patchValue({\n      title: item.title,\n      type: itemType,\n      assignee: assignee,\n      complexity: complexity\n    });\n    console.log(`Populated form with: Type=${itemType}, Assignee=${assignee}, Complexity=${complexity}`);\n    // Pre-calculate estimates based on historical data if we have this information\n    if (this.estimationResult) {\n      this.calculateTimeEstimates(this.estimationResult.estimatedHours);\n    }\n  }\n  // Determine complexity based on work item properties with enhanced logic\n  determineComplexity(item) {\n    // Initialize with default complexity\n    let complexity = 'Medium';\n    // Try to determine from title keywords\n    const title = item.title.toLowerCase();\n    if (title.includes('critical') || title.includes('urgent') || title.includes('major') || title.includes('performance issue') || title.includes('security')) {\n      return 'High';\n    }\n    if (title.includes('minor') || title.includes('small') || title.includes('trivial') || title.includes('documentation') || title.includes('typo')) {\n      return 'Low';\n    }\n    // Determine from type\n    const itemType = this.getWorkItemType(item);\n    if (itemType === 'Bug' || itemType === 'Change Request' || itemType === 'Feature') {\n      // Bugs and change requests tend to be more complex\n      complexity = 'Medium';\n      // For bugs, increase complexity\n      if (itemType === 'Bug') {\n        complexity = 'High';\n      }\n    }\n    // Determine from priority if available\n    if (item.priority !== undefined) {\n      if (item.priority <= 1) {\n        complexity = 'High';\n      } else if (item.priority === 2) {\n        complexity = 'Medium';\n      } else {\n        complexity = 'Low';\n      }\n    }\n    // Check for complexity field if available in Azure DevOps fields\n    if (item.fields) {\n      // Different systems use different field names for complexity/effort\n      const complexityFields = ['Microsoft.VSTS.Common.Complexity', 'Microsoft.VSTS.Scheduling.Effort', 'Custom.Complexity', 'System.Complexity'];\n      for (const field of complexityFields) {\n        if (item.fields[field]) {\n          const fieldValue = item.fields[field];\n          if (typeof fieldValue === 'string') {\n            if (fieldValue.includes('High') || fieldValue.includes('1')) {\n              return 'High';\n            } else if (fieldValue.includes('Low') || fieldValue.includes('3')) {\n              return 'Low';\n            }\n          } else if (typeof fieldValue === 'number') {\n            if (fieldValue <= 1) {\n              return 'High';\n            } else if (fieldValue >= 3) {\n              return 'Low';\n            }\n          }\n        }\n      }\n    }\n    return complexity;\n  }\n  // Helper method to get work item type consistently\n  getWorkItemType(item) {\n    // Try to get from System.WorkItemType first\n    if (item.fields && item.fields['System.WorkItemType']) {\n      return item.fields['System.WorkItemType'];\n    }\n    // Fallback to type property\n    return item.type || 'Feature';\n  }\n  resetForm() {\n    this.estimationForm.reset({\n      type: 'Feature',\n      complexity: 'Medium'\n    });\n    this.error = null;\n    this.showResult = false;\n    this.estimationResult = null;\n  }\n  estimateTaskTime() {\n    if (this.estimationForm.invalid) {\n      // Mark all fields as touched to trigger validation messages\n      Object.keys(this.estimationForm.controls).forEach(key => {\n        this.estimationForm.get(key)?.markAsTouched();\n      });\n      return;\n    }\n    this.loading = true;\n    this.error = null;\n    this.estimationResult = null;\n    this.showResult = false;\n    const request = {\n      title: this.estimationForm.value.title,\n      type: this.estimationForm.value.type,\n      assignee: this.estimationForm.value.assignee,\n      complexity: this.estimationForm.value.complexity\n    };\n    // Check if we have a selected work item with an ID\n    if (this.selectedWorkItem && this.selectedWorkItem.id) {\n      // Convert to number if it's a string, or use as is if it's already a number\n      const workItemId = typeof this.selectedWorkItem.id === 'string' ? parseInt(this.selectedWorkItem.id, 10) : this.selectedWorkItem.id;\n      if (!isNaN(workItemId)) {\n        request.workItemId = workItemId;\n        // First try to get the full work item history from Azure DevOps\n        console.log(`Fetching detailed history for work item #${workItemId}`);\n        this.taskService.getWorkItemWithHistory(workItemId).subscribe({\n          next: detailedItem => {\n            console.log(`Received detailed work item #${workItemId} with history`);\n            // Check if we have activity history\n            if (detailedItem.activity && detailedItem.activity.length > 0) {\n              console.log(`Work item has ${detailedItem.activity.length} historical activities`);\n              // Use the history to estimate time based on state transitions\n              const estimatedTimes = this.calculateEstimatesFromHistory(detailedItem);\n              // Create result based on historical analysis\n              this.estimationResult = {\n                estimatedHours: estimatedTimes.total,\n                devTimeHours: estimatedTimes.development,\n                testTimeHours: estimatedTimes.testing,\n                confidenceScore: 0.85,\n                factors: [`Based on actual work item #${workItemId} history`, `Task type: ${request.type}`, `${request.complexity} complexity`, `Similar work item pattern analysis`]\n              };\n              this.showResult = true;\n              this.loading = false;\n              this.devTimeEstimate = this.estimationResult.devTimeHours || 0;\n              this.testTimeEstimate = this.estimationResult.testTimeHours || 0;\n              this.totalEstimate = this.estimationResult.estimatedHours;\n            } else {\n              console.log('No activity history available, falling back to iteration-based estimation');\n              this.estimateFromIterationHistory(request);\n            }\n          },\n          error: err => {\n            console.error('Error fetching work item history:', err);\n            console.log('Falling back to iteration-based estimation');\n            this.estimateFromIterationHistory(request);\n          }\n        });\n        return; // Exit early since we're handling the estimation in the subscription\n      }\n    }\n    // If we don't have a work item ID or failed to retrieve it,\n    // fall back to our previous approach with iteration history\n    this.estimateFromIterationHistory(request);\n  }\n  /**\r\n   * Estimate task time using the iteration history approach (our previous implementation)\r\n   */\n  estimateFromIterationHistory(request) {\n    // Use iteration path for historical data analysis if available\n    const iterationPath = this.selectedWorkItem && this.selectedWorkItem.iterationPath || this.manualIterationPath;\n    if (iterationPath) {\n      request.includeHistory = true; // Signal to include work history analysis\n      console.log('Estimating using work items from iteration: ' + iterationPath);\n      // Get work items from this iteration for analysis\n      this.taskService.getTaskHistory(iterationPath).subscribe({\n        next: historyItems => {\n          console.log(`Retrieved ${historyItems.length} work items from iteration ${iterationPath}`);\n          if (historyItems.length === 0) {\n            // If no historical items found, fall back to standard estimation\n            console.log('No historical items found, using standard estimation');\n            this.performStandardEstimation(request);\n            return;\n          }\n          // Since we might not have actual timing data from the API,\n          // we'll analyze the items we have and infer timing data\n          const estimatedHistoricalItems = this.inferTimingData(historyItems, request.type, request.complexity);\n          // Set historical data in the request\n          request.historicalItems = estimatedHistoricalItems;\n          // Check if we have enough data to make a history-based estimate\n          if (estimatedHistoricalItems.length > 0) {\n            console.log('Using inferred historical data for estimation');\n            // Calculate time estimates based on the historical data\n            const similarItems = this.findSimilarItems(estimatedHistoricalItems, request);\n            if (similarItems.length > 0) {\n              // Calculate average times from similar items\n              const avgTotal = similarItems.reduce((sum, item) => sum + (item.actualHours || 0), 0) / similarItems.length;\n              const avgDev = similarItems.reduce((sum, item) => sum + (item.developmentHours || 0), 0) / similarItems.length;\n              const avgTest = similarItems.reduce((sum, item) => sum + (item.testingHours || 0), 0) / similarItems.length;\n              // Create a result based on historical averages\n              this.estimationResult = {\n                estimatedHours: Number(avgTotal.toFixed(1)),\n                devTimeHours: Number(avgDev.toFixed(1)),\n                testTimeHours: Number(avgTest.toFixed(1)),\n                confidenceScore: this.calculateConfidenceScore(similarItems.length, historyItems.length),\n                factors: [`Task type: ${request.type}`, `${request.complexity} complexity`, `Based on ${similarItems.length} similar completed items`, `Assignee ${request.assignee || 'unassigned'}`]\n              };\n              this.showResult = true;\n              this.loading = false;\n              this.devTimeEstimate = this.estimationResult.devTimeHours || 0;\n              this.testTimeEstimate = this.estimationResult.testTimeHours || 0;\n              this.totalEstimate = this.estimationResult.estimatedHours;\n            } else {\n              // No similar items found, use standard estimation\n              this.performStandardEstimation(request);\n            }\n          } else {\n            // Not enough historical data, fall back to standard estimation\n            this.performStandardEstimation(request);\n          }\n        },\n        error: err => {\n          console.error('Error loading work item history:', err);\n          console.log('Falling back to standard estimation');\n          this.performStandardEstimation(request);\n        }\n      });\n    } else {\n      // Fallback to standard estimation without work history\n      this.performStandardEstimation(request);\n    }\n  }\n  /**\r\n   * Perform standard estimation without using historical data\r\n   */\n  performStandardEstimation(request) {\n    this.estimationService.estimateTaskTime(request).subscribe({\n      next: result => {\n        this.estimationResult = result;\n        this.showResult = true;\n        this.calculateTimeEstimates(result.estimatedHours);\n        this.loading = false;\n      },\n      error: err => {\n        console.error('Error estimating task time:', err);\n        this.error = 'Failed to estimate task time. Please try again.';\n        this.loading = false;\n      }\n    });\n  }\n  /**\r\n   * Infer timing data for historical work items\r\n   * This adds estimated development and testing hours to work items\r\n   */\n  inferTimingData(items, taskType, complexity) {\n    return items.map(item => {\n      // Clone the item to avoid modifying the original\n      const processedItem = {\n        ...item\n      };\n      // If the item already has timing data, use it\n      if (item.actualHours && item.developmentHours && item.testingHours) {\n        return processedItem;\n      }\n      // Calculate base hours based on type and complexity\n      const baseHours = this.getBaseHoursByType(item.type || taskType);\n      const multiplier = this.getComplexityMultiplier(complexity);\n      // Estimate total hours\n      const estimatedTotal = baseHours * multiplier;\n      // Estimate dev/test split\n      const devRatio = complexity === 'High' ? 0.7 : complexity === 'Low' ? 0.6 : 0.65;\n      const devHours = estimatedTotal * devRatio;\n      const testHours = estimatedTotal - devHours;\n      // Add the estimated hours to the item\n      processedItem.actualHours = Number(estimatedTotal.toFixed(1));\n      processedItem.developmentHours = Number(devHours.toFixed(1));\n      processedItem.testingHours = Number(testHours.toFixed(1));\n      return processedItem;\n    });\n  }\n  /**\r\n   * Find similar work items based on type and complexity\r\n   */\n  findSimilarItems(items, request) {\n    // Filter items by type and complexity\n    return items.filter(item => {\n      // Match by type\n      const typeMatch = item.type?.toLowerCase() === request.type.toLowerCase();\n      // Match by complexity (if available)\n      const itemComplexity = this.determineComplexity(item);\n      const complexityMatch = itemComplexity.toLowerCase() === request.complexity.toLowerCase();\n      // We need both to match for a \"similar\" item\n      return typeMatch && complexityMatch;\n    });\n  }\n  /**\r\n   * Calculate confidence score based on sample size\r\n   */\n  calculateConfidenceScore(similarCount, totalCount) {\n    // Base confidence on the number of similar items vs total items\n    if (similarCount === 0) return 0.5;\n    // More similar items = higher confidence\n    const baseConfidence = Math.min(0.75, 0.5 + similarCount / 20);\n    // Add a bonus if we have a good percentage of the total\n    const percentageBonus = similarCount / totalCount > 0.3 ? 0.1 : 0;\n    // Cap at 0.95 for historical data\n    return Math.min(0.95, baseConfidence + percentageBonus);\n  }\n  // Calculate development and testing time estimates\n  calculateTimeEstimates(totalHours) {\n    // Typical distribution: dev 60-70%, testing 30-40%\n    const complexity = this.estimationForm.value.complexity;\n    let devRatio = 0.65; // Default dev ratio\n    // Adjust ratio based on complexity\n    if (complexity === 'High') {\n      devRatio = 0.7; // Higher complexity = more dev time\n    } else if (complexity === 'Low') {\n      devRatio = 0.6; // Lower complexity = less dev time\n    }\n\n    this.devTimeEstimate = Math.round(totalHours * devRatio * 10) / 10;\n    this.testTimeEstimate = Math.round((totalHours - this.devTimeEstimate) * 10) / 10;\n    this.totalEstimate = totalHours;\n  }\n  // Format confidence score as percentage\n  formatConfidence(score) {\n    return `${Math.round(score * 100)}%`;\n  }\n  // Get appropriate class for confidence level\n  getConfidenceClass(score) {\n    if (score >= 0.8) {\n      return 'bg-success';\n    } else if (score >= 0.6) {\n      return 'bg-primary';\n    } else if (score >= 0.4) {\n      return 'bg-warning';\n    } else {\n      return 'bg-danger';\n    }\n  }\n  // Get assignee name for display\n  getAssigneeName(item) {\n    let displayName = '';\n    // Try to get from System.AssignedTo first\n    if (item.fields && item.fields['System.AssignedTo']) {\n      const assignedTo = item.fields['System.AssignedTo'];\n      if (typeof assignedTo === 'string') {\n        displayName = assignedTo;\n      } else if (typeof assignedTo === 'object' && assignedTo !== null) {\n        if (assignedTo.displayName) {\n          displayName = assignedTo.displayName;\n        }\n      }\n    }\n    // Fallback to assignedTo property\n    if (!displayName && item.assignedTo) {\n      if (typeof item.assignedTo === 'string') {\n        displayName = item.assignedTo;\n      } else if (typeof item.assignedTo === 'object' && item.assignedTo !== null) {\n        const assigneeObj = item.assignedTo;\n        displayName = assigneeObj.displayName || assigneeObj.name || '';\n      }\n    }\n    // Find matching team member for consistent display\n    if (displayName) {\n      return this.findMatchingTeamMember(displayName);\n    }\n    return '';\n  }\n  // Get the clean state display for a work item\n  getStateDisplay(item) {\n    // First check fields for System.State\n    if (item.fields && item.fields['System.State']) {\n      const state = item.fields['System.State'];\n      if (typeof state === 'string') {\n        // Remove \"Unknown\" prefix if present\n        return state.replace(/unknown/i, '').trim();\n      }\n    }\n    // Check for status field in the item or fields\n    if (item.status) {\n      return typeof item.status === 'string' ? item.status : '';\n    }\n    if (item.fields && item.fields['status']) {\n      return typeof item.fields['status'] === 'string' ? item.fields['status'] : '';\n    }\n    // Fallback to item.state if available\n    if (item.state) {\n      return item.state.replace(/unknown/i, '').trim();\n    }\n    return 'N/A'; // Default if no state available\n  }\n  /**\r\n   * Get base hours for estimation by work item type\r\n   */\n  getBaseHoursByType(type) {\n    const baseHoursByType = {\n      'Bug': 4,\n      'Task': 3,\n      'Feature': 8,\n      'User Story': 5,\n      'Change Request': 4,\n      'Requirement': 6,\n      'Documentation': 2,\n      'Epic': 20\n    };\n    return type ? baseHoursByType[type] || 4 : 4; // Default if type not found\n  }\n  /**\r\n   * Get multiplier based on complexity\r\n   */\n  getComplexityMultiplier(complexity) {\n    const multipliers = {\n      'Low': 0.6,\n      'Medium': 1.0,\n      'High': 1.5\n    };\n    return multipliers[complexity] || 1.0;\n  }\n  /**\r\n   * Calculate time estimates based on the work item's actual state transition history\r\n   * This analyzes the time spent in each state to estimate development and testing times\r\n   */\n  calculateEstimatesFromHistory(workItem) {\n    console.log('Calculating estimates from work item history');\n    // Default result\n    const result = {\n      total: 0,\n      development: 0,\n      testing: 0\n    };\n    // Step 1: Extract state transitions from activity history\n    const stateTransitions = workItem.activity?.filter(a => a.field === 'State' || a.field === 'System.State') || [];\n    console.log(`Found ${stateTransitions.length} state transitions`);\n    if (stateTransitions.length === 0) {\n      // No state transitions found, estimate based on work item type and complexity\n      const complexity = this.determineComplexity(workItem);\n      const baseHours = this.getBaseHoursByType(this.getWorkItemType(workItem));\n      const multiplier = this.getComplexityMultiplier(complexity);\n      result.total = Number((baseHours * multiplier).toFixed(1));\n      result.development = Number((result.total * 0.65).toFixed(1));\n      result.testing = Number((result.total * 0.35).toFixed(1));\n      return result;\n    }\n    // Sort transitions by date\n    stateTransitions.sort((a, b) => {\n      const dateA = new Date(a.changedDate).getTime();\n      const dateB = new Date(b.changedDate).getTime();\n      return dateA - dateB;\n    });\n    // Step 2: Create a timeline of state changes with durations\n    const timeline = [];\n    // Add each transition\n    stateTransitions.forEach((transition, index) => {\n      const currentState = transition.newValue || '';\n      const startDate = new Date(transition.changedDate);\n      // Add to timeline\n      timeline.push({\n        state: currentState,\n        startDate: startDate\n      });\n      // Set end date for previous state\n      if (index > 0) {\n        timeline[index - 1].endDate = startDate;\n        // Calculate duration in hours for previous state\n        const prevStartDate = timeline[index - 1].startDate;\n        const durationMs = startDate.getTime() - prevStartDate.getTime();\n        const durationHours = durationMs / (1000 * 60 * 60);\n        // Account for work hours (8 hours per day, 5 days per week)\n        // This is a simplification - in reality, you'd want to account for weekends and working hours\n        let adjustedHours = durationHours;\n        // If duration is more than 16 hours, assume some of it is non-working time\n        if (durationHours > 16) {\n          // Roughly estimate working hours\n          const days = Math.floor(durationHours / 24);\n          const workDays = Math.max(Math.ceil(days * 5 / 7), 1); // Estimate work days (5/7 of total days)\n          adjustedHours = workDays * 8 + durationHours % 24; // 8 hours per work day + remainder\n          // Cap at a reasonable value to prevent outliers\n          adjustedHours = Math.min(adjustedHours, durationHours * 0.6);\n        }\n        timeline[index - 1].durationHours = Number(adjustedHours.toFixed(1));\n      }\n    });\n    // Add current state if item is not completed\n    if (workItem.state !== 'Closed' && workItem.state !== 'Done' && workItem.state !== 'Completed') {\n      // Calculate duration to now for the last state\n      const lastIndex = timeline.length - 1;\n      if (lastIndex >= 0) {\n        const now = new Date();\n        timeline[lastIndex].endDate = now;\n        const durationMs = now.getTime() - timeline[lastIndex].startDate.getTime();\n        const durationHours = durationMs / (1000 * 60 * 60);\n        // Apply same adjustment for work hours\n        let adjustedHours = durationHours;\n        if (durationHours > 16) {\n          const days = Math.floor(durationHours / 24);\n          const workDays = Math.max(Math.ceil(days * 5 / 7), 1);\n          adjustedHours = workDays * 8 + durationHours % 24;\n          adjustedHours = Math.min(adjustedHours, durationHours * 0.6);\n        }\n        timeline[lastIndex].durationHours = Number(adjustedHours.toFixed(1));\n      }\n    }\n    // Step 3: Categorize times as development or testing\n    timeline.forEach(entry => {\n      if (!entry.durationHours) return;\n      const state = entry.state.toLowerCase();\n      // Categorize states\n      if (state.includes('new') || state.includes('proposed') || state.includes('backlog')) {\n        // Planning time - not counted in the estimate\n      } else if (state.includes('active') || state.includes('progress') || state.includes('development')) {\n        // Development time\n        result.development += entry.durationHours;\n      } else if (state.includes('review') || state.includes('test') || state.includes('qa')) {\n        // Testing/Review time\n        result.testing += entry.durationHours;\n      } else if (state.includes('resolved') || state.includes('done') || state.includes('closed')) {\n        // Completion time - typically minimal, add to testing\n        result.testing += entry.durationHours * 0.5;\n      } else {\n        // Unknown state, distribute proportionally\n        result.development += entry.durationHours * 0.6;\n        result.testing += entry.durationHours * 0.4;\n      }\n    });\n    // Step 4: Calculate total time\n    result.total = Number((result.development + result.testing).toFixed(1));\n    // Ensure we have a minimum reasonable value\n    if (result.total < 0.5) {\n      // If calculated time is too small, use type/complexity approach as fallback\n      const complexity = this.determineComplexity(workItem);\n      const baseHours = this.getBaseHoursByType(this.getWorkItemType(workItem));\n      const multiplier = this.getComplexityMultiplier(complexity);\n      result.total = Number((baseHours * multiplier).toFixed(1));\n      result.development = Number((result.total * 0.65).toFixed(1));\n      result.testing = Number((result.total * 0.35).toFixed(1));\n    }\n    // Round to 1 decimal place\n    result.development = Number(result.development.toFixed(1));\n    result.testing = Number(result.testing.toFixed(1));\n    console.log(`Estimated from history: Total=${result.total}, Dev=${result.development}, Test=${result.testing}`);\n    return result;\n  }\n  static {\n    this.ɵfac = function TaskEstimationComponent_Factory(t) {\n      return new (t || TaskEstimationComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.EstimationService), i0.ɵɵdirectiveInject(i3.TaskService));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: TaskEstimationComponent,\n      selectors: [[\"app-task-estimation\"]],\n      decls: 84,\n      vars: 26,\n      consts: [[1, \"container-fluid\", \"p-4\"], [1, \"row\", \"mb-4\"], [1, \"col-12\"], [1, \"mb-0\"], [1, \"text-muted\", \"mt-2\"], [1, \"card\"], [1, \"card-header\"], [1, \"card-title\", \"mb-0\"], [1, \"card-body\"], [1, \"row\", \"g-3\", \"align-items-center\"], [1, \"col-md-6\"], [1, \"input-group\"], [\"for\", \"manualIterationPath\", 1, \"input-group-text\"], [\"type\", \"text\", \"id\", \"manualIterationPath\", \"placeholder\", \"Enter iteration path (e.g. Techoil\\\\2.3.23)\", \"aria-label\", \"Manual Iteration Path\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"button\", 1, \"btn\", \"btn-outline-primary\", 3, \"disabled\", \"click\"], [1, \"bi\", \"bi-search\"], [\"class\", \"text-danger mt-2\", 4, \"ngIf\"], [1, \"row\"], [1, \"card-header\", \"d-flex\", \"justify-content-between\", \"align-items-center\"], [\"class\", \"badge bg-primary\", 4, \"ngIf\"], [\"class\", \"text-center py-4\", 4, \"ngIf\"], [\"class\", \"table-responsive\", 4, \"ngIf\"], [4, \"ngIf\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"mb-3\"], [\"for\", \"taskTitle\", 1, \"form-label\"], [\"type\", \"text\", \"id\", \"taskTitle\", \"formControlName\", \"title\", \"placeholder\", \"Enter or select task title\", 1, \"form-control\", 3, \"ngClass\"], [\"class\", \"btn btn-outline-secondary\", \"type\", \"button\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"text-danger mt-1\", 4, \"ngIf\"], [\"class\", \"text-success mt-1\", 4, \"ngIf\"], [\"for\", \"taskType\", 1, \"form-label\"], [\"id\", \"taskType\", \"formControlName\", \"type\", 1, \"form-select\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"for\", \"assignee\", 1, \"form-label\"], [\"id\", \"assignee\", \"formControlName\", \"assignee\", 1, \"form-select\"], [\"value\", \"\"], [1, \"form-label\"], [1, \"d-flex\"], [\"class\", \"form-check me-3\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"text-muted mt-1\", 4, \"ngIf\"], [1, \"d-flex\", \"justify-content-between\", \"mt-4\"], [\"type\", \"button\", 1, \"btn\", \"btn-secondary\", 3, \"click\"], [1, \"bi\", \"bi-arrow-counterclockwise\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"disabled\"], [1, \"row\", \"mt-4\"], [1, \"col-md-12\"], [\"class\", \"alert alert-danger mb-4\", 4, \"ngIf\"], [\"class\", \"card\", 4, \"ngIf\"], [\"class\", \"card bg-light\", 4, \"ngIf\"], [1, \"text-danger\", \"mt-2\"], [1, \"badge\", \"bg-primary\"], [1, \"text-center\", \"py-4\"], [\"role\", \"status\", 1, \"spinner-border\", \"text-primary\"], [1, \"visually-hidden\"], [1, \"mt-2\", \"text-muted\"], [1, \"text-muted\"], [1, \"table-responsive\"], [1, \"table\", \"table-hover\", \"table-striped\"], [\"scope\", \"col\"], [\"style\", \"cursor: pointer;\", 3, \"table-primary\", \"click\", 4, \"ngFor\", \"ngForOf\"], [2, \"cursor\", \"pointer\", 3, \"click\"], [1, \"fw-bold\"], [1, \"badge\", \"rounded-pill\", 3, \"ngClass\"], [1, \"bi\", \"bi-person\", \"me-1\"], [1, \"badge\", 3, \"ngClass\"], [\"type\", \"button\", 1, \"btn\", \"btn-outline-secondary\", 3, \"click\"], [1, \"bi\", \"bi-x-lg\"], [1, \"text-danger\", \"mt-1\"], [1, \"text-success\", \"mt-1\"], [3, \"value\"], [1, \"form-check\", \"me-3\"], [\"type\", \"radio\", \"formControlName\", \"complexity\", 1, \"form-check-input\", 3, \"id\", \"value\"], [1, \"form-check-label\", 3, \"for\"], [1, \"text-muted\", \"mt-1\"], [1, \"bi\", \"bi-info-circle\"], [1, \"bi\", \"bi-stopwatch\"], [\"role\", \"status\", \"aria-hidden\", \"true\", 1, \"spinner-border\", \"spinner-border-sm\"], [1, \"alert\", \"alert-danger\", \"mb-4\"], [1, \"card-header\", \"bg-primary\", \"text-white\"], [1, \"mb-4\", \"text-center\"], [1, \"display-4\", \"mb-0\"], [1, \"row\", \"text-center\", \"mb-4\"], [1, \"col-6\"], [1, \"p-3\", \"bg-light\", \"rounded\"], [1, \"text-muted\", \"mb-0\"], [1, \"mb-4\"], [1, \"progress\"], [\"role\", \"progressbar\", \"aria-valuemin\", \"0\", \"aria-valuemax\", \"100\", 1, \"progress-bar\", 3, \"ngClass\"], [1, \"list-group\"], [\"class\", \"list-group-item\", 4, \"ngFor\", \"ngForOf\"], [1, \"card-footer\", \"text-muted\", \"small\"], [1, \"list-group-item\"], [1, \"card\", \"bg-light\"], [1, \"card-body\", \"text-center\", \"p-5\"], [1, \"bi\", \"bi-graph-up\", \"display-1\", \"text-muted\"], [1, \"mt-3\"]],\n      template: function TaskEstimationComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"h2\", 3);\n          i0.ɵɵtext(4, \"ML-Based Task Estimation\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(5, \"p\", 4);\n          i0.ɵɵtext(6, \"Estimate task duration using machine learning predictions based on historical data\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(7, \"div\", 1)(8, \"div\", 2)(9, \"div\", 5)(10, \"div\", 6)(11, \"h4\", 7);\n          i0.ɵɵtext(12, \"Enter Iteration Path\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(13, \"div\", 8)(14, \"div\", 9)(15, \"div\", 10)(16, \"div\", 11)(17, \"label\", 12);\n          i0.ɵɵtext(18, \"Iteration Path\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(19, \"input\", 13);\n          i0.ɵɵlistener(\"ngModelChange\", function TaskEstimationComponent_Template_input_ngModelChange_19_listener($event) {\n            return ctx.manualIterationPath = $event;\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(20, \"button\", 14);\n          i0.ɵɵlistener(\"click\", function TaskEstimationComponent_Template_button_click_20_listener() {\n            return ctx.loadWorkItemsByIteration();\n          });\n          i0.ɵɵelement(21, \"i\", 15);\n          i0.ɵɵtext(22, \" Load Items \");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(23, TaskEstimationComponent_div_23_Template, 3, 1, \"div\", 16);\n          i0.ɵɵelementEnd()()()()()();\n          i0.ɵɵelementStart(24, \"div\", 17)(25, \"div\", 10)(26, \"div\", 5)(27, \"div\", 18)(28, \"h4\", 7);\n          i0.ɵɵtext(29, \"Work Items\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(30, TaskEstimationComponent_span_30_Template, 2, 1, \"span\", 19);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(31, \"div\", 8);\n          i0.ɵɵtemplate(32, TaskEstimationComponent_div_32_Template, 6, 0, \"div\", 20);\n          i0.ɵɵtemplate(33, TaskEstimationComponent_div_33_Template, 3, 0, \"div\", 20);\n          i0.ɵɵtemplate(34, TaskEstimationComponent_div_34_Template, 16, 1, \"div\", 21);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(35, \"div\", 10)(36, \"div\", 5)(37, \"div\", 6)(38, \"h4\", 7);\n          i0.ɵɵtemplate(39, TaskEstimationComponent_span_39_Template, 2, 1, \"span\", 22);\n          i0.ɵɵtemplate(40, TaskEstimationComponent_span_40_Template, 2, 0, \"span\", 22);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(41, \"div\", 8)(42, \"form\", 23);\n          i0.ɵɵlistener(\"ngSubmit\", function TaskEstimationComponent_Template_form_ngSubmit_42_listener() {\n            return ctx.estimateTaskTime();\n          });\n          i0.ɵɵelementStart(43, \"div\", 24)(44, \"label\", 25);\n          i0.ɵɵtext(45, \"Task Title\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(46, \"div\", 11);\n          i0.ɵɵelement(47, \"input\", 26);\n          i0.ɵɵtemplate(48, TaskEstimationComponent_button_48_Template, 2, 0, \"button\", 27);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(49, TaskEstimationComponent_div_49_Template, 3, 2, \"div\", 28);\n          i0.ɵɵtemplate(50, TaskEstimationComponent_div_50_Template, 3, 1, \"div\", 29);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(51, \"div\", 17)(52, \"div\", 10)(53, \"div\", 24)(54, \"label\", 30);\n          i0.ɵɵtext(55, \"Task Type\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(56, \"select\", 31);\n          i0.ɵɵtemplate(57, TaskEstimationComponent_option_57_Template, 2, 2, \"option\", 32);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(58, \"div\", 10)(59, \"div\", 24)(60, \"label\", 33);\n          i0.ɵɵtext(61, \"Assignee\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(62, \"select\", 34)(63, \"option\", 35);\n          i0.ɵɵtext(64, \"-- Unassigned --\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(65, TaskEstimationComponent_option_65_Template, 2, 2, \"option\", 32);\n          i0.ɵɵelementEnd()()()();\n          i0.ɵɵelementStart(66, \"div\", 24)(67, \"label\", 36);\n          i0.ɵɵtext(68, \"Complexity\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(69, \"div\", 37);\n          i0.ɵɵtemplate(70, TaskEstimationComponent_div_70_Template, 4, 4, \"div\", 38);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(71, TaskEstimationComponent_div_71_Template, 4, 0, \"div\", 39);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(72, \"div\", 40)(73, \"button\", 41);\n          i0.ɵɵlistener(\"click\", function TaskEstimationComponent_Template_button_click_73_listener() {\n            return ctx.resetForm();\n          });\n          i0.ɵɵelement(74, \"i\", 42);\n          i0.ɵɵtext(75, \" Reset \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(76, \"button\", 43);\n          i0.ɵɵtemplate(77, TaskEstimationComponent_span_77_Template, 3, 0, \"span\", 22);\n          i0.ɵɵtemplate(78, TaskEstimationComponent_span_78_Template, 3, 0, \"span\", 22);\n          i0.ɵɵelementEnd()()()()()()();\n          i0.ɵɵelementStart(79, \"div\", 44)(80, \"div\", 45);\n          i0.ɵɵtemplate(81, TaskEstimationComponent_div_81_Template, 2, 1, \"div\", 46);\n          i0.ɵɵtemplate(82, TaskEstimationComponent_div_82_Template, 39, 9, \"div\", 47);\n          i0.ɵɵtemplate(83, TaskEstimationComponent_div_83_Template, 7, 0, \"div\", 48);\n          i0.ɵɵelementEnd()()();\n        }\n        if (rf & 2) {\n          let tmp_11_0;\n          let tmp_12_0;\n          i0.ɵɵadvance(19);\n          i0.ɵɵproperty(\"ngModel\", ctx.manualIterationPath);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"disabled\", !ctx.manualIterationPath);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngIf\", ctx.iterationError);\n          i0.ɵɵadvance(7);\n          i0.ɵɵproperty(\"ngIf\", ctx.workItems.length > 0);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", ctx.loadingIterationItems);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", !ctx.loadingIterationItems && ctx.workItems.length === 0 && !ctx.iterationError);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", !ctx.loadingIterationItems && ctx.workItems.length > 0);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", ctx.selectedWorkItem);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", !ctx.selectedWorkItem);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"formGroup\", ctx.estimationForm);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(24, _c2, ctx.selectedWorkItem !== null));\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", (tmp_11_0 = ctx.estimationForm.get(\"title\")) == null ? null : tmp_11_0.value);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ((tmp_12_0 = ctx.estimationForm.get(\"title\")) == null ? null : tmp_12_0.invalid) && ((tmp_12_0 = ctx.estimationForm.get(\"title\")) == null ? null : tmp_12_0.touched));\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.selectedWorkItem);\n          i0.ɵɵadvance(7);\n          i0.ɵɵproperty(\"ngForOf\", ctx.taskTypes);\n          i0.ɵɵadvance(8);\n          i0.ɵɵproperty(\"ngForOf\", ctx.teamMembers);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngForOf\", ctx.complexityLevels);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.selectedWorkItem);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"disabled\", ctx.loading);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", !ctx.loading);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.loading);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngIf\", ctx.error);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.showResult && ctx.estimationResult);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", !ctx.showResult && !ctx.error);\n        }\n      },\n      dependencies: [i4.NgClass, i4.NgForOf, i4.NgIf, i1.ɵNgNoValidate, i1.NgSelectOption, i1.ɵNgSelectMultipleOption, i1.DefaultValueAccessor, i1.SelectControlValueAccessor, i1.RadioControlValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.NgModel, i1.FormGroupDirective, i1.FormControlName],\n      styles: [\"h2[_ngcontent-%COMP%] {\\n  margin-bottom: 1.5rem;\\n  color: #2c3e50;\\n}\\n\\n[_nghost-%COMP%] {\\n  display: block;\\n  background-color: #e8eaf6;\\n}\\n\\n.container-fluid[_ngcontent-%COMP%] {\\n  background-color: #e8eaf6;\\n  padding-top: 1.5rem;\\n  padding-bottom: 1.5rem;\\n}\\n\\n.container[_ngcontent-%COMP%] {\\n  padding-top: 1.5rem;\\n}\\n\\n.display-4[_ngcontent-%COMP%] {\\n  font-weight: 600;\\n}\\n\\n.card[_ngcontent-%COMP%] {\\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\\n  transition: all 0.3s ease;\\n  background-color: #f5f7ff;\\n}\\n.card[_ngcontent-%COMP%]:hover {\\n  box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);\\n}\\n.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%] {\\n  background-color: #c5cae9;\\n  color: #3949ab;\\n  font-weight: 600;\\n}\\n.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%] {\\n  background-color: #f5f7ff;\\n}\\n\\n.progress[_ngcontent-%COMP%] {\\n  height: 25px;\\n  font-weight: 600;\\n}\\n\\n.list-group-item[_ngcontent-%COMP%]:first-child {\\n  font-weight: 500;\\n}\\n\\n.bg-light[_ngcontent-%COMP%] {\\n  opacity: 0.8;\\n}\\n.bg-light[_ngcontent-%COMP%]   i.bi-graph-up[_ngcontent-%COMP%] {\\n  opacity: 0.5;\\n}\\n\\n.form-check[_ngcontent-%COMP%] {\\n  cursor: pointer;\\n}\\n.form-check[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%], .form-check[_ngcontent-%COMP%]   .form-check-label[_ngcontent-%COMP%] {\\n  cursor: pointer;\\n}\\n\\n@keyframes _ngcontent-%COMP%_fadeIn {\\n  from {\\n    opacity: 0;\\n    transform: translateY(10px);\\n  }\\n  to {\\n    opacity: 1;\\n    transform: translateY(0);\\n  }\\n}\\n.alert[_ngcontent-%COMP%], .card[_ngcontent-%COMP%] {\\n  animation: _ngcontent-%COMP%_fadeIn 0.3s ease-out;\\n}\\n\\n.table-responsive[_ngcontent-%COMP%] {\\n  max-height: 450px;\\n  overflow-y: auto;\\n  background-color: #eef2ff;\\n  border-radius: 0.375rem;\\n  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);\\n}\\n\\n.table[_ngcontent-%COMP%] {\\n  font-size: 0.9rem;\\n  background-color: #eef2ff;\\n}\\n.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%] {\\n  position: sticky;\\n  top: 0;\\n  background-color: #c5cae9;\\n  z-index: 1;\\n}\\n.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%] {\\n  font-weight: 600;\\n  color: #3949ab;\\n  text-transform: uppercase;\\n  font-size: 0.75rem;\\n  letter-spacing: 0.5px;\\n  padding-top: 12px;\\n  padding-bottom: 12px;\\n  border-top: none;\\n  border-bottom: 2px solid #9fa8da;\\n}\\n.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%] {\\n  transition: background-color 0.2s;\\n  background-color: #e8eaf6;\\n}\\n.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(even) {\\n  background-color: #d1d9ff;\\n}\\n.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover {\\n  background-color: #c5cae9;\\n}\\n.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.table-primary[_ngcontent-%COMP%] {\\n  background-color: #bbdefb;\\n}\\n.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.table-primary[_ngcontent-%COMP%]:hover {\\n  background-color: #90caf9;\\n}\\n.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%] {\\n  vertical-align: middle;\\n  padding: 0.75rem;\\n  border-color: #c5cae9;\\n}\\n.table[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%] {\\n  font-size: 0.75rem;\\n}\\n\\n.form-select.ng-touched.ng-valid[_ngcontent-%COMP%], .form-control.ng-touched.ng-valid[_ngcontent-%COMP%] {\\n  border-color: #28a745;\\n}\\n\\n.form-check-input[_ngcontent-%COMP%]:checked {\\n  background-color: #0d6efd;\\n  border-color: #0d6efd;\\n}\\n\\n.badge[_ngcontent-%COMP%] {\\n  padding: 0.5em 0.75em;\\n  font-size: 0.8rem;\\n  font-weight: 600;\\n  letter-spacing: 0.2px;\\n  text-transform: capitalize;\\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\\n}\\n.badge.badge-code-review[_ngcontent-%COMP%] {\\n  background-color: #00c3f7 !important;\\n  color: white;\\n  font-weight: 600;\\n  position: relative;\\n}\\n.badge.badge-code-review[_ngcontent-%COMP%]::after {\\n  content: \\\"\\\";\\n  position: absolute;\\n  top: 0;\\n  right: 0;\\n  bottom: 0;\\n  left: 0;\\n  background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0) 100%);\\n  border-radius: inherit;\\n}\\n.badge.bg-info[_ngcontent-%COMP%] {\\n  background-color: #17a2b8 !important;\\n  color: white;\\n}\\n.badge.bg-primary[_ngcontent-%COMP%] {\\n  background-color: #6610f2 !important;\\n  color: white;\\n}\\n.badge.bg-success[_ngcontent-%COMP%] {\\n  background-color: #28a745 !important;\\n  color: white;\\n}\\n.badge.bg-warning[_ngcontent-%COMP%] {\\n  background-color: #ffc107 !important;\\n  color: #212529;\\n  font-weight: 700;\\n}\\n.badge.bg-danger[_ngcontent-%COMP%] {\\n  background-color: #dc3545 !important;\\n  color: white;\\n}\\n.badge.bg-dark[_ngcontent-%COMP%] {\\n  background-color: #343a40 !important;\\n  color: white;\\n}\\n.badge.badge-dev-new[_ngcontent-%COMP%] {\\n  background-color: #2c3e50 !important;\\n  color: white;\\n  font-weight: 600;\\n}\\n.badge.bg-light[_ngcontent-%COMP%] {\\n  background-color: #9575cd !important;\\n  border: 1px solid #7e57c2 !important;\\n  color: white !important;\\n}\\n.badge.bg-light.text-dark[_ngcontent-%COMP%] {\\n  color: white !important;\\n  font-weight: 700;\\n}\\n.badge.bg-secondary[_ngcontent-%COMP%] {\\n  background-color: #5c6bc0 !important;\\n  color: white;\\n}\\n.badge[class*=bg-][_ngcontent-%COMP%] {\\n  border-radius: 12px;\\n  transition: all 0.2s ease;\\n}\\n.badge[class*=bg-][_ngcontent-%COMP%]:hover {\\n  transform: translateY(-1px);\\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);\\n}\\n\\n.badge-ready[_ngcontent-%COMP%] {\\n  background-color: #7986cb !important;\\n  color: white !important;\\n}\\n\\n.badge-assigned[_ngcontent-%COMP%] {\\n  background-color: #9fa8da !important;\\n  color: #3949ab !important;\\n}\\n\\n.badge-na[_ngcontent-%COMP%] {\\n  background-color: #5c6bc0 !important;\\n  color: white !important;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy90YXNrLWVzdGltYXRpb24vdGFzay1lc3RpbWF0aW9uLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UscUJBQUE7RUFDQSxjQUFBO0FBQ0Y7O0FBR0E7RUFDRSxjQUFBO0VBQ0EseUJBQUE7QUFBRjs7QUFHQTtFQUNFLHlCQUFBO0VBQ0EsbUJBQUE7RUFDQSxzQkFBQTtBQUFGOztBQUdBO0VBQ0UsbUJBQUE7QUFBRjs7QUFHQTtFQUNFLGdCQUFBO0FBQUY7O0FBR0E7RUFDRSx3Q0FBQTtFQUNBLHlCQUFBO0VBQ0EseUJBQUE7QUFBRjtBQUVFO0VBQ0UsMENBQUE7QUFBSjtBQUdFO0VBQ0UseUJBQUE7RUFDQSxjQUFBO0VBQ0EsZ0JBQUE7QUFESjtBQUlFO0VBQ0UseUJBQUE7QUFGSjs7QUFNQTtFQUNFLFlBQUE7RUFDQSxnQkFBQTtBQUhGOztBQU9FO0VBQ0UsZ0JBQUE7QUFKSjs7QUFRQTtFQUNFLFlBQUE7QUFMRjtBQU9FO0VBQ0UsWUFBQTtBQUxKOztBQVNBO0VBQ0UsZUFBQTtBQU5GO0FBUUU7RUFDRSxlQUFBO0FBTko7O0FBV0E7RUFDRTtJQUFPLFVBQUE7SUFBWSwyQkFBQTtFQU5uQjtFQU9BO0lBQUssVUFBQTtJQUFZLHdCQUFBO0VBSGpCO0FBQ0Y7QUFLQTtFQUNFLCtCQUFBO0FBSEY7O0FBT0E7RUFDRSxpQkFBQTtFQUNBLGdCQUFBO0VBQ0EseUJBQUE7RUFDQSx1QkFBQTtFQUNBLHlDQUFBO0FBSkY7O0FBUUE7RUFDRSxpQkFBQTtFQUNBLHlCQUFBO0FBTEY7QUFPRTtFQUNFLGdCQUFBO0VBQ0EsTUFBQTtFQUNBLHlCQUFBO0VBQ0EsVUFBQTtBQUxKO0FBT0k7RUFDRSxnQkFBQTtFQUNBLGNBQUE7RUFDQSx5QkFBQTtFQUNBLGtCQUFBO0VBQ0EscUJBQUE7RUFDQSxpQkFBQTtFQUNBLG9CQUFBO0VBQ0EsZ0JBQUE7RUFDQSxnQ0FBQTtBQUxOO0FBU0U7RUFDRSxpQ0FBQTtFQUNBLHlCQUFBO0FBUEo7QUFTSTtFQUNFLHlCQUFBO0FBUE47QUFVSTtFQUNFLHlCQUFBO0FBUk47QUFXSTtFQUNFLHlCQUFBO0FBVE47QUFXTTtFQUNFLHlCQUFBO0FBVFI7QUFhSTtFQUNFLHNCQUFBO0VBQ0EsZ0JBQUE7RUFDQSxxQkFBQTtBQVhOO0FBZUU7RUFDRSxrQkFBQTtBQWJKOztBQW1CRTtFQUNFLHFCQUFBO0FBaEJKOztBQXFCQTtFQUNFLHlCQUFBO0VBQ0EscUJBQUE7QUFsQkY7O0FBc0JBO0VBQ0UscUJBQUE7RUFDQSxpQkFBQTtFQUNBLGdCQUFBO0VBQ0EscUJBQUE7RUFDQSwwQkFBQTtFQUNBLHdDQUFBO0FBbkJGO0FBc0JFO0VBQ0Usb0NBQUE7RUFDQSxZQUFBO0VBQ0EsZ0JBQUE7RUFDQSxrQkFBQTtBQXBCSjtBQXNCSTtFQUNFLFdBQUE7RUFDQSxrQkFBQTtFQUNBLE1BQUE7RUFDQSxRQUFBO0VBQ0EsU0FBQTtFQUNBLE9BQUE7RUFDQSw2RkFBQTtFQUNBLHNCQUFBO0FBcEJOO0FBeUJFO0VBQ0Usb0NBQUE7RUFDQSxZQUFBO0FBdkJKO0FBMkJFO0VBQ0Usb0NBQUE7RUFDQSxZQUFBO0FBekJKO0FBNkJFO0VBQ0Usb0NBQUE7RUFDQSxZQUFBO0FBM0JKO0FBK0JFO0VBQ0Usb0NBQUE7RUFDQSxjQUFBO0VBQ0EsZ0JBQUE7QUE3Qko7QUFpQ0U7RUFDRSxvQ0FBQTtFQUNBLFlBQUE7QUEvQko7QUFtQ0U7RUFDRSxvQ0FBQTtFQUNBLFlBQUE7QUFqQ0o7QUFxQ0U7RUFDRSxvQ0FBQTtFQUNBLFlBQUE7RUFDQSxnQkFBQTtBQW5DSjtBQXVDRTtFQUNFLG9DQUFBO0VBQ0Esb0NBQUE7RUFDQSx1QkFBQTtBQXJDSjtBQXVDSTtFQUNFLHVCQUFBO0VBQ0EsZ0JBQUE7QUFyQ047QUEwQ0U7RUFDRSxvQ0FBQTtFQUNBLFlBQUE7QUF4Q0o7QUE0Q0U7RUFDRSxtQkFBQTtFQUNBLHlCQUFBO0FBMUNKO0FBNENJO0VBQ0UsMkJBQUE7RUFDQSx5Q0FBQTtBQTFDTjs7QUFnREE7RUFDRSxvQ0FBQTtFQUNBLHVCQUFBO0FBN0NGOztBQWdEQTtFQUNFLG9DQUFBO0VBQ0EseUJBQUE7QUE3Q0Y7O0FBZ0RBO0VBQ0Usb0NBQUE7RUFDQSx1QkFBQTtBQTdDRiIsInNvdXJjZXNDb250ZW50IjpbImgyIHtcclxuICBtYXJnaW4tYm90dG9tOiAxLjVyZW07XHJcbiAgY29sb3I6ICMyYzNlNTA7XHJcbn1cclxuXHJcbi8vIEJhY2tncm91bmQgZm9yIHRoZSBlbnRpcmUgY29tcG9uZW50XHJcbjpob3N0IHtcclxuICBkaXNwbGF5OiBibG9jaztcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjZThlYWY2O1xyXG59XHJcblxyXG4uY29udGFpbmVyLWZsdWlkIHtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjZThlYWY2O1xyXG4gIHBhZGRpbmctdG9wOiAxLjVyZW07XHJcbiAgcGFkZGluZy1ib3R0b206IDEuNXJlbTtcclxufVxyXG5cclxuLmNvbnRhaW5lciB7XHJcbiAgcGFkZGluZy10b3A6IDEuNXJlbTtcclxufVxyXG5cclxuLmRpc3BsYXktNCB7XHJcbiAgZm9udC13ZWlnaHQ6IDYwMDtcclxufVxyXG5cclxuLmNhcmQge1xyXG4gIGJveC1zaGFkb3c6IDAgNHB4IDZweCByZ2JhKDAsIDAsIDAsIDAuMSk7XHJcbiAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZTtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjVmN2ZmO1xyXG4gIFxyXG4gICY6aG92ZXIge1xyXG4gICAgYm94LXNoYWRvdzogMCA2cHggMTBweCByZ2JhKDAsIDAsIDAsIDAuMTUpO1xyXG4gIH1cclxuICBcclxuICAuY2FyZC1oZWFkZXIge1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI2M1Y2FlOTtcclxuICAgIGNvbG9yOiAjMzk0OWFiO1xyXG4gICAgZm9udC13ZWlnaHQ6IDYwMDtcclxuICB9XHJcbiAgXHJcbiAgLmNhcmQtYm9keSB7XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjVmN2ZmO1xyXG4gIH1cclxufVxyXG5cclxuLnByb2dyZXNzIHtcclxuICBoZWlnaHQ6IDI1cHg7XHJcbiAgZm9udC13ZWlnaHQ6IDYwMDtcclxufVxyXG5cclxuLmxpc3QtZ3JvdXAtaXRlbSB7XHJcbiAgJjpmaXJzdC1jaGlsZCB7XHJcbiAgICBmb250LXdlaWdodDogNTAwO1xyXG4gIH1cclxufVxyXG5cclxuLmJnLWxpZ2h0IHtcclxuICBvcGFjaXR5OiAwLjg7XHJcbiAgXHJcbiAgaS5iaS1ncmFwaC11cCB7XHJcbiAgICBvcGFjaXR5OiAwLjU7XHJcbiAgfVxyXG59XHJcblxyXG4uZm9ybS1jaGVjayB7XHJcbiAgY3Vyc29yOiBwb2ludGVyO1xyXG4gIFxyXG4gIC5mb3JtLWNoZWNrLWlucHV0LCAuZm9ybS1jaGVjay1sYWJlbCB7XHJcbiAgICBjdXJzb3I6IHBvaW50ZXI7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBBZGQgc29tZSBhbmltYXRpb24gZWZmZWN0c1xyXG5Aa2V5ZnJhbWVzIGZhZGVJbiB7XHJcbiAgZnJvbSB7IG9wYWNpdHk6IDA7IHRyYW5zZm9ybTogdHJhbnNsYXRlWSgxMHB4KTsgfVxyXG4gIHRvIHsgb3BhY2l0eTogMTsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDApOyB9XHJcbn1cclxuXHJcbi5hbGVydCwgLmNhcmQge1xyXG4gIGFuaW1hdGlvbjogZmFkZUluIDAuM3MgZWFzZS1vdXQ7XHJcbn1cclxuXHJcbi8vIEN1c3RvbSBzdHlsaW5nIGZvciB0aGUgd29yayBpdGVtcyB0YWJsZVxyXG4udGFibGUtcmVzcG9uc2l2ZSB7XHJcbiAgbWF4LWhlaWdodDogNDUwcHg7XHJcbiAgb3ZlcmZsb3cteTogYXV0bztcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjZWVmMmZmO1xyXG4gIGJvcmRlci1yYWRpdXM6IDAuMzc1cmVtO1xyXG4gIGJveC1zaGFkb3c6IDAgMnB4IDVweCByZ2JhKDAsIDAsIDAsIDAuMDUpO1xyXG59XHJcblxyXG4vLyBFbmhhbmNlZCB0YWJsZSBzdHlsaW5nXHJcbi50YWJsZSB7XHJcbiAgZm9udC1zaXplOiAwLjlyZW07XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogI2VlZjJmZjtcclxuICBcclxuICB0aGVhZCB7XHJcbiAgICBwb3NpdGlvbjogc3RpY2t5O1xyXG4gICAgdG9wOiAwO1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI2M1Y2FlOTtcclxuICAgIHotaW5kZXg6IDE7XHJcbiAgICBcclxuICAgIHRoIHtcclxuICAgICAgZm9udC13ZWlnaHQ6IDYwMDtcclxuICAgICAgY29sb3I6ICMzOTQ5YWI7XHJcbiAgICAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7XHJcbiAgICAgIGZvbnQtc2l6ZTogMC43NXJlbTtcclxuICAgICAgbGV0dGVyLXNwYWNpbmc6IDAuNXB4O1xyXG4gICAgICBwYWRkaW5nLXRvcDogMTJweDtcclxuICAgICAgcGFkZGluZy1ib3R0b206IDEycHg7XHJcbiAgICAgIGJvcmRlci10b3A6IG5vbmU7XHJcbiAgICAgIGJvcmRlci1ib3R0b206IDJweCBzb2xpZCAjOWZhOGRhO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICB0Ym9keSB0ciB7XHJcbiAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnM7XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZThlYWY2O1xyXG4gICAgXHJcbiAgICAmOm50aC1jaGlsZChldmVuKSB7XHJcbiAgICAgIGJhY2tncm91bmQtY29sb3I6ICNkMWQ5ZmY7XHJcbiAgICB9XHJcbiAgICBcclxuICAgICY6aG92ZXIge1xyXG4gICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjYzVjYWU5O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAmLnRhYmxlLXByaW1hcnkge1xyXG4gICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjYmJkZWZiO1xyXG4gICAgICBcclxuICAgICAgJjpob3ZlciB7XHJcbiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzkwY2FmOTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICB0ZCB7XHJcbiAgICAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7XHJcbiAgICAgIHBhZGRpbmc6IDAuNzVyZW07XHJcbiAgICAgIGJvcmRlci1jb2xvcjogI2M1Y2FlOTtcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgLmJhZGdlIHtcclxuICAgIGZvbnQtc2l6ZTogMC43NXJlbTtcclxuICB9XHJcbn1cclxuXHJcbi8vIEN1c3RvbSBmb3JtIHN0eWxpbmdcclxuLmZvcm0tc2VsZWN0LCAuZm9ybS1jb250cm9sIHtcclxuICAmLm5nLXRvdWNoZWQubmctdmFsaWQge1xyXG4gICAgYm9yZGVyLWNvbG9yOiAjMjhhNzQ1O1xyXG4gIH1cclxufVxyXG5cclxuLy8gSW1wcm92ZSByYWRpbyBidXR0b25zIHZpc2liaWxpdHlcclxuLmZvcm0tY2hlY2staW5wdXQ6Y2hlY2tlZCB7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogIzBkNmVmZDtcclxuICBib3JkZXItY29sb3I6ICMwZDZlZmQ7XHJcbn1cclxuXHJcbi8vIFN0YXRlIGJhZGdlIGVuaGFuY2VtZW50c1xyXG4uYmFkZ2Uge1xyXG4gIHBhZGRpbmc6IDAuNWVtIDAuNzVlbTtcclxuICBmb250LXNpemU6IDAuOHJlbTtcclxuICBmb250LXdlaWdodDogNjAwO1xyXG4gIGxldHRlci1zcGFjaW5nOiAwLjJweDtcclxuICB0ZXh0LXRyYW5zZm9ybTogY2FwaXRhbGl6ZTtcclxuICBib3gtc2hhZG93OiAwIDFweCAycHggcmdiYSgwLCAwLCAwLCAwLjEpO1xyXG4gIFxyXG4gIC8vIENvZGUgUmV2aWV3IHN0YXRlIC0gc3BlY2lmaWMgc3R5bGluZyB0byBtYXRjaCB0aGUgaW1hZ2VcclxuICAmLmJhZGdlLWNvZGUtcmV2aWV3IHtcclxuICAgIGJhY2tncm91bmQtY29sb3I6ICMwMGMzZjcgIWltcG9ydGFudDsgLy8gQnJpZ2h0IGJsdWUgbGlrZSBpbiB0aGUgaW1hZ2VcclxuICAgIGNvbG9yOiB3aGl0ZTtcclxuICAgIGZvbnQtd2VpZ2h0OiA2MDA7XHJcbiAgICBwb3NpdGlvbjogcmVsYXRpdmU7XHJcbiAgICBcclxuICAgICY6OmFmdGVyIHtcclxuICAgICAgY29udGVudDogXCJcIjtcclxuICAgICAgcG9zaXRpb246IGFic29sdXRlO1xyXG4gICAgICB0b3A6IDA7XHJcbiAgICAgIHJpZ2h0OiAwO1xyXG4gICAgICBib3R0b206IDA7XHJcbiAgICAgIGxlZnQ6IDA7XHJcbiAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsIHJnYmEoMjU1LDI1NSwyNTUsMC4xKSAwJSwgcmdiYSgyNTUsMjU1LDI1NSwwKSAxMDAlKTtcclxuICAgICAgYm9yZGVyLXJhZGl1czogaW5oZXJpdDtcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgLy8gQ29kZSBSZXZpZXcgc3RhdGUgKGJsdWUpXHJcbiAgJi5iZy1pbmZvIHtcclxuICAgIGJhY2tncm91bmQtY29sb3I6ICMxN2EyYjggIWltcG9ydGFudDtcclxuICAgIGNvbG9yOiB3aGl0ZTtcclxuICB9XHJcbiAgXHJcbiAgLy8gSW4gUHJvZ3Jlc3Mgc3RhdGUgKGluZGlnbylcclxuICAmLmJnLXByaW1hcnkge1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogIzY2MTBmMiAhaW1wb3J0YW50O1xyXG4gICAgY29sb3I6IHdoaXRlO1xyXG4gIH1cclxuICBcclxuICAvLyBDb21wbGV0ZS9Eb25lIHN0YXRlIChncmVlbilcclxuICAmLmJnLXN1Y2Nlc3Mge1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogIzI4YTc0NSAhaW1wb3J0YW50O1xyXG4gICAgY29sb3I6IHdoaXRlO1xyXG4gIH1cclxuICBcclxuICAvLyBQZW5kaW5nL1dhaXQgc3RhdGUgKGFtYmVyKVxyXG4gICYuYmctd2FybmluZyB7XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZjMTA3ICFpbXBvcnRhbnQ7XHJcbiAgICBjb2xvcjogIzIxMjUyOTtcclxuICAgIGZvbnQtd2VpZ2h0OiA3MDA7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIEZhaWxlZC9CbG9ja2VkIHN0YXRlIChyZWQpXHJcbiAgJi5iZy1kYW5nZXIge1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI2RjMzU0NSAhaW1wb3J0YW50O1xyXG4gICAgY29sb3I6IHdoaXRlO1xyXG4gIH1cclxuICBcclxuICAvLyBOZXcgc3RhdGUgKGRhcmspXHJcbiAgJi5iZy1kYXJrIHtcclxuICAgIGJhY2tncm91bmQtY29sb3I6ICMzNDNhNDAgIWltcG9ydGFudDtcclxuICAgIGNvbG9yOiB3aGl0ZTtcclxuICB9XHJcbiAgXHJcbiAgLy8gRGV2LU5ldyBzdGF0ZSAoZGFyayB0ZWFsKVxyXG4gICYuYmFkZ2UtZGV2LW5ldyB7XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMmMzZTUwICFpbXBvcnRhbnQ7XHJcbiAgICBjb2xvcjogd2hpdGU7XHJcbiAgICBmb250LXdlaWdodDogNjAwO1xyXG4gIH1cclxuICBcclxuICAvLyBSZWFkeS9Bc3NpZ25lZCBzdGF0ZSAocHJldmlvdXNseSBsaWdodCB3aXRoIGJvcmRlcilcclxuICAmLmJnLWxpZ2h0IHtcclxuICAgIGJhY2tncm91bmQtY29sb3I6ICM5NTc1Y2QgIWltcG9ydGFudDsgLy8gTGlnaHQgcHVycGxlIGluc3RlYWQgb2Ygd2hpdGUvZ3JheVxyXG4gICAgYm9yZGVyOiAxcHggc29saWQgIzdlNTdjMiAhaW1wb3J0YW50O1xyXG4gICAgY29sb3I6IHdoaXRlICFpbXBvcnRhbnQ7XHJcbiAgICBcclxuICAgICYudGV4dC1kYXJrIHtcclxuICAgICAgY29sb3I6IHdoaXRlICFpbXBvcnRhbnQ7XHJcbiAgICAgIGZvbnQtd2VpZ2h0OiA3MDA7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIC8vIERlZmF1bHQvT3RoZXIgc3RhdGVzIChwcmV2aW91c2x5IGdyYXkpXHJcbiAgJi5iZy1zZWNvbmRhcnkge1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogIzVjNmJjMCAhaW1wb3J0YW50OyAvLyBJbmRpZ28gaW5zdGVhZCBvZiBncmF5XHJcbiAgICBjb2xvcjogd2hpdGU7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIFR5cGUgYmFkZ2VzXHJcbiAgJltjbGFzcyo9XCJiZy1cIl0ge1xyXG4gICAgYm9yZGVyLXJhZGl1czogMTJweDtcclxuICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7XHJcbiAgICBcclxuICAgICY6aG92ZXIge1xyXG4gICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTFweCk7XHJcbiAgICAgIGJveC1zaGFkb3c6IDAgMnB4IDRweCByZ2JhKDAsIDAsIDAsIDAuMTUpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuLy8gQXBwbHkgc29tZSBhZGRpdGlvbmFsIGNvbG9ycyBmb3Igc3BlY2lmaWMgc3RhdGUgdHlwZXMgdGhhdCBtaWdodCBoYXZlIGJlZW4gbWlzc2VkXHJcbi5iYWRnZS1yZWFkeSB7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogIzc5ODZjYiAhaW1wb3J0YW50OyAvLyBJbmRpZ28tMzAwXHJcbiAgY29sb3I6IHdoaXRlICFpbXBvcnRhbnQ7XHJcbn1cclxuXHJcbi5iYWRnZS1hc3NpZ25lZCB7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogIzlmYThkYSAhaW1wb3J0YW50OyAvLyBJbmRpZ28tMjAwXHJcbiAgY29sb3I6ICMzOTQ5YWIgIWltcG9ydGFudDtcclxufVxyXG5cclxuLmJhZGdlLW5hIHtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjNWM2YmMwICFpbXBvcnRhbnQ7IC8vIEluZGlnby00MDBcclxuICBjb2xvcjogd2hpdGUgIWltcG9ydGFudDtcclxufSAiXSwic291cmNlUm9vdCI6IiJ9 */\"]\n    });\n  }\n}","map":{"version":3,"mappings":"AACA,SAAiCA,UAAU,QAAQ,gBAAgB;AAGnE,SAASC,QAAQ,QAAiF,yBAAyB;AAC3H,SAASC,YAAY,EAAEC,oBAAoB,QAAQ,gBAAgB;;;;;;;;IC8BrDC,+BAAqD;IAC5CA,YAAoB;IAAAA,iBAAQ;;;;IAA5BA,eAAoB;IAApBA,2CAAoB;;;;;IAejCA,gCAA4D;IAAAA,YAA4B;IAAAA,iBAAO;;;;IAAnCA,eAA4B;IAA5BA,4DAA4B;;;;;IAIxFA,+BAA4D;IAE1BA,qCAAqB;IAAAA,iBAAO;IAE5DA,6BAA2B;IAAAA,qCAAqB;IAAAA,iBAAI;;;;;IAItDA,+BAA0G;IAClFA,8FAA4E;IAAAA,iBAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAgBlGA,8BAG6B;IADzBA;MAAA;MAAA;MAAA;MAAA,OAASA,+CAAoB;IAAA,EAAC;IAEhCA,8BAAoB;IAAAA,YAAc;IAAAA,iBAAK;IACvCA,0BAAI;IASCA,YAAgF;IAAAA,iBAAO;IAE5FA,0BAAI;IAAAA,YAAgB;IAAAA,iBAAK;IACzBA,0BAAI;IAAOA,yBAAiC;IAAAA,aAA2C;IAAAA,iBAAQ;IAC/FA,2BAAI;IAmBCA,aAAoC;IAAAA,iBAAO;;;;;IApC9CA,wHAAwD;IAGtCA,eAAc;IAAdA,2CAAc;IAECA,eAQ/B;IAR+BA,mwBAQ/B;IAACA,eAAgF;IAAhFA,0GAAgF;IAEjFA,eAAgB;IAAhBA,oCAAgB;IACwBA,eAA2C;IAA3CA,uEAA2C;IAEjEA,eAkBlB;IAlBkBA,0uDAkBlB;IAACA,eAAoC;IAApCA,gEAAoC;;;;;IAjDjDA,+BAAqF;IAI7DA,kBAAE;IAAAA,iBAAK;IACvBA,8BAAgB;IAAAA,oBAAI;IAAAA,iBAAK;IACzBA,8BAAgB;IAAAA,qBAAK;IAAAA,iBAAK;IAC1BA,+BAAgB;IAAAA,yBAAQ;IAAAA,iBAAK;IAC7BA,+BAAgB;IAAAA,sBAAK;IAAAA,iBAAK;IAG9BA,8BAAO;IACLA,kFAuCK;IACPA,iBAAQ;;;;IAxCeA,gBAAY;IAAZA,0CAAY;;;;;IAoDrCA,4BAA+B;IAAAA,YAAuC;IAAAA,iBAAO;;;;IAA9CA,eAAuC;IAAvCA,uEAAuC;;;;;IACtEA,4BAAgC;IAAAA,4BAAY;IAAAA,iBAAO;;;;;;IAgB/CA,kCAIwB;IAAtBA;MAAAA;MAAA;MAAA,OAASA,kCAAW;IAAA,EAAC;IACrBA,wBAA0B;IAC5BA,iBAAS;;;;;IAGTA,6BAAiE;IAAAA,iCAAiB;IAAAA,iBAAQ;;;;;IAC1FA,6BAAkE;IAAAA,mDAAmC;IAAAA,iBAAQ;;;;;IAF/GA,+BAAmH;IACjHA,oFAA0F;IAC1FA,oFAA6G;IAC/GA,iBAAM;;;;;;IAFIA,eAAuD;IAAvDA,iJAAuD;IACvDA,eAAwD;IAAxDA,kJAAwD;;;;;IAElEA,+BAAwD;IAC/CA,YAAmD;IAAAA,iBAAQ;;;;IAA3DA,eAAmD;IAAnDA,mFAAmD;;;;;IAUtDA,kCAAsD;IAAAA,YAAU;IAAAA,iBAAS;;;;IAAlCA,gCAAc;IAACA,eAAU;IAAVA,8BAAU;;;;;IAWhEA,kCAA4D;IAAAA,YAAY;IAAAA,iBAAS;;;;IAAtCA,kCAAgB;IAACA,eAAY;IAAZA,gCAAY;;;;;IAU5EA,+BAAoE;IAClEA,4BAK+B;IAC/BA,iCAA4E;IAC1EA,YACF;IAAAA,iBAAQ;;;;IALNA,eAA0C;IAA1CA,4DAA0C;IAGZA,eAA2C;IAA3CA,6DAA2C;IACzEA,eACF;IADEA,0CACF;;;;;IAGJA,+BAAsD;IAC7CA,wBAAiC;IAACA,iFAAgE;IAAAA,iBAAQ;;;;;IAUjHA,4BAAuB;IACrBA,wBAA+B;IAACA,+BAClC;IAAAA,iBAAO;;;;;IACPA,4BAAsB;IACpBA,2BAAuF;IACvFA,+BACF;IAAAA,iBAAO;;;;;IAYjBA,+BAAmD;IACjDA,YACF;IAAAA,iBAAM;;;;IADJA,eACF;IADEA,8CACF;;;;;IAkDUA,8BAA4E;IAC1EA,YACF;IAAAA,iBAAK;;;;IADHA,eACF;IADEA,2CACF;;;;;IAjDVA,8BAAyD;IAEzBA,kCAAkB;IAAAA,iBAAK;IAErDA,8BAAuB;IAIYA,YAA2C;IAAAA,iBAAK;IAC3EA,8BAAsB;IAAAA,qCAAoB;IAAAA,iBAAI;IAGhDA,gCAAkC;IAGXA,aAAqB;IAAAA,iBAAK;IAC3CA,8BAA2B;IAAAA,iCAAgB;IAAAA,iBAAI;IAGnDA,gCAAmB;IAEEA,aAAsB;IAAAA,iBAAK;IAC5CA,8BAA2B;IAAAA,6BAAY;IAAAA,iBAAI;IAKjDA,gCAAkB;IACZA,sCAAqB;IAAAA,iBAAK;IAC9BA,gCAAsB;IASlBA,aACF;IAAAA,iBAAM;IAKZA,gCAAsB;IAChBA,mCAAkB;IAAAA,iBAAK;IAC3BA,+BAAuB;IACrBA,gFAEK;IACPA,iBAAK;IAIXA,gCAA0C;IACxCA,yBAAiC;IAACA,oJACpC;IAAAA,iBAAM;;;;IAhD6BA,eAA2C;IAA3CA,4EAA2C;IAOjDA,eAAqB;IAArBA,6CAAqB;IAMrBA,eAAsB;IAAtBA,8CAAsB;IAYvCA,eAAwD;IAAxDA,4EAAwD;IADxDA,8FAAgE;IAGhEA,+EAA6D;IAG7DA,eACF;IADEA,mGACF;IAQ6CA,eAA2B;IAA3BA,0DAA2B;;;;;IAapFA,+BAAyD;IAErDA,wBAAmD;IACnDA,8BAAiB;IAAAA,oCAAoB;IAAAA,iBAAK;IAC1CA,6BAAsB;IAAAA,qGAAmF;IAAAA,iBAAI;;;;;;;;AD1RvH,OAAM,MAAOC,uBAAuB;EAuClCC,YACUC,EAAe,EACfC,iBAAoC,EACpCC,WAAwB;IAFxB,OAAE,GAAFF,EAAE;IACF,sBAAiB,GAAjBC,iBAAiB;IACjB,gBAAW,GAAXC,WAAW;IAxCrB,gBAAW,GAAa,EAAE;IAE1B;IACA,cAAS,GAAa,CACpB,YAAY,EACZ,MAAM,EACN,KAAK,EACL,MAAM,EACN,SAAS,EACT,OAAO,EACP,gBAAgB,EAChB,eAAe,EACf,MAAM,EACN,UAAU,CACX;IAED,qBAAgB,GAAa,CAC3B,KAAK,EACL,QAAQ,EACR,MAAM,CACP;IAED,YAAO,GAAG,KAAK;IACf,UAAK,GAAkB,IAAI;IAC3B,qBAAgB,GAAkC,IAAI;IACtD,eAAU,GAAG,KAAK;IAElB;IACA,wBAAmB,GAAW,EAAE,CAAC,CAAC;IAClC,cAAS,GAAuB,EAAE;IAClC,0BAAqB,GAAY,KAAK;IACtC,mBAAc,GAAkB,IAAI;IACpC,qBAAgB,GAA4B,IAAI;IAChD,oBAAe,GAAW,CAAC;IAC3B,qBAAgB,GAAW,CAAC;IAC5B,kBAAa,GAAW,CAAC;IAOvB,IAAI,CAACC,cAAc,GAAG,IAAI,CAACH,EAAE,CAACI,KAAK,CAAC;MAClCC,KAAK,EAAE,CAAC,EAAE,EAAE,CAACZ,UAAU,CAACa,QAAQ,EAAEb,UAAU,CAACc,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;MAC3DC,IAAI,EAAE,CAAC,SAAS,EAAEf,UAAU,CAACa,QAAQ,CAAC;MACtCG,QAAQ,EAAE,CAAC,EAAE,CAAC;MACdC,UAAU,EAAE,CAAC,QAAQ,EAAEjB,UAAU,CAACa,QAAQ;KAC3C,CAAC;EACJ;EAEAK,QAAQ;IACN;IACA,IAAI,CAACC,eAAe,EAAE;IAEtB;IACA,IAAI,CAACT,cAAc,CAACU,GAAG,CAAC,OAAO,CAAC,EAAEC,YAAY,CAC3CC,IAAI,CACHpB,YAAY,CAAC,GAAG,CAAC,EACjBC,oBAAoB,EAAE,CACvB,CACAoB,SAAS,CAACX,KAAK,IAAG;MACjB,IAAIA,KAAK,IAAIA,KAAK,CAACY,MAAM,GAAG,CAAC,EAAE;QAC7B,IAAI,CAACC,sBAAsB,CAACb,KAAK,CAAC;;IAEtC,CAAC,CAAC;EACN;EAEA;EACAO,eAAe;IACb,IAAI,CAACV,WAAW,CAACiB,cAAc,EAAE,CAACH,SAAS,CAAC;MAC1CI,IAAI,EAAGC,QAAQ,IAAI;QACjBC,OAAO,CAACC,GAAG,CAAC,4BAA4B,EAAEF,QAAQ,CAAC;QAEnD,IAAIG,KAAK,CAACC,OAAO,CAACJ,QAAQ,CAAC,EAAE;UAC3B,IAAIA,QAAQ,CAACJ,MAAM,KAAK,CAAC,EAAE;YACzBK,OAAO,CAACI,IAAI,CAAC,mCAAmC,CAAC;YACjD;;UAGF,IAAI,OAAOL,QAAQ,CAAC,CAAC,CAAC,KAAK,QAAQ,EAAE;YACnC;YACA,IAAI,CAACM,WAAW,GAAGN,QAAoB;WACxC,MAAM;YACL;YACA,IAAI,CAACM,WAAW,GAAIN,QAAyB,CAC1CO,MAAM,CAACC,CAAC,IAAIA,CAAC,IAAIA,CAAC,CAACC,WAAW,CAAC,CAAC;YAAA,CAChCC,GAAG,CAACF,CAAC,IAAIA,CAAC,CAACC,WAAW,CAAC;;UAG5B;UACA,MAAME,WAAW,GAAG,CAAC,mBAAmB,EAAE,WAAW,EAAE,iBAAiB,EAAE,0BAA0B,EAAE,gBAAgB,CAAC;UAEvH;UACAA,WAAW,CAACC,OAAO,CAACC,IAAI,IAAG;YACzB,IAAI,CAAC,IAAI,CAACP,WAAW,CAACQ,QAAQ,CAACD,IAAI,CAAC,EAAE;cACpC,IAAI,CAACP,WAAW,CAACS,IAAI,CAACF,IAAI,CAAC;;UAE/B,CAAC,CAAC;UAEFZ,OAAO,CAACC,GAAG,CAAC,UAAU,IAAI,CAACI,WAAW,CAACV,MAAM,gBAAgB,EAAE,IAAI,CAACU,WAAW,CAAC;;MAEpF,CAAC;MACDU,KAAK,EAAGC,GAAG,IAAI;QACbhB,OAAO,CAACe,KAAK,CAAC,6BAA6B,EAAEC,GAAG,CAAC;QACjD,IAAI,CAACD,KAAK,GAAG,6BAA6B;QAE1C;QACA,IAAI,CAACV,WAAW,GAAG,CAAC,mBAAmB,EAAE,WAAW,EAAE,iBAAiB,EAAE,0BAA0B,EAAE,gBAAgB,CAAC;QACtHL,OAAO,CAACC,GAAG,CAAC,mCAAmC,EAAE,IAAI,CAACI,WAAW,CAAC;MACpE;KACD,CAAC;EACJ;EAEA;EACAT,sBAAsB,CAACb,KAAa;IAClC,IAAI,CAAC,IAAI,CAACkC,SAAS,IAAI,IAAI,CAACA,SAAS,CAACtB,MAAM,KAAK,CAAC,EAAE;MAClD,OAAO,CAAC;;IAGV;IACA,MAAMuB,YAAY,GAAG,IAAI,CAACD,SAAS,CAACE,IAAI,CAACC,IAAI,IAC3CA,IAAI,CAACrC,KAAK,CAACsC,WAAW,EAAE,CAACR,QAAQ,CAAC9B,KAAK,CAACsC,WAAW,EAAE,CAAC,IACtDtC,KAAK,CAACsC,WAAW,EAAE,CAACR,QAAQ,CAACO,IAAI,CAACrC,KAAK,CAACsC,WAAW,EAAE,CAAC,CACvD;IAED,IAAIH,YAAY,EAAE;MAChB,IAAI,CAACI,gBAAgB,GAAGJ,YAAY;MACpC,IAAI,CAACK,wBAAwB,CAACL,YAAY,CAAC;;EAE/C;EAEA;EACAM,wBAAwB;IACtB,IAAI,CAAC,IAAI,CAACC,mBAAmB,IAAI,IAAI,CAACA,mBAAmB,CAACC,IAAI,EAAE,KAAK,EAAE,EAAE;MACvE,IAAI,CAACC,cAAc,GAAG,gCAAgC;MACtD;;IAGF,IAAI,CAACC,qBAAqB,GAAG,IAAI;IACjC,IAAI,CAACX,SAAS,GAAG,EAAE;IACnB,IAAI,CAACK,gBAAgB,GAAG,IAAI;IAC5B,IAAI,CAACK,cAAc,GAAG,IAAI;IAE1B,IAAI,CAAC/C,WAAW,CAACiD,QAAQ,CAAC,IAAI,CAACJ,mBAAmB,CAACC,IAAI,EAAE,CAAC,CAAChC,SAAS,CAAC;MACnEI,IAAI,EAAGgC,KAAK,IAAI;QACd;QACA,IAAI,CAACb,SAAS,GAAGa,KAAK,CAACrB,GAAG,CAACW,IAAI,IAAG;UAChC;UACA,MAAMW,aAAa,GAAG;YAAE,GAAGX;UAAI,CAAsB;UAErD;UACA,IAAI,CAACW,aAAa,CAACC,MAAM,EAAE;YACzBD,aAAa,CAACC,MAAM,GAAG,EAAE;;UAG3B;UACA,IAAID,aAAa,CAACE,KAAK,IAAIF,aAAa,CAACE,KAAK,CAACZ,WAAW,EAAE,CAACR,QAAQ,CAAC,SAAS,CAAC,EAAE;YAChFkB,aAAa,CAACE,KAAK,GAAGF,aAAa,CAACE,KAAK,CAACC,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC,CAACR,IAAI,EAAE;;UAG1E;UACA,IAAIK,aAAa,CAACC,MAAM,IAAID,aAAa,CAACC,MAAM,CAAC,cAAc,CAAC,EAAE;YAChE,IAAIC,KAAK,GAAGF,aAAa,CAACC,MAAM,CAAC,cAAc,CAAC;YAChD,IAAI,OAAOC,KAAK,KAAK,QAAQ,IAAIA,KAAK,CAACZ,WAAW,EAAE,CAACR,QAAQ,CAAC,SAAS,CAAC,EAAE;cACxEoB,KAAK,GAAGA,KAAK,CAACC,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC,CAACR,IAAI,EAAE;cAC5CK,aAAa,CAACC,MAAM,CAAC,cAAc,CAAC,GAAGC,KAAK;;YAE9C;YACA,IAAI,CAACF,aAAa,CAACE,KAAK,EAAE;cACxBF,aAAa,CAACE,KAAK,GAAGA,KAAK;;;UAI/B;UACA,IAAKb,IAAY,CAACe,MAAM,EAAE;YACxBJ,aAAa,CAACC,MAAM,CAAC,QAAQ,CAAC,GAAIZ,IAAY,CAACe,MAAM;;UAGvD,OAAOJ,aAAa;QACtB,CAAC,CAAC;QAEF,IAAI,CAACH,qBAAqB,GAAG,KAAK;QAClC5B,OAAO,CAACC,GAAG,CAAC,UAAU,IAAI,CAACgB,SAAS,CAACtB,MAAM,6BAA6B,IAAI,CAAC8B,mBAAmB,EAAE,CAAC;MACrG,CAAC;MACDV,KAAK,EAAGC,GAAG,IAAI;QACbhB,OAAO,CAACe,KAAK,CAAC,2BAA2B,EAAEC,GAAG,CAAC;QAC/C,IAAI,CAACW,cAAc,GAAG,4DAA4D;QAClF,IAAI,CAACC,qBAAqB,GAAG,KAAK;MACpC;KACD,CAAC;EACJ;EAEA;EACAQ,sBAAsB,CAACC,YAAoB;IACzC,IAAI,CAACA,YAAY,IAAI,CAAC,IAAI,CAAChC,WAAW,IAAI,IAAI,CAACA,WAAW,CAACV,MAAM,KAAK,CAAC,EAAE;MACvE,OAAO,EAAE;;IAGXK,OAAO,CAACC,GAAG,CAAC,6BAA6B,EAAEoC,YAAY,CAAC;IAExD;IACA,MAAMC,UAAU,GAAG,IAAI,CAACjC,WAAW,CAACc,IAAI,CAACoB,MAAM,IAAIA,MAAM,KAAKF,YAAY,CAAC;IAC3E,IAAIC,UAAU,EAAE;MACdtC,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAEqC,UAAU,CAAC;MAC7C,OAAOA,UAAU;;IAGnB;IACA,MAAME,oBAAoB,GAAG,IAAI,CAACnC,WAAW,CAACc,IAAI,CAChDoB,MAAM,IAAIA,MAAM,CAAClB,WAAW,EAAE,KAAKgB,YAAY,CAAChB,WAAW,EAAE,CAC9D;IACD,IAAImB,oBAAoB,EAAE;MACxBxC,OAAO,CAACC,GAAG,CAAC,+BAA+B,EAAEuC,oBAAoB,CAAC;MAClE,OAAOA,oBAAoB;;IAG7B;IACA,MAAMC,aAAa,GAAG,IAAI,CAACpC,WAAW,CAACc,IAAI,CACzCoB,MAAM,IAAIA,MAAM,CAAClB,WAAW,EAAE,CAACR,QAAQ,CAACwB,YAAY,CAAChB,WAAW,EAAE,CAAC,IAC1DgB,YAAY,CAAChB,WAAW,EAAE,CAACR,QAAQ,CAAC0B,MAAM,CAAClB,WAAW,EAAE,CAAC,CACnE;IACD,IAAIoB,aAAa,EAAE;MACjBzC,OAAO,CAACC,GAAG,CAAC,uBAAuB,EAAEwC,aAAa,CAAC;MACnD,OAAOA,aAAa;;IAGtB;IACA;IACA,MAAMC,SAAS,GAAGL,YAAY,CAAChB,WAAW,EAAE,CAACsB,KAAK,CAAC,QAAQ,CAAC,CAACrC,MAAM,CAACsC,IAAI,IAAIA,IAAI,CAACjD,MAAM,GAAG,CAAC,CAAC;IAC5F,IAAI+C,SAAS,CAAC/C,MAAM,GAAG,CAAC,EAAE;MACxBK,OAAO,CAACC,GAAG,CAAC,6BAA6B,EAAEyC,SAAS,CAAC;MAErD;MACA,MAAMG,aAAa,GAAG,IAAI,CAACxC,WAAW,CAACc,IAAI,CAACoB,MAAM,IAAG;QACnD,MAAMO,WAAW,GAAGP,MAAM,CAAClB,WAAW,EAAE;QACxC,OAAOqB,SAAS,CAACK,KAAK,CAACH,IAAI,IAAIE,WAAW,CAACjC,QAAQ,CAAC+B,IAAI,CAAC,CAAC;MAC5D,CAAC,CAAC;MAEF,IAAIC,aAAa,EAAE;QACjB7C,OAAO,CAACC,GAAG,CAAC,wCAAwC,EAAE4C,aAAa,CAAC;QACpE,OAAOA,aAAa;;MAGtB;MACA,KAAK,MAAMD,IAAI,IAAIF,SAAS,EAAE;QAC5B,IAAIE,IAAI,CAACjD,MAAM,GAAG,CAAC,EAAE,SAAS,CAAC;QAE/B,MAAMqD,YAAY,GAAG,IAAI,CAAC3C,WAAW,CAACc,IAAI,CACxCoB,MAAM,IAAIA,MAAM,CAAClB,WAAW,EAAE,CAACR,QAAQ,CAAC+B,IAAI,CAAC,CAC9C;QACD,IAAII,YAAY,EAAE;UAChBhD,OAAO,CAACC,GAAG,CAAC,6BAA6B,EAAE2C,IAAI,EAAE,IAAI,EAAEI,YAAY,CAAC;UACpE,OAAOA,YAAY;;;;IAKzB;IACA;IACA,IAAIN,SAAS,CAAC/C,MAAM,IAAI,CAAC,EAAE;MACzB,MAAMsD,YAAY,GAAGP,SAAS,CAAC,CAAC,CAAC,CAACQ,MAAM,CAAC,CAAC,CAAC;MAC3C,MAAMC,QAAQ,GAAGT,SAAS,CAACA,SAAS,CAAC/C,MAAM,GAAG,CAAC,CAAC;MAEhD,MAAMyD,aAAa,GAAG,IAAI,CAAC/C,WAAW,CAACc,IAAI,CAACoB,MAAM,IAAG;QACnD,MAAMc,WAAW,GAAGd,MAAM,CAAClB,WAAW,EAAE,CAACsB,KAAK,CAAC,QAAQ,CAAC;QACxD,IAAIU,WAAW,CAAC1D,MAAM,IAAI,CAAC,EAAE;UAC3B,MAAM2D,kBAAkB,GAAGD,WAAW,CAAC,CAAC,CAAC,CAACH,MAAM,CAAC,CAAC,CAAC;UACnD,MAAMK,cAAc,GAAGF,WAAW,CAACA,WAAW,CAAC1D,MAAM,GAAG,CAAC,CAAC;UAC1D,OAAO2D,kBAAkB,KAAKL,YAAY,IAAIM,cAAc,CAAC1C,QAAQ,CAACsC,QAAQ,CAAC;;QAEjF,OAAO,KAAK;MACd,CAAC,CAAC;MAEF,IAAIC,aAAa,EAAE;QACjBpD,OAAO,CAACC,GAAG,CAAC,6CAA6C,EAAEmD,aAAa,CAAC;QACzE,OAAOA,aAAa;;;IAIxB;IACA,MAAMI,gBAAgB,GAAGnB,YAAY,CAAChB,WAAW,EAAE,CAACoC,KAAK,CAAC,aAAa,CAAC;IACxE,IAAID,gBAAgB,IAAIA,gBAAgB,CAAC7D,MAAM,GAAG,CAAC,EAAE;MACnD,KAAK,MAAM+D,IAAI,IAAIF,gBAAgB,EAAE;QACnC,MAAMG,SAAS,GAAG,IAAI,CAACtD,WAAW,CAACc,IAAI,CACrCoB,MAAM,IAAIA,MAAM,CAAClB,WAAW,EAAE,CAACR,QAAQ,CAAC6C,IAAI,CAAC,CAC9C;QACD,IAAIC,SAAS,EAAE;UACb3D,OAAO,CAACC,GAAG,CAAC,oCAAoC,EAAEyD,IAAI,EAAE,IAAI,EAAEC,SAAS,CAAC;UACxE,OAAOA,SAAS;;;;IAKtB;IACA3D,OAAO,CAACC,GAAG,CAAC,sCAAsC,EAAEoC,YAAY,CAAC;IACjE,OAAOA,YAAY;EACrB;EAEA;EACAuB,cAAc,CAACxC,IAAsB;IACnC,IAAI,CAACE,gBAAgB,GAAGF,IAAI;IAC5B,IAAI,CAACG,wBAAwB,CAACH,IAAI,CAAC;EACrC;EAEA;EACAG,wBAAwB,CAACH,IAAsB;IAC7C,MAAMhC,UAAU,GAAG,IAAI,CAACyE,mBAAmB,CAACzC,IAAI,CAAC;IAEjD;IACA,IAAIjC,QAAQ,GAAG,EAAE;IACjB,IAAI2E,gBAAgB,GAAG,EAAE;IAEzB;IACA9D,OAAO,CAACC,GAAG,CAAC,qBAAqB,EAAEmB,IAAI,CAAC;IAExC;IACA,IAAIA,IAAI,CAACY,MAAM,IAAIZ,IAAI,CAACY,MAAM,CAAC,mBAAmB,CAAC,EAAE;MACnD,MAAM+B,UAAU,GAAG3C,IAAI,CAACY,MAAM,CAAC,mBAAmB,CAAC;MACnD,IAAI,OAAO+B,UAAU,KAAK,QAAQ,EAAE;QAClCD,gBAAgB,GAAGC,UAAU;QAC7B5E,QAAQ,GAAG4E,UAAU;OACtB,MAAM,IAAI,OAAOA,UAAU,KAAK,QAAQ,IAAIA,UAAU,KAAK,IAAI,EAAE;QAChE;QACA,IAAIA,UAAU,CAACvD,WAAW,EAAE;UAC1BsD,gBAAgB,GAAGC,UAAU,CAACvD,WAAW;UACzCrB,QAAQ,GAAG4E,UAAU,CAACvD,WAAW;;;;IAIvC;IAAA,KACK,IAAKY,IAAY,CAAC2C,UAAU,EAAE;MACjCD,gBAAgB,GAAG,OAAQ1C,IAAY,CAAC2C,UAAU,KAAK,QAAQ,GAC1D3C,IAAY,CAAC2C,UAAU,GACtB3C,IAAY,CAAC2C,UAAU,CAACvD,WAAW,IAAI,EAAG;MAChDrB,QAAQ,GAAG2E,gBAAgB;;IAG7B9D,OAAO,CAACC,GAAG,CAAC,mCAAmC,EAAE6D,gBAAgB,CAAC;IAClE9D,OAAO,CAACC,GAAG,CAAC,yBAAyB,EAAE,IAAI,CAACI,WAAW,CAAC;IAExD;IACA,IAAIlB,QAAQ,EAAE;MACZ,MAAM6E,gBAAgB,GAAG7E,QAAQ;MACjCA,QAAQ,GAAG,IAAI,CAACiD,sBAAsB,CAACjD,QAAQ,CAAC;MAChDa,OAAO,CAACC,GAAG,CAAC,0BAA0B+D,gBAAgB,SAAS7E,QAAQ,GAAG,CAAC;;IAG7E;IACA,IAAI8E,QAAQ,GAAG,EAAE;IAEjB;IACA,IAAI7C,IAAI,CAACY,MAAM,EAAE;MACf,IAAIZ,IAAI,CAACY,MAAM,CAAC,qBAAqB,CAAC,EAAE;QACtCiC,QAAQ,GAAG7C,IAAI,CAACY,MAAM,CAAC,qBAAqB,CAAC;;;IAIjD;IACA,IAAI,CAACiC,QAAQ,IAAI7C,IAAI,CAAClC,IAAI,EAAE;MAC1B+E,QAAQ,GAAG7C,IAAI,CAAClC,IAAI;;IAGtB;IACA,IAAI,CAAC+E,QAAQ,EAAE;MACb,MAAMlF,KAAK,GAAGqC,IAAI,CAACrC,KAAK,CAACsC,WAAW,EAAE;MACtC,IAAItC,KAAK,CAAC8B,QAAQ,CAAC,KAAK,CAAC,IAAI9B,KAAK,CAAC8B,QAAQ,CAAC,KAAK,CAAC,IAAI9B,KAAK,CAAC8B,QAAQ,CAAC,OAAO,CAAC,EAAE;QAC7EoD,QAAQ,GAAG,KAAK;OACjB,MAAM,IAAIlF,KAAK,CAAC8B,QAAQ,CAAC,SAAS,CAAC,IAAI9B,KAAK,CAAC8B,QAAQ,CAAC,WAAW,CAAC,IAAI9B,KAAK,CAAC8B,QAAQ,CAAC,SAAS,CAAC,EAAE;QAChGoD,QAAQ,GAAG,SAAS;OACrB,MAAM,IAAIlF,KAAK,CAAC8B,QAAQ,CAAC,QAAQ,CAAC,IAAI9B,KAAK,CAAC8B,QAAQ,CAAC,QAAQ,CAAC,IAAI9B,KAAK,CAAC8B,QAAQ,CAAC,QAAQ,CAAC,EAAE;QAC3FoD,QAAQ,GAAG,gBAAgB;OAC5B,MAAM,IAAIlF,KAAK,CAAC8B,QAAQ,CAAC,aAAa,CAAC,IAAI9B,KAAK,CAAC8B,QAAQ,CAAC,WAAW,CAAC,EAAE;QACvEoD,QAAQ,GAAG,aAAa;OACzB,MAAM;QACL;QACAA,QAAQ,GAAG,SAAS;;;IAIxB;IACA,IAAIA,QAAQ,IAAI,CAAC,IAAI,CAACC,SAAS,CAACrD,QAAQ,CAACoD,QAAQ,CAAC,EAAE;MAClD;MACA,IAAI,CAACC,SAAS,CAACpD,IAAI,CAACmD,QAAQ,CAAC;;IAG/B;IACA,IAAI,CAACpF,cAAc,CAACsF,UAAU,CAAC;MAC7BpF,KAAK,EAAEqC,IAAI,CAACrC,KAAK;MACjBG,IAAI,EAAE+E,QAAQ;MACd9E,QAAQ,EAAEA,QAAQ;MAClBC,UAAU,EAAEA;KACb,CAAC;IAEFY,OAAO,CAACC,GAAG,CAAC,6BAA6BgE,QAAQ,cAAc9E,QAAQ,gBAAgBC,UAAU,EAAE,CAAC;IAEpG;IACA,IAAI,IAAI,CAACgF,gBAAgB,EAAE;MACzB,IAAI,CAACC,sBAAsB,CAAC,IAAI,CAACD,gBAAgB,CAACE,cAAc,CAAC;;EAErE;EAEA;EACAT,mBAAmB,CAACzC,IAAsB;IACxC;IACA,IAAIhC,UAAU,GAAG,QAAQ;IAEzB;IACA,MAAML,KAAK,GAAGqC,IAAI,CAACrC,KAAK,CAACsC,WAAW,EAAE;IACtC,IAAItC,KAAK,CAAC8B,QAAQ,CAAC,UAAU,CAAC,IAAI9B,KAAK,CAAC8B,QAAQ,CAAC,QAAQ,CAAC,IAAI9B,KAAK,CAAC8B,QAAQ,CAAC,OAAO,CAAC,IACjF9B,KAAK,CAAC8B,QAAQ,CAAC,mBAAmB,CAAC,IAAI9B,KAAK,CAAC8B,QAAQ,CAAC,UAAU,CAAC,EAAE;MACrE,OAAO,MAAM;;IAGf,IAAI9B,KAAK,CAAC8B,QAAQ,CAAC,OAAO,CAAC,IAAI9B,KAAK,CAAC8B,QAAQ,CAAC,OAAO,CAAC,IAAI9B,KAAK,CAAC8B,QAAQ,CAAC,SAAS,CAAC,IAC/E9B,KAAK,CAAC8B,QAAQ,CAAC,eAAe,CAAC,IAAI9B,KAAK,CAAC8B,QAAQ,CAAC,MAAM,CAAC,EAAE;MAC7D,OAAO,KAAK;;IAGd;IACA,MAAMoD,QAAQ,GAAG,IAAI,CAACM,eAAe,CAACnD,IAAI,CAAC;IAC3C,IAAI6C,QAAQ,KAAK,KAAK,IAAIA,QAAQ,KAAK,gBAAgB,IAAIA,QAAQ,KAAK,SAAS,EAAE;MACjF;MACA7E,UAAU,GAAG,QAAQ;MAErB;MACA,IAAI6E,QAAQ,KAAK,KAAK,EAAE;QACtB7E,UAAU,GAAG,MAAM;;;IAIvB;IACA,IAAIgC,IAAI,CAACoD,QAAQ,KAAKC,SAAS,EAAE;MAC/B,IAAIrD,IAAI,CAACoD,QAAQ,IAAI,CAAC,EAAE;QACtBpF,UAAU,GAAG,MAAM;OACpB,MAAM,IAAIgC,IAAI,CAACoD,QAAQ,KAAK,CAAC,EAAE;QAC9BpF,UAAU,GAAG,QAAQ;OACtB,MAAM;QACLA,UAAU,GAAG,KAAK;;;IAItB;IACA,IAAIgC,IAAI,CAACY,MAAM,EAAE;MACf;MACA,MAAM0C,gBAAgB,GAAG,CACvB,kCAAkC,EAClC,kCAAkC,EAClC,mBAAmB,EACnB,mBAAmB,CACpB;MAED,KAAK,MAAMC,KAAK,IAAID,gBAAgB,EAAE;QACpC,IAAItD,IAAI,CAACY,MAAM,CAAC2C,KAAK,CAAC,EAAE;UACtB,MAAMC,UAAU,GAAGxD,IAAI,CAACY,MAAM,CAAC2C,KAAK,CAAC;UACrC,IAAI,OAAOC,UAAU,KAAK,QAAQ,EAAE;YAClC,IAAIA,UAAU,CAAC/D,QAAQ,CAAC,MAAM,CAAC,IAAI+D,UAAU,CAAC/D,QAAQ,CAAC,GAAG,CAAC,EAAE;cAC3D,OAAO,MAAM;aACd,MAAM,IAAI+D,UAAU,CAAC/D,QAAQ,CAAC,KAAK,CAAC,IAAI+D,UAAU,CAAC/D,QAAQ,CAAC,GAAG,CAAC,EAAE;cACjE,OAAO,KAAK;;WAEf,MAAM,IAAI,OAAO+D,UAAU,KAAK,QAAQ,EAAE;YACzC,IAAIA,UAAU,IAAI,CAAC,EAAE;cACnB,OAAO,MAAM;aACd,MAAM,IAAIA,UAAU,IAAI,CAAC,EAAE;cAC1B,OAAO,KAAK;;;;;;IAOtB,OAAOxF,UAAU;EACnB;EAEA;EACAmF,eAAe,CAACnD,IAAsB;IACpC;IACA,IAAIA,IAAI,CAACY,MAAM,IAAIZ,IAAI,CAACY,MAAM,CAAC,qBAAqB,CAAC,EAAE;MACrD,OAAOZ,IAAI,CAACY,MAAM,CAAC,qBAAqB,CAAC;;IAG3C;IACA,OAAOZ,IAAI,CAAClC,IAAI,IAAI,SAAS;EAC/B;EAEA2F,SAAS;IACP,IAAI,CAAChG,cAAc,CAACiG,KAAK,CAAC;MACxB5F,IAAI,EAAE,SAAS;MACfE,UAAU,EAAE;KACb,CAAC;IACF,IAAI,CAAC2B,KAAK,GAAG,IAAI;IACjB,IAAI,CAACgE,UAAU,GAAG,KAAK;IACvB,IAAI,CAACX,gBAAgB,GAAG,IAAI;EAC9B;EAEAY,gBAAgB;IACd,IAAI,IAAI,CAACnG,cAAc,CAACoG,OAAO,EAAE;MAC/B;MACAC,MAAM,CAACC,IAAI,CAAC,IAAI,CAACtG,cAAc,CAACuG,QAAQ,CAAC,CAACzE,OAAO,CAAC0E,GAAG,IAAG;QACtD,IAAI,CAACxG,cAAc,CAACU,GAAG,CAAC8F,GAAG,CAAC,EAAEC,aAAa,EAAE;MAC/C,CAAC,CAAC;MACF;;IAEF,IAAI,CAACC,OAAO,GAAG,IAAI;IACnB,IAAI,CAACxE,KAAK,GAAG,IAAI;IACjB,IAAI,CAACqD,gBAAgB,GAAG,IAAI;IAC5B,IAAI,CAACW,UAAU,GAAG,KAAK;IACvB,MAAMS,OAAO,GAA0B;MACrCzG,KAAK,EAAE,IAAI,CAACF,cAAc,CAAC4G,KAAK,CAAC1G,KAAK;MACtCG,IAAI,EAAE,IAAI,CAACL,cAAc,CAAC4G,KAAK,CAACvG,IAAI;MACpCC,QAAQ,EAAE,IAAI,CAACN,cAAc,CAAC4G,KAAK,CAACtG,QAAQ;MAC5CC,UAAU,EAAE,IAAI,CAACP,cAAc,CAAC4G,KAAK,CAACrG;KACvC;IACD;IACA,IAAI,IAAI,CAACkC,gBAAgB,IAAI,IAAI,CAACA,gBAAgB,CAACoE,EAAE,EAAE;MACrD;MACA,MAAMC,UAAU,GAAG,OAAO,IAAI,CAACrE,gBAAgB,CAACoE,EAAE,KAAK,QAAQ,GAC3DE,QAAQ,CAAC,IAAI,CAACtE,gBAAgB,CAACoE,EAAE,EAAE,EAAE,CAAC,GACtC,IAAI,CAACpE,gBAAgB,CAACoE,EAAE;MAE5B,IAAI,CAACG,KAAK,CAACF,UAAU,CAAC,EAAE;QACtBH,OAAO,CAACG,UAAU,GAAGA,UAAU;QAE/B;QACA3F,OAAO,CAACC,GAAG,CAAC,4CAA4C0F,UAAU,EAAE,CAAC;QACrE,IAAI,CAAC/G,WAAW,CAACkH,sBAAsB,CAACH,UAAU,CAAC,CAACjG,SAAS,CAAC;UAC5DI,IAAI,EAAGiG,YAAY,IAAI;YACrB/F,OAAO,CAACC,GAAG,CAAC,gCAAgC0F,UAAU,eAAe,CAAC;YAEtE;YACA,IAAII,YAAY,CAACC,QAAQ,IAAID,YAAY,CAACC,QAAQ,CAACrG,MAAM,GAAG,CAAC,EAAE;cAC7DK,OAAO,CAACC,GAAG,CAAC,iBAAiB8F,YAAY,CAACC,QAAQ,CAACrG,MAAM,wBAAwB,CAAC;cAElF;cACA,MAAMsG,cAAc,GAAG,IAAI,CAACC,6BAA6B,CAACH,YAAY,CAAC;cAEvE;cACA,IAAI,CAAC3B,gBAAgB,GAAG;gBACtBE,cAAc,EAAE2B,cAAc,CAACE,KAAK;gBACpCC,YAAY,EAAEH,cAAc,CAACI,WAAW;gBACxCC,aAAa,EAAEL,cAAc,CAACM,OAAO;gBACrCC,eAAe,EAAE,IAAI;gBACrBC,OAAO,EAAE,CACP,8BAA8Bd,UAAU,UAAU,EAClD,cAAcH,OAAO,CAACtG,IAAI,EAAE,EAC5B,GAAGsG,OAAO,CAACpG,UAAU,aAAa,EAClC,oCAAoC;eAEvC;cAED,IAAI,CAAC2F,UAAU,GAAG,IAAI;cACtB,IAAI,CAACQ,OAAO,GAAG,KAAK;cACpB,IAAI,CAACmB,eAAe,GAAG,IAAI,CAACtC,gBAAgB,CAACgC,YAAY,IAAI,CAAC;cAC9D,IAAI,CAACO,gBAAgB,GAAG,IAAI,CAACvC,gBAAgB,CAACkC,aAAa,IAAI,CAAC;cAChE,IAAI,CAACM,aAAa,GAAG,IAAI,CAACxC,gBAAgB,CAACE,cAAc;aAC1D,MAAM;cACLtE,OAAO,CAACC,GAAG,CAAC,2EAA2E,CAAC;cACxF,IAAI,CAAC4G,4BAA4B,CAACrB,OAAO,CAAC;;UAE9C,CAAC;UACDzE,KAAK,EAAGC,GAAG,IAAI;YACbhB,OAAO,CAACe,KAAK,CAAC,mCAAmC,EAAEC,GAAG,CAAC;YACvDhB,OAAO,CAACC,GAAG,CAAC,4CAA4C,CAAC;YACzD,IAAI,CAAC4G,4BAA4B,CAACrB,OAAO,CAAC;UAC5C;SACD,CAAC;QAEF,OAAO,CAAC;;;IAIZ;IACA;IACA,IAAI,CAACqB,4BAA4B,CAACrB,OAAO,CAAC;EAC5C;EAEA;;;EAGQqB,4BAA4B,CAACrB,OAA8B;IACjE;IACA,MAAMsB,aAAa,GAAI,IAAI,CAACxF,gBAAgB,IAAI,IAAI,CAACA,gBAAgB,CAACwF,aAAa,IAAK,IAAI,CAACrF,mBAAmB;IAEhH,IAAIqF,aAAa,EAAE;MACjBtB,OAAO,CAACuB,cAAc,GAAG,IAAI,CAAC,CAAC;MAE/B/G,OAAO,CAACC,GAAG,CAAC,8CAA8C,GAAG6G,aAAa,CAAC;MAE3E;MACA,IAAI,CAAClI,WAAW,CAACoI,cAAc,CAACF,aAAa,CAAC,CAACpH,SAAS,CAAC;QACvDI,IAAI,EAAGmH,YAAwB,IAAI;UACjCjH,OAAO,CAACC,GAAG,CAAC,aAAagH,YAAY,CAACtH,MAAM,8BAA8BmH,aAAa,EAAE,CAAC;UAE1F,IAAIG,YAAY,CAACtH,MAAM,KAAK,CAAC,EAAE;YAC7B;YACAK,OAAO,CAACC,GAAG,CAAC,sDAAsD,CAAC;YACnE,IAAI,CAACiH,yBAAyB,CAAC1B,OAAO,CAAC;YACvC;;UAGF;UACA;UACA,MAAM2B,wBAAwB,GAAG,IAAI,CAACC,eAAe,CAACH,YAAY,EAAEzB,OAAO,CAACtG,IAAI,EAAEsG,OAAO,CAACpG,UAAU,CAAC;UAErG;UACAoG,OAAO,CAAC6B,eAAe,GAAGF,wBAAwB;UAElD;UACA,IAAIA,wBAAwB,CAACxH,MAAM,GAAG,CAAC,EAAE;YACvCK,OAAO,CAACC,GAAG,CAAC,+CAA+C,CAAC;YAE5D;YACA,MAAMqH,YAAY,GAAG,IAAI,CAACC,gBAAgB,CAACJ,wBAAwB,EAAE3B,OAAO,CAAC;YAE7E,IAAI8B,YAAY,CAAC3H,MAAM,GAAG,CAAC,EAAE;cAC3B;cACA,MAAM6H,QAAQ,GAAGF,YAAY,CAACG,MAAM,CAAC,CAACC,GAAW,EAAEtG,IAAc,KAAKsG,GAAG,IAAItG,IAAI,CAACuG,WAAW,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,GAAGL,YAAY,CAAC3H,MAAM;cAC7H,MAAMiI,MAAM,GAAGN,YAAY,CAACG,MAAM,CAAC,CAACC,GAAW,EAAEtG,IAAc,KAAKsG,GAAG,IAAItG,IAAI,CAACyG,gBAAgB,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,GAAGP,YAAY,CAAC3H,MAAM;cAChI,MAAMmI,OAAO,GAAGR,YAAY,CAACG,MAAM,CAAC,CAACC,GAAW,EAAEtG,IAAc,KAAKsG,GAAG,IAAItG,IAAI,CAAC2G,YAAY,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,GAAGT,YAAY,CAAC3H,MAAM;cAE7H;cACA,IAAI,CAACyE,gBAAgB,GAAG;gBACtBE,cAAc,EAAE0D,MAAM,CAACR,QAAQ,CAACS,OAAO,CAAC,CAAC,CAAC,CAAC;gBAC3C7B,YAAY,EAAE4B,MAAM,CAACJ,MAAM,CAACK,OAAO,CAAC,CAAC,CAAC,CAAC;gBACvC3B,aAAa,EAAE0B,MAAM,CAACF,OAAO,CAACG,OAAO,CAAC,CAAC,CAAC,CAAC;gBACzCzB,eAAe,EAAE,IAAI,CAAC0B,wBAAwB,CAACZ,YAAY,CAAC3H,MAAM,EAAEsH,YAAY,CAACtH,MAAM,CAAC;gBACxF8G,OAAO,EAAE,CACP,cAAcjB,OAAO,CAACtG,IAAI,EAAE,EAC5B,GAAGsG,OAAO,CAACpG,UAAU,aAAa,EAClC,YAAYkI,YAAY,CAAC3H,MAAM,0BAA0B,EACzD,YAAY6F,OAAO,CAACrG,QAAQ,IAAI,YAAY,EAAE;eAEjD;cAED,IAAI,CAAC4F,UAAU,GAAG,IAAI;cACtB,IAAI,CAACQ,OAAO,GAAG,KAAK;cACpB,IAAI,CAACmB,eAAe,GAAG,IAAI,CAACtC,gBAAgB,CAACgC,YAAY,IAAI,CAAC;cAC9D,IAAI,CAACO,gBAAgB,GAAG,IAAI,CAACvC,gBAAgB,CAACkC,aAAa,IAAI,CAAC;cAChE,IAAI,CAACM,aAAa,GAAG,IAAI,CAACxC,gBAAgB,CAACE,cAAc;aAC1D,MAAM;cACL;cACA,IAAI,CAAC4C,yBAAyB,CAAC1B,OAAO,CAAC;;WAE1C,MAAM;YACL;YACA,IAAI,CAAC0B,yBAAyB,CAAC1B,OAAO,CAAC;;QAE3C,CAAC;QACDzE,KAAK,EAAGC,GAAQ,IAAI;UAClBhB,OAAO,CAACe,KAAK,CAAC,kCAAkC,EAAEC,GAAG,CAAC;UACtDhB,OAAO,CAACC,GAAG,CAAC,qCAAqC,CAAC;UAClD,IAAI,CAACiH,yBAAyB,CAAC1B,OAAO,CAAC;QACzC;OACD,CAAC;KACH,MAAM;MACL;MACA,IAAI,CAAC0B,yBAAyB,CAAC1B,OAAO,CAAC;;EAE3C;EAEA;;;EAGQ0B,yBAAyB,CAAC1B,OAA8B;IAC9D,IAAI,CAAC7G,iBAAiB,CAACqG,gBAAgB,CAACQ,OAAO,CAAC,CAAC9F,SAAS,CAAC;MACzDI,IAAI,EAAGqI,MAAM,IAAI;QACf,IAAI,CAAC/D,gBAAgB,GAAG+D,MAAM;QAC9B,IAAI,CAACpD,UAAU,GAAG,IAAI;QACtB,IAAI,CAACV,sBAAsB,CAAC8D,MAAM,CAAC7D,cAAc,CAAC;QAClD,IAAI,CAACiB,OAAO,GAAG,KAAK;MACtB,CAAC;MACDxE,KAAK,EAAGC,GAAG,IAAI;QACbhB,OAAO,CAACe,KAAK,CAAC,6BAA6B,EAAEC,GAAG,CAAC;QACjD,IAAI,CAACD,KAAK,GAAG,iDAAiD;QAC9D,IAAI,CAACwE,OAAO,GAAG,KAAK;MACtB;KACD,CAAC;EACJ;EAEA;;;;EAIQ6B,eAAe,CAACtF,KAAiB,EAAEsG,QAAgB,EAAEhJ,UAAkB;IAC7E,OAAO0C,KAAK,CAACrB,GAAG,CAACW,IAAI,IAAG;MACtB;MACA,MAAMW,aAAa,GAAa;QAAE,GAAGX;MAAI,CAAE;MAE3C;MACA,IAAIA,IAAI,CAACuG,WAAW,IAAIvG,IAAI,CAACyG,gBAAgB,IAAIzG,IAAI,CAAC2G,YAAY,EAAE;QAClE,OAAOhG,aAAa;;MAGtB;MACA,MAAMsG,SAAS,GAAG,IAAI,CAACC,kBAAkB,CAAClH,IAAI,CAAClC,IAAI,IAAIkJ,QAAQ,CAAC;MAChE,MAAMG,UAAU,GAAG,IAAI,CAACC,uBAAuB,CAACpJ,UAAU,CAAC;MAE3D;MACA,MAAMqJ,cAAc,GAAGJ,SAAS,GAAGE,UAAU;MAE7C;MACA,MAAMG,QAAQ,GAAGtJ,UAAU,KAAK,MAAM,GAAG,GAAG,GAAIA,UAAU,KAAK,KAAK,GAAG,GAAG,GAAG,IAAK;MAClF,MAAMuJ,QAAQ,GAAGF,cAAc,GAAGC,QAAQ;MAC1C,MAAME,SAAS,GAAGH,cAAc,GAAGE,QAAQ;MAE3C;MACA5G,aAAa,CAAC4F,WAAW,GAAGK,MAAM,CAACS,cAAc,CAACR,OAAO,CAAC,CAAC,CAAC,CAAC;MAC7DlG,aAAa,CAAC8F,gBAAgB,GAAGG,MAAM,CAACW,QAAQ,CAACV,OAAO,CAAC,CAAC,CAAC,CAAC;MAC5DlG,aAAa,CAACgG,YAAY,GAAGC,MAAM,CAACY,SAAS,CAACX,OAAO,CAAC,CAAC,CAAC,CAAC;MAEzD,OAAOlG,aAAa;IACtB,CAAC,CAAC;EACJ;EAEA;;;EAGQwF,gBAAgB,CAACzF,KAAiB,EAAE0D,OAA8B;IACxE;IACA,OAAO1D,KAAK,CAACxB,MAAM,CAACc,IAAI,IAAG;MACzB;MACA,MAAMyH,SAAS,GAAGzH,IAAI,CAAClC,IAAI,EAAEmC,WAAW,EAAE,KAAKmE,OAAO,CAACtG,IAAI,CAACmC,WAAW,EAAE;MAEzE;MACA,MAAMyH,cAAc,GAAG,IAAI,CAACjF,mBAAmB,CAACzC,IAAwB,CAAC;MACzE,MAAM2H,eAAe,GAAGD,cAAc,CAACzH,WAAW,EAAE,KAAKmE,OAAO,CAACpG,UAAU,CAACiC,WAAW,EAAE;MAEzF;MACA,OAAOwH,SAAS,IAAIE,eAAe;IACrC,CAAC,CAAC;EACJ;EAEA;;;EAGQb,wBAAwB,CAACc,YAAoB,EAAEC,UAAkB;IACvE;IACA,IAAID,YAAY,KAAK,CAAC,EAAE,OAAO,GAAG;IAElC;IACA,MAAME,cAAc,GAAGC,IAAI,CAACC,GAAG,CAAC,IAAI,EAAE,GAAG,GAAIJ,YAAY,GAAG,EAAG,CAAC;IAEhE;IACA,MAAMK,eAAe,GAAGL,YAAY,GAAGC,UAAU,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC;IAEjE;IACA,OAAOE,IAAI,CAACC,GAAG,CAAC,IAAI,EAAEF,cAAc,GAAGG,eAAe,CAAC;EACzD;EAEA;EACAhF,sBAAsB,CAACiF,UAAkB;IACvC;IACA,MAAMlK,UAAU,GAAG,IAAI,CAACP,cAAc,CAAC4G,KAAK,CAACrG,UAAU;IACvD,IAAIsJ,QAAQ,GAAG,IAAI,CAAC,CAAC;IAErB;IACA,IAAItJ,UAAU,KAAK,MAAM,EAAE;MACzBsJ,QAAQ,GAAG,GAAG,CAAC,CAAC;KACjB,MAAM,IAAItJ,UAAU,KAAK,KAAK,EAAE;MAC/BsJ,QAAQ,GAAG,GAAG,CAAC,CAAC;;;IAGlB,IAAI,CAAChC,eAAe,GAAGyC,IAAI,CAACI,KAAK,CAACD,UAAU,GAAGZ,QAAQ,GAAG,EAAE,CAAC,GAAG,EAAE;IAClE,IAAI,CAAC/B,gBAAgB,GAAGwC,IAAI,CAACI,KAAK,CAAC,CAACD,UAAU,GAAG,IAAI,CAAC5C,eAAe,IAAI,EAAE,CAAC,GAAG,EAAE;IACjF,IAAI,CAACE,aAAa,GAAG0C,UAAU;EACjC;EAEA;EACAE,gBAAgB,CAACC,KAAa;IAC5B,OAAO,GAAGN,IAAI,CAACI,KAAK,CAACE,KAAK,GAAG,GAAG,CAAC,GAAG;EACtC;EAEA;EACAC,kBAAkB,CAACD,KAAa;IAC9B,IAAIA,KAAK,IAAI,GAAG,EAAE;MAChB,OAAO,YAAY;KACpB,MAAM,IAAIA,KAAK,IAAI,GAAG,EAAE;MACvB,OAAO,YAAY;KACpB,MAAM,IAAIA,KAAK,IAAI,GAAG,EAAE;MACvB,OAAO,YAAY;KACpB,MAAM;MACL,OAAO,WAAW;;EAEtB;EAEA;EACAE,eAAe,CAACvI,IAAsB;IACpC,IAAIZ,WAAW,GAAG,EAAE;IAEpB;IACA,IAAIY,IAAI,CAACY,MAAM,IAAIZ,IAAI,CAACY,MAAM,CAAC,mBAAmB,CAAC,EAAE;MACnD,MAAM+B,UAAU,GAAG3C,IAAI,CAACY,MAAM,CAAC,mBAAmB,CAAC;MACnD,IAAI,OAAO+B,UAAU,KAAK,QAAQ,EAAE;QAClCvD,WAAW,GAAGuD,UAAU;OACzB,MAAM,IAAI,OAAOA,UAAU,KAAK,QAAQ,IAAIA,UAAU,KAAK,IAAI,EAAE;QAChE,IAAIA,UAAU,CAACvD,WAAW,EAAE;UAC1BA,WAAW,GAAGuD,UAAU,CAACvD,WAAW;;;;IAK1C;IACA,IAAI,CAACA,WAAW,IAAIY,IAAI,CAAC2C,UAAU,EAAE;MACnC,IAAI,OAAO3C,IAAI,CAAC2C,UAAU,KAAK,QAAQ,EAAE;QACvCvD,WAAW,GAAGY,IAAI,CAAC2C,UAAU;OAC9B,MAAM,IAAI,OAAO3C,IAAI,CAAC2C,UAAU,KAAK,QAAQ,IAAI3C,IAAI,CAAC2C,UAAU,KAAK,IAAI,EAAE;QAC1E,MAAM6F,WAAW,GAAGxI,IAAI,CAAC2C,UAAiB;QAC1CvD,WAAW,GAAGoJ,WAAW,CAACpJ,WAAW,IAAIoJ,WAAW,CAACC,IAAI,IAAI,EAAE;;;IAInE;IACA,IAAIrJ,WAAW,EAAE;MACf,OAAO,IAAI,CAAC4B,sBAAsB,CAAC5B,WAAW,CAAC;;IAGjD,OAAO,EAAE;EACX;EAEA;EACAsJ,eAAe,CAAC1I,IAAsB;IACpC;IACA,IAAIA,IAAI,CAACY,MAAM,IAAIZ,IAAI,CAACY,MAAM,CAAC,cAAc,CAAC,EAAE;MAC9C,MAAMC,KAAK,GAAGb,IAAI,CAACY,MAAM,CAAC,cAAc,CAAC;MACzC,IAAI,OAAOC,KAAK,KAAK,QAAQ,EAAE;QAC7B;QACA,OAAOA,KAAK,CAACC,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC,CAACR,IAAI,EAAE;;;IAI/C;IACA,IAAKN,IAAY,CAACe,MAAM,EAAE;MACxB,OAAO,OAAQf,IAAY,CAACe,MAAM,KAAK,QAAQ,GAAIf,IAAY,CAACe,MAAM,GAAG,EAAE;;IAG7E,IAAIf,IAAI,CAACY,MAAM,IAAIZ,IAAI,CAACY,MAAM,CAAC,QAAQ,CAAC,EAAE;MACxC,OAAO,OAAOZ,IAAI,CAACY,MAAM,CAAC,QAAQ,CAAC,KAAK,QAAQ,GAAGZ,IAAI,CAACY,MAAM,CAAC,QAAQ,CAAC,GAAG,EAAE;;IAG/E;IACA,IAAIZ,IAAI,CAACa,KAAK,EAAE;MACd,OAAOb,IAAI,CAACa,KAAK,CAACC,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC,CAACR,IAAI,EAAE;;IAGlD,OAAO,KAAK,CAAC,CAAC;EAChB;EAEA;;;EAGQ4G,kBAAkB,CAACpJ,IAAwB;IACjD,MAAM6K,eAAe,GAA4B;MAC/C,KAAK,EAAE,CAAC;MACR,MAAM,EAAE,CAAC;MACT,SAAS,EAAE,CAAC;MACZ,YAAY,EAAE,CAAC;MACf,gBAAgB,EAAE,CAAC;MACnB,aAAa,EAAE,CAAC;MAChB,eAAe,EAAE,CAAC;MAClB,MAAM,EAAE;KACT;IAED,OAAO7K,IAAI,GAAI6K,eAAe,CAAC7K,IAAI,CAAC,IAAI,CAAC,GAAI,CAAC,CAAC,CAAC;EAClD;EAEA;;;EAGQsJ,uBAAuB,CAACpJ,UAAkB;IAChD,MAAM4K,WAAW,GAA4B;MAC3C,KAAK,EAAE,GAAG;MACV,QAAQ,EAAE,GAAG;MACb,MAAM,EAAE;KACT;IAED,OAAOA,WAAW,CAAC5K,UAAU,CAAC,IAAI,GAAG;EACvC;EAEA;;;;EAIQ8G,6BAA6B,CAAC+D,QAAyB;IAC7DjK,OAAO,CAACC,GAAG,CAAC,8CAA8C,CAAC;IAE3D;IACA,MAAMkI,MAAM,GAAG;MACbhC,KAAK,EAAE,CAAC;MACRE,WAAW,EAAE,CAAC;MACdE,OAAO,EAAE;KACV;IAED;IACA,MAAM2D,gBAAgB,GAAGD,QAAQ,CAACjE,QAAQ,EAAE1F,MAAM,CAAE6J,CAAc,IAAKA,CAAC,CAACxF,KAAK,KAAK,OAAO,IAAIwF,CAAC,CAACxF,KAAK,KAAK,cAAc,CAAC,IAAI,EAAE;IAC/H3E,OAAO,CAACC,GAAG,CAAC,SAASiK,gBAAgB,CAACvK,MAAM,oBAAoB,CAAC;IAEjE,IAAIuK,gBAAgB,CAACvK,MAAM,KAAK,CAAC,EAAE;MACjC;MACA,MAAMP,UAAU,GAAG,IAAI,CAACyE,mBAAmB,CAACoG,QAA4B,CAAC;MACzE,MAAM5B,SAAS,GAAG,IAAI,CAACC,kBAAkB,CAAC,IAAI,CAAC/D,eAAe,CAAC0F,QAA4B,CAAC,CAAC;MAC7F,MAAM1B,UAAU,GAAG,IAAI,CAACC,uBAAuB,CAACpJ,UAAU,CAAC;MAE3D+I,MAAM,CAAChC,KAAK,GAAG6B,MAAM,CAAC,CAACK,SAAS,GAAGE,UAAU,EAAEN,OAAO,CAAC,CAAC,CAAC,CAAC;MAC1DE,MAAM,CAAC9B,WAAW,GAAG2B,MAAM,CAAC,CAACG,MAAM,CAAChC,KAAK,GAAG,IAAI,EAAE8B,OAAO,CAAC,CAAC,CAAC,CAAC;MAC7DE,MAAM,CAAC5B,OAAO,GAAGyB,MAAM,CAAC,CAACG,MAAM,CAAChC,KAAK,GAAG,IAAI,EAAE8B,OAAO,CAAC,CAAC,CAAC,CAAC;MAEzD,OAAOE,MAAM;;IAGf;IACA+B,gBAAgB,CAACE,IAAI,CAAC,CAACD,CAAc,EAAEE,CAAc,KAAI;MACvD,MAAMC,KAAK,GAAG,IAAIC,IAAI,CAACJ,CAAC,CAACK,WAAW,CAAC,CAACC,OAAO,EAAE;MAC/C,MAAMC,KAAK,GAAG,IAAIH,IAAI,CAACF,CAAC,CAACG,WAAW,CAAC,CAACC,OAAO,EAAE;MAC/C,OAAOH,KAAK,GAAGI,KAAK;IACtB,CAAC,CAAC;IAEF;IACA,MAAMC,QAAQ,GAAiF,EAAE;IAEjG;IACAT,gBAAgB,CAACvJ,OAAO,CAAC,CAACiK,UAAuB,EAAEC,KAAa,KAAI;MAClE,MAAMC,YAAY,GAAGF,UAAU,CAACG,QAAQ,IAAI,EAAE;MAC9C,MAAMC,SAAS,GAAG,IAAIT,IAAI,CAACK,UAAU,CAACJ,WAAW,CAAC;MAElD;MACAG,QAAQ,CAAC7J,IAAI,CAAC;QACZmB,KAAK,EAAE6I,YAAY;QACnBE,SAAS,EAAEA;OACZ,CAAC;MAEF;MACA,IAAIH,KAAK,GAAG,CAAC,EAAE;QACbF,QAAQ,CAACE,KAAK,GAAG,CAAC,CAAC,CAACI,OAAO,GAAGD,SAAS;QAEvC;QACA,MAAME,aAAa,GAAGP,QAAQ,CAACE,KAAK,GAAG,CAAC,CAAC,CAACG,SAAS;QACnD,MAAMG,UAAU,GAAGH,SAAS,CAACP,OAAO,EAAE,GAAGS,aAAa,CAACT,OAAO,EAAE;QAChE,MAAMW,aAAa,GAAGD,UAAU,IAAI,IAAI,GAAG,EAAE,GAAG,EAAE,CAAC;QAEnD;QACA;QACA,IAAIE,aAAa,GAAGD,aAAa;QAEjC;QACA,IAAIA,aAAa,GAAG,EAAE,EAAE;UACtB;UACA,MAAME,IAAI,GAAGnC,IAAI,CAACoC,KAAK,CAACH,aAAa,GAAG,EAAE,CAAC;UAC3C,MAAMI,QAAQ,GAAGrC,IAAI,CAACsC,GAAG,CAACtC,IAAI,CAACuC,IAAI,CAACJ,IAAI,GAAG,CAAC,GAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;UACrDD,aAAa,GAAGG,QAAQ,GAAG,CAAC,GAAIJ,aAAa,GAAG,EAAG,CAAC,CAAC;UAErD;UACAC,aAAa,GAAGlC,IAAI,CAACC,GAAG,CAACiC,aAAa,EAAED,aAAa,GAAG,GAAG,CAAC;;QAG9DT,QAAQ,CAACE,KAAK,GAAG,CAAC,CAAC,CAACO,aAAa,GAAGpD,MAAM,CAACqD,aAAa,CAACpD,OAAO,CAAC,CAAC,CAAC,CAAC;;IAExE,CAAC,CAAC;IAEF;IACA,IAAIgC,QAAQ,CAAChI,KAAK,KAAK,QAAQ,IAAIgI,QAAQ,CAAChI,KAAK,KAAK,MAAM,IAAIgI,QAAQ,CAAChI,KAAK,KAAK,WAAW,EAAE;MAC9F;MACA,MAAM0J,SAAS,GAAGhB,QAAQ,CAAChL,MAAM,GAAG,CAAC;MACrC,IAAIgM,SAAS,IAAI,CAAC,EAAE;QAClB,MAAMC,GAAG,GAAG,IAAIrB,IAAI,EAAE;QACtBI,QAAQ,CAACgB,SAAS,CAAC,CAACV,OAAO,GAAGW,GAAG;QAEjC,MAAMT,UAAU,GAAGS,GAAG,CAACnB,OAAO,EAAE,GAAGE,QAAQ,CAACgB,SAAS,CAAC,CAACX,SAAS,CAACP,OAAO,EAAE;QAC1E,MAAMW,aAAa,GAAGD,UAAU,IAAI,IAAI,GAAG,EAAE,GAAG,EAAE,CAAC;QAEnD;QACA,IAAIE,aAAa,GAAGD,aAAa;QACjC,IAAIA,aAAa,GAAG,EAAE,EAAE;UACtB,MAAME,IAAI,GAAGnC,IAAI,CAACoC,KAAK,CAACH,aAAa,GAAG,EAAE,CAAC;UAC3C,MAAMI,QAAQ,GAAGrC,IAAI,CAACsC,GAAG,CAACtC,IAAI,CAACuC,IAAI,CAACJ,IAAI,GAAG,CAAC,GAAC,CAAC,CAAC,EAAE,CAAC,CAAC;UACnDD,aAAa,GAAGG,QAAQ,GAAG,CAAC,GAAIJ,aAAa,GAAG,EAAG;UACnDC,aAAa,GAAGlC,IAAI,CAACC,GAAG,CAACiC,aAAa,EAAED,aAAa,GAAG,GAAG,CAAC;;QAG9DT,QAAQ,CAACgB,SAAS,CAAC,CAACP,aAAa,GAAGpD,MAAM,CAACqD,aAAa,CAACpD,OAAO,CAAC,CAAC,CAAC,CAAC;;;IAIxE;IACA0C,QAAQ,CAAChK,OAAO,CAACkL,KAAK,IAAG;MACvB,IAAI,CAACA,KAAK,CAACT,aAAa,EAAE;MAE1B,MAAMnJ,KAAK,GAAG4J,KAAK,CAAC5J,KAAK,CAACZ,WAAW,EAAE;MAEvC;MACA,IAAIY,KAAK,CAACpB,QAAQ,CAAC,KAAK,CAAC,IAAIoB,KAAK,CAACpB,QAAQ,CAAC,UAAU,CAAC,IAAIoB,KAAK,CAACpB,QAAQ,CAAC,SAAS,CAAC,EAAE;QACpF;MAAA,CACD,MAAM,IAAIoB,KAAK,CAACpB,QAAQ,CAAC,QAAQ,CAAC,IAAIoB,KAAK,CAACpB,QAAQ,CAAC,UAAU,CAAC,IAAIoB,KAAK,CAACpB,QAAQ,CAAC,aAAa,CAAC,EAAE;QAClG;QACAsH,MAAM,CAAC9B,WAAW,IAAIwF,KAAK,CAACT,aAAa;OAC1C,MAAM,IAAInJ,KAAK,CAACpB,QAAQ,CAAC,QAAQ,CAAC,IAAIoB,KAAK,CAACpB,QAAQ,CAAC,MAAM,CAAC,IAAIoB,KAAK,CAACpB,QAAQ,CAAC,IAAI,CAAC,EAAE;QACrF;QACAsH,MAAM,CAAC5B,OAAO,IAAIsF,KAAK,CAACT,aAAa;OACtC,MAAM,IAAInJ,KAAK,CAACpB,QAAQ,CAAC,UAAU,CAAC,IAAIoB,KAAK,CAACpB,QAAQ,CAAC,MAAM,CAAC,IAAIoB,KAAK,CAACpB,QAAQ,CAAC,QAAQ,CAAC,EAAE;QAC3F;QACAsH,MAAM,CAAC5B,OAAO,IAAIsF,KAAK,CAACT,aAAa,GAAG,GAAG;OAC5C,MAAM;QACL;QACAjD,MAAM,CAAC9B,WAAW,IAAIwF,KAAK,CAACT,aAAa,GAAG,GAAG;QAC/CjD,MAAM,CAAC5B,OAAO,IAAIsF,KAAK,CAACT,aAAa,GAAG,GAAG;;IAE/C,CAAC,CAAC;IAEF;IACAjD,MAAM,CAAChC,KAAK,GAAG6B,MAAM,CAAC,CAACG,MAAM,CAAC9B,WAAW,GAAG8B,MAAM,CAAC5B,OAAO,EAAE0B,OAAO,CAAC,CAAC,CAAC,CAAC;IAEvE;IACA,IAAIE,MAAM,CAAChC,KAAK,GAAG,GAAG,EAAE;MACtB;MACA,MAAM/G,UAAU,GAAG,IAAI,CAACyE,mBAAmB,CAACoG,QAA4B,CAAC;MACzE,MAAM5B,SAAS,GAAG,IAAI,CAACC,kBAAkB,CAAC,IAAI,CAAC/D,eAAe,CAAC0F,QAA4B,CAAC,CAAC;MAC7F,MAAM1B,UAAU,GAAG,IAAI,CAACC,uBAAuB,CAACpJ,UAAU,CAAC;MAE3D+I,MAAM,CAAChC,KAAK,GAAG6B,MAAM,CAAC,CAACK,SAAS,GAAGE,UAAU,EAAEN,OAAO,CAAC,CAAC,CAAC,CAAC;MAC1DE,MAAM,CAAC9B,WAAW,GAAG2B,MAAM,CAAC,CAACG,MAAM,CAAChC,KAAK,GAAG,IAAI,EAAE8B,OAAO,CAAC,CAAC,CAAC,CAAC;MAC7DE,MAAM,CAAC5B,OAAO,GAAGyB,MAAM,CAAC,CAACG,MAAM,CAAChC,KAAK,GAAG,IAAI,EAAE8B,OAAO,CAAC,CAAC,CAAC,CAAC;;IAG3D;IACAE,MAAM,CAAC9B,WAAW,GAAG2B,MAAM,CAACG,MAAM,CAAC9B,WAAW,CAAC4B,OAAO,CAAC,CAAC,CAAC,CAAC;IAC1DE,MAAM,CAAC5B,OAAO,GAAGyB,MAAM,CAACG,MAAM,CAAC5B,OAAO,CAAC0B,OAAO,CAAC,CAAC,CAAC,CAAC;IAElDjI,OAAO,CAACC,GAAG,CAAC,iCAAiCkI,MAAM,CAAChC,KAAK,SAASgC,MAAM,CAAC9B,WAAW,UAAU8B,MAAM,CAAC5B,OAAO,EAAE,CAAC;IAC/G,OAAO4B,MAAM;EACf;;;uBAtgCW3J,uBAAuB;IAAA;EAAA;;;YAAvBA,uBAAuB;MAAAsN;MAAAC;MAAAC;MAAAC;MAAAC;QAAA;UCrBpC3N,8BAAiC;UAGVA,wCAAwB;UAAAA,iBAAK;UAC9CA,4BAA2B;UAAAA,kGAAkF;UAAAA,iBAAI;UAKrHA,8BAAsB;UAIcA,qCAAoB;UAAAA,iBAAK;UAEvDA,+BAAuB;UAI2CA,+BAAc;UAAAA,iBAAQ;UAChFA,kCAMqC;UAFnCA;YAAA;UAAA,EAAiC;UAJnCA,iBAMqC;UACrCA,mCAIoC;UADlCA;YAAA,OAAS4N,8BAA0B;UAAA,EAAC;UAEpC5N,yBAA4B;UAACA,6BAC/B;UAAAA,iBAAS;UAEXA,2EAEM;UACRA,iBAAM;UAOhBA,gCAAiB;UAKmBA,2BAAU;UAAAA,iBAAK;UAC3CA,6EAA+F;UACjGA,iBAAM;UACNA,+BAAuB;UAErBA,2EAKM;UAGNA,2EAEM;UAGNA,4EAsDM;UACRA,iBAAM;UAKVA,gCAAsB;UAIdA,6EAA6E;UAC7EA,6EAAmD;UACrDA,iBAAK;UAEPA,+BAAuB;UACcA;YAAA,OAAY4N,sBAAkB;UAAA,EAAC;UAEhE5N,gCAAkB;UAC0BA,2BAAU;UAAAA,iBAAQ;UAC5DA,gCAAyB;UACvBA,6BAMsD;UACtDA,iFAMS;UACXA,iBAAM;UACNA,2EAGM;UACNA,2EAEM;UACRA,iBAAM;UAENA,gCAAiB;UAI8BA,0BAAS;UAAAA,iBAAQ;UAC1DA,mCAAiE;UAC/DA,iFAAyE;UAC3EA,iBAAS;UAIbA,gCAAsB;UAGuBA,yBAAQ;UAAAA,iBAAQ;UACzDA,mCAAqE;UAClDA,iCAAgB;UAAAA,iBAAS;UAC1CA,iFAAiF;UACnFA,iBAAS;UAMfA,gCAAkB;UACUA,2BAAU;UAAAA,iBAAQ;UAC5CA,gCAAoB;UAClBA,2EAUM;UACRA,iBAAM;UACNA,2EAEM;UACRA,iBAAM;UAGNA,gCAAiD;UACCA;YAAA,OAAS4N,eAAW;UAAA,EAAC;UACnE5N,yBAA4C;UAACA,wBAC/C;UAAAA,iBAAS;UACTA,mCAAmE;UACjEA,6EAEO;UACPA,6EAGO;UACTA,iBAAS;UAQrBA,gCAAsB;UAGlBA,2EAEM;UAGNA,4EAyDM;UAGNA,2EAMM;UACRA,iBAAM;;;;;UA1RQA,gBAAiC;UAAjCA,iDAAiC;UAOjCA,eAAiC;UAAjCA,mDAAiC;UAI/BA,eAAoB;UAApBA,yCAAoB;UAgBvBA,eAA0B;UAA1BA,+CAA0B;UAI3BA,eAA2B;UAA3BA,gDAA2B;UAQ3BA,eAAyE;UAAzEA,sGAAyE;UAKzEA,eAAoD;UAApDA,6EAAoD;UAgEjDA,eAAsB;UAAtBA,2CAAsB;UACtBA,eAAuB;UAAvBA,4CAAuB;UAI1BA,eAA4B;UAA5BA,8CAA4B;UAW1BA,eAAmD;UAAnDA,oFAAmD;UAElDA,eAAwC;UAAxCA,mGAAwC;UAOvCA,eAAkF;UAAlFA,2LAAkF;UAIlFA,eAAsB;UAAtBA,2CAAsB;UAWGA,eAAY;UAAZA,uCAAY;UAWVA,eAAc;UAAdA,yCAAc;UAUEA,eAAmB;UAAnBA,8CAAmB;UAY9DA,eAAsB;UAAtBA,2CAAsB;UAUkBA,eAAoB;UAApBA,sCAAoB;UACzDA,eAAc;UAAdA,mCAAc;UAGdA,eAAa;UAAbA,kCAAa;UAexBA,eAAW;UAAXA,gCAAW;UAKXA,eAAoC;UAApCA,6DAAoC;UA4DpCA,eAA2B;UAA3BA,oDAA2B","names":["Validators","WorkItem","debounceTime","distinctUntilChanged","i0","TaskEstimationComponent","constructor","fb","estimationService","taskService","estimationForm","group","title","required","minLength","type","assignee","complexity","ngOnInit","loadTeamMembers","get","valueChanges","pipe","subscribe","length","autoPopulateFormFields","getTeamMembers","next","response","console","log","Array","isArray","warn","teamMembers","filter","m","displayName","map","commonUsers","forEach","user","includes","push","error","err","workItems","matchingItem","find","item","toLowerCase","selectedWorkItem","populateFormWithWorkItem","loadWorkItemsByIteration","manualIterationPath","trim","iterationError","loadingIterationItems","getTasks","items","processedItem","fields","state","replace","status","findMatchingTeamMember","assigneeName","exactMatch","member","caseInsensitiveMatch","containsMatch","nameParts","split","part","allPartsMatch","memberLower","every","partialMatch","firstInitial","charAt","lastName","initialsMatch","memberParts","memberFirstInitial","memberLastName","significantWords","match","word","wordMatch","selectWorkItem","determineComplexity","originalAssignee","assignedTo","previousAssignee","itemType","taskTypes","patchValue","estimationResult","calculateTimeEstimates","estimatedHours","getWorkItemType","priority","undefined","complexityFields","field","fieldValue","resetForm","reset","showResult","estimateTaskTime","invalid","Object","keys","controls","key","markAsTouched","loading","request","value","id","workItemId","parseInt","isNaN","getWorkItemWithHistory","detailedItem","activity","estimatedTimes","calculateEstimatesFromHistory","total","devTimeHours","development","testTimeHours","testing","confidenceScore","factors","devTimeEstimate","testTimeEstimate","totalEstimate","estimateFromIterationHistory","iterationPath","includeHistory","getTaskHistory","historyItems","performStandardEstimation","estimatedHistoricalItems","inferTimingData","historicalItems","similarItems","findSimilarItems","avgTotal","reduce","sum","actualHours","avgDev","developmentHours","avgTest","testingHours","Number","toFixed","calculateConfidenceScore","result","taskType","baseHours","getBaseHoursByType","multiplier","getComplexityMultiplier","estimatedTotal","devRatio","devHours","testHours","typeMatch","itemComplexity","complexityMatch","similarCount","totalCount","baseConfidence","Math","min","percentageBonus","totalHours","round","formatConfidence","score","getConfidenceClass","getAssigneeName","assigneeObj","name","getStateDisplay","baseHoursByType","multipliers","workItem","stateTransitions","a","sort","b","dateA","Date","changedDate","getTime","dateB","timeline","transition","index","currentState","newValue","startDate","endDate","prevStartDate","durationMs","durationHours","adjustedHours","days","floor","workDays","max","ceil","lastIndex","now","entry","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["E:\\Project-AI\\AI-Scrum\\frontend\\src\\app\\components\\task-estimation\\task-estimation.component.ts","E:\\Project-AI\\AI-Scrum\\frontend\\src\\app\\components\\task-estimation\\task-estimation.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { EstimationService, TaskEstimationRequest, TaskEstimationResponse } from '../../services/estimation.service';\r\nimport { TaskService } from '../../services/task.service';\r\nimport { WorkItem, WorkItemHistory, TeamMember, WorkItemType, WorkItemDetails, ActivityLog } from '../../models/task.model';\r\nimport { debounceTime, distinctUntilChanged } from 'rxjs/operators';\r\n\r\n// Extended WorkItem interface to include fields property\r\ninterface ExtendedWorkItem extends WorkItem {\r\n  fields?: {\r\n    'System.AssignedTo'?: string | { displayName: string; [key: string]: any };\r\n    'System.WorkItemType'?: string;\r\n    [key: string]: any;\r\n  };\r\n}\r\n\r\n@Component({\r\n  selector: 'app-task-estimation',\r\n  templateUrl: './task-estimation.component.html',\r\n  styleUrls: ['./task-estimation.component.scss']\r\n})\r\nexport class TaskEstimationComponent implements OnInit {\r\n  estimationForm: FormGroup;\r\n  teamMembers: string[] = [];\r\n  \r\n  // Include all available work item types from the enum\r\n  taskTypes: string[] = [\r\n    'User Story',\r\n    'Task',\r\n    'Bug',\r\n    'Epic',\r\n    'Feature',\r\n    'Issue',\r\n    'Change Request',\r\n    'Documentation',\r\n    'Test',\r\n    'Research'\r\n  ];\r\n  \r\n  complexityLevels: string[] = [\r\n    'Low',\r\n    'Medium',\r\n    'High'\r\n  ];\r\n  \r\n  loading = false;\r\n  error: string | null = null;\r\n  estimationResult: TaskEstimationResponse | null = null;\r\n  showResult = false;\r\n\r\n  // New properties for iteration path functionality\r\n  manualIterationPath: string = ''; // Only use manual iteration path\r\n  workItems: ExtendedWorkItem[] = [];\r\n  loadingIterationItems: boolean = false;\r\n  iterationError: string | null = null;\r\n  selectedWorkItem: ExtendedWorkItem | null = null;\r\n  devTimeEstimate: number = 0;\r\n  testTimeEstimate: number = 0;\r\n  totalEstimate: number = 0;\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private estimationService: EstimationService,\r\n    private taskService: TaskService\r\n  ) {\r\n    this.estimationForm = this.fb.group({\r\n      title: ['', [Validators.required, Validators.minLength(5)]],\r\n      type: ['Feature', Validators.required],\r\n      assignee: [''],\r\n      complexity: ['Medium', Validators.required]\r\n    });\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    // Load team members\r\n    this.loadTeamMembers();\r\n\r\n    // Listen for title changes to auto-fill fields\r\n    this.estimationForm.get('title')?.valueChanges\r\n      .pipe(\r\n        debounceTime(300),\r\n        distinctUntilChanged()\r\n      )\r\n      .subscribe(title => {\r\n        if (title && title.length > 5) {\r\n          this.autoPopulateFormFields(title);\r\n        }\r\n      });\r\n  }\r\n\r\n  // Load team members with better error handling\r\n  loadTeamMembers(): void {\r\n    this.taskService.getTeamMembers().subscribe({\r\n      next: (response) => {\r\n        console.log('Team members API response:', response);\r\n        \r\n        if (Array.isArray(response)) {\r\n          if (response.length === 0) {\r\n            console.warn('No team members returned from API');\r\n            return;\r\n          }\r\n          \r\n          if (typeof response[0] === 'string') {\r\n            // It's an array of strings\r\n            this.teamMembers = response as string[];\r\n          } else {\r\n            // It's an array of TeamMember objects\r\n            this.teamMembers = (response as TeamMember[])\r\n              .filter(m => m && m.displayName) // Filter out invalid entries\r\n              .map(m => m.displayName);\r\n          }\r\n          \r\n          // Add some failsafe common users based on the work items we've seen\r\n          const commonUsers = ['Bhavya Damodharan', 'Suresh GM', 'Ranjith Kumar S', 'Vignesh Ram Suresh kumar', 'Dinesh Kumar K'];\r\n          \r\n          // Add any common users not already in the list\r\n          commonUsers.forEach(user => {\r\n            if (!this.teamMembers.includes(user)) {\r\n              this.teamMembers.push(user);\r\n            }\r\n          });\r\n          \r\n          console.log(`Loaded ${this.teamMembers.length} team members:`, this.teamMembers);\r\n        }\r\n      },\r\n      error: (err) => {\r\n        console.error('Error loading team members:', err);\r\n        this.error = 'Failed to load team members';\r\n        \r\n        // Fallback to a default list of common users\r\n        this.teamMembers = ['Bhavya Damodharan', 'Suresh GM', 'Ranjith Kumar S', 'Vignesh Ram Suresh kumar', 'Dinesh Kumar K'];\r\n        console.log('Using fallback team members list:', this.teamMembers);\r\n      }\r\n    });\r\n  }\r\n\r\n  // Auto-populate form fields based on entered title\r\n  autoPopulateFormFields(title: string): void {\r\n    if (!this.workItems || this.workItems.length === 0) {\r\n      return; // No items to search through\r\n    }\r\n\r\n    // Find matching work item by title (full or partial match)\r\n    const matchingItem = this.workItems.find(item => \r\n      item.title.toLowerCase().includes(title.toLowerCase()) || \r\n      title.toLowerCase().includes(item.title.toLowerCase())\r\n    );\r\n\r\n    if (matchingItem) {\r\n      this.selectedWorkItem = matchingItem;\r\n      this.populateFormWithWorkItem(matchingItem);\r\n    }\r\n  }\r\n\r\n  // Load work items for the selected iteration path\r\n  loadWorkItemsByIteration(): void {\r\n    if (!this.manualIterationPath || this.manualIterationPath.trim() === '') {\r\n      this.iterationError = 'Please enter an iteration path';\r\n      return;\r\n    }\r\n\r\n    this.loadingIterationItems = true;\r\n    this.workItems = [];\r\n    this.selectedWorkItem = null;\r\n    this.iterationError = null;\r\n\r\n    this.taskService.getTasks(this.manualIterationPath.trim()).subscribe({\r\n      next: (items) => {\r\n        // Process items to clean up state information\r\n        this.workItems = items.map(item => {\r\n          // Process each item to ensure it has proper state\r\n          const processedItem = { ...item } as ExtendedWorkItem;\r\n          \r\n          // Make sure the fields object exists\r\n          if (!processedItem.fields) {\r\n            processedItem.fields = {};\r\n          }\r\n          \r\n          // Fix state display - remove \"Unknown\" prefix if present\r\n          if (processedItem.state && processedItem.state.toLowerCase().includes('unknown')) {\r\n            processedItem.state = processedItem.state.replace(/unknown/i, '').trim();\r\n          }\r\n          \r\n          // Also check for state in fields\r\n          if (processedItem.fields && processedItem.fields['System.State']) {\r\n            let state = processedItem.fields['System.State'];\r\n            if (typeof state === 'string' && state.toLowerCase().includes('unknown')) {\r\n              state = state.replace(/unknown/i, '').trim();\r\n              processedItem.fields['System.State'] = state;\r\n            }\r\n            // If item has no state but has System.State, use it\r\n            if (!processedItem.state) {\r\n              processedItem.state = state;\r\n            }\r\n          }\r\n          \r\n          // Capture status field if present in the payload and map it to fields\r\n          if ((item as any).status) {\r\n            processedItem.fields['status'] = (item as any).status;\r\n          }\r\n          \r\n          return processedItem;\r\n        });\r\n        \r\n        this.loadingIterationItems = false;\r\n        console.log(`Loaded ${this.workItems.length} work items for iteration ${this.manualIterationPath}`);\r\n      },\r\n      error: (err) => {\r\n        console.error('Error loading work items:', err);\r\n        this.iterationError = 'Failed to load work items for the specified iteration path';\r\n        this.loadingIterationItems = false;\r\n      }\r\n    });\r\n  }\r\n\r\n  // Helper method to find the best matching team member for an assignee\r\n  findMatchingTeamMember(assigneeName: string): string {\r\n    if (!assigneeName || !this.teamMembers || this.teamMembers.length === 0) {\r\n      return '';\r\n    }\r\n    \r\n    console.log('Finding match for assignee:', assigneeName);\r\n    \r\n    // First try exact match\r\n    const exactMatch = this.teamMembers.find(member => member === assigneeName);\r\n    if (exactMatch) {\r\n      console.log('Found exact match:', exactMatch);\r\n      return exactMatch;\r\n    }\r\n    \r\n    // Then try case-insensitive exact match\r\n    const caseInsensitiveMatch = this.teamMembers.find(\r\n      member => member.toLowerCase() === assigneeName.toLowerCase()\r\n    );\r\n    if (caseInsensitiveMatch) {\r\n      console.log('Found case-insensitive match:', caseInsensitiveMatch);\r\n      return caseInsensitiveMatch;\r\n    }\r\n    \r\n    // Then try contains matches (member contains assignee or assignee contains member)\r\n    const containsMatch = this.teamMembers.find(\r\n      member => member.toLowerCase().includes(assigneeName.toLowerCase()) ||\r\n               assigneeName.toLowerCase().includes(member.toLowerCase())\r\n    );\r\n    if (containsMatch) {\r\n      console.log('Found contains match:', containsMatch);\r\n      return containsMatch;\r\n    }\r\n    \r\n    // Split full names and try to match individual parts\r\n    // This helps with formats like \"First Last\" vs \"Last, First\"\r\n    const nameParts = assigneeName.toLowerCase().split(/[\\s,]+/).filter(part => part.length > 1);\r\n    if (nameParts.length > 1) {\r\n      console.log('Trying to match name parts:', nameParts);\r\n      \r\n      // Try to find a member that contains all name parts\r\n      const allPartsMatch = this.teamMembers.find(member => {\r\n        const memberLower = member.toLowerCase();\r\n        return nameParts.every(part => memberLower.includes(part));\r\n      });\r\n      \r\n      if (allPartsMatch) {\r\n        console.log('Found match containing all name parts:', allPartsMatch);\r\n        return allPartsMatch;\r\n      }\r\n      \r\n      // Try to find a member that contains any significant name part\r\n      for (const part of nameParts) {\r\n        if (part.length < 3) continue; // Skip short parts like initials\r\n        \r\n        const partialMatch = this.teamMembers.find(\r\n          member => member.toLowerCase().includes(part)\r\n        );\r\n        if (partialMatch) {\r\n          console.log('Found match with name part:', part, '->', partialMatch);\r\n          return partialMatch;\r\n        }\r\n      }\r\n    }\r\n    \r\n    // If we have a name that appears to be \"Firstname Lastname\"\r\n    // Try a more aggressive match against first letters + full last name\r\n    if (nameParts.length >= 2) {\r\n      const firstInitial = nameParts[0].charAt(0);\r\n      const lastName = nameParts[nameParts.length - 1];\r\n      \r\n      const initialsMatch = this.teamMembers.find(member => {\r\n        const memberParts = member.toLowerCase().split(/[\\s,]+/);\r\n        if (memberParts.length >= 2) {\r\n          const memberFirstInitial = memberParts[0].charAt(0);\r\n          const memberLastName = memberParts[memberParts.length - 1];\r\n          return memberFirstInitial === firstInitial && memberLastName.includes(lastName);\r\n        }\r\n        return false;\r\n      });\r\n      \r\n      if (initialsMatch) {\r\n        console.log('Found match with first initial + last name:', initialsMatch);\r\n        return initialsMatch;\r\n      }\r\n    }\r\n    \r\n    // Last resort: try to match any word of length 4+ as a potential name fragment\r\n    const significantWords = assigneeName.toLowerCase().match(/\\b\\w{4,}\\b/g);\r\n    if (significantWords && significantWords.length > 0) {\r\n      for (const word of significantWords) {\r\n        const wordMatch = this.teamMembers.find(\r\n          member => member.toLowerCase().includes(word)\r\n        );\r\n        if (wordMatch) {\r\n          console.log('Found match with significant word:', word, '->', wordMatch);\r\n          return wordMatch;\r\n        }\r\n      }\r\n    }\r\n    \r\n    // If no match found after all attempts, return the original name\r\n    console.log('No match found, using original name:', assigneeName);\r\n    return assigneeName;\r\n  }\r\n\r\n  // Select a work item for estimation\r\n  selectWorkItem(item: ExtendedWorkItem): void {\r\n    this.selectedWorkItem = item;\r\n    this.populateFormWithWorkItem(item);\r\n  }\r\n\r\n  // Populate the form with selected work item details\r\n  populateFormWithWorkItem(item: ExtendedWorkItem): void {\r\n    const complexity = this.determineComplexity(item);\r\n    \r\n    // Extract assignee name, trying 'System.AssignedTo' first\r\n    let assignee = '';\r\n    let originalAssignee = '';\r\n    \r\n    // Debug log the item details\r\n    console.log('Selected work item:', item);\r\n    \r\n    // Check for fields property which might contain System.AssignedTo\r\n    if (item.fields && item.fields['System.AssignedTo']) {\r\n      const assignedTo = item.fields['System.AssignedTo'];\r\n      if (typeof assignedTo === 'string') {\r\n        originalAssignee = assignedTo;\r\n        assignee = assignedTo;\r\n      } else if (typeof assignedTo === 'object' && assignedTo !== null) {\r\n        // Try to get displayName property\r\n        if (assignedTo.displayName) {\r\n          originalAssignee = assignedTo.displayName;\r\n          assignee = assignedTo.displayName;\r\n        }\r\n      }\r\n    }\r\n    // Check for direct assignee property which is most common in Azure DevOps API\r\n    else if ((item as any).assignedTo) {\r\n      originalAssignee = typeof (item as any).assignedTo === 'string' \r\n        ? (item as any).assignedTo \r\n        : ((item as any).assignedTo.displayName || '');\r\n      assignee = originalAssignee;\r\n    }\r\n    \r\n    console.log('Original assignee from work item:', originalAssignee);\r\n    console.log('Available team members:', this.teamMembers);\r\n    \r\n    // If we have an assignee name, find the matching team member\r\n    if (assignee) {\r\n      const previousAssignee = assignee;\r\n      assignee = this.findMatchingTeamMember(assignee);\r\n      console.log(`Matching team member: '${previousAssignee}' -> '${assignee}'`);\r\n    }\r\n    \r\n    // Get type, trying both System.WorkItemType and type property\r\n    let itemType = '';\r\n    \r\n    // First try to get from Azure DevOps fields\r\n    if (item.fields) {\r\n      if (item.fields['System.WorkItemType']) {\r\n        itemType = item.fields['System.WorkItemType'];\r\n      }\r\n    }\r\n    \r\n    // If not found, fallback to type property\r\n    if (!itemType && item.type) {\r\n      itemType = item.type;\r\n    }\r\n    \r\n    // If still not found, try to determine from title\r\n    if (!itemType) {\r\n      const title = item.title.toLowerCase();\r\n      if (title.includes('bug') || title.includes('fix') || title.includes('issue')) {\r\n        itemType = 'Bug';\r\n      } else if (title.includes('feature') || title.includes('implement') || title.includes('add new')) {\r\n        itemType = 'Feature';\r\n      } else if (title.includes('change') || title.includes('modify') || title.includes('update')) {\r\n        itemType = 'Change Request';\r\n      } else if (title.includes('requirement') || title.includes('must have')) {\r\n        itemType = 'Requirement';\r\n      } else {\r\n        // Default to Feature\r\n        itemType = 'Feature';\r\n      }\r\n    }\r\n    \r\n    // Ensure the type is available in our task types list\r\n    if (itemType && !this.taskTypes.includes(itemType)) {\r\n      // Add to taskTypes if not already there\r\n      this.taskTypes.push(itemType);\r\n    }\r\n    \r\n    // Update form with extracted values\r\n    this.estimationForm.patchValue({\r\n      title: item.title,\r\n      type: itemType,\r\n      assignee: assignee,\r\n      complexity: complexity\r\n    });\r\n\r\n    console.log(`Populated form with: Type=${itemType}, Assignee=${assignee}, Complexity=${complexity}`);\r\n\r\n    // Pre-calculate estimates based on historical data if we have this information\r\n    if (this.estimationResult) {\r\n      this.calculateTimeEstimates(this.estimationResult.estimatedHours);\r\n    }\r\n  }\r\n\r\n  // Determine complexity based on work item properties with enhanced logic\r\n  determineComplexity(item: ExtendedWorkItem): string {\r\n    // Initialize with default complexity\r\n    let complexity = 'Medium';\r\n    \r\n    // Try to determine from title keywords\r\n    const title = item.title.toLowerCase();\r\n    if (title.includes('critical') || title.includes('urgent') || title.includes('major') || \r\n        title.includes('performance issue') || title.includes('security')) {\r\n      return 'High';\r\n    }\r\n    \r\n    if (title.includes('minor') || title.includes('small') || title.includes('trivial') || \r\n        title.includes('documentation') || title.includes('typo')) {\r\n      return 'Low';\r\n    }\r\n    \r\n    // Determine from type\r\n    const itemType = this.getWorkItemType(item);\r\n    if (itemType === 'Bug' || itemType === 'Change Request' || itemType === 'Feature') {\r\n      // Bugs and change requests tend to be more complex\r\n      complexity = 'Medium';\r\n      \r\n      // For bugs, increase complexity\r\n      if (itemType === 'Bug') {\r\n        complexity = 'High';\r\n      }\r\n    }\r\n    \r\n    // Determine from priority if available\r\n    if (item.priority !== undefined) {\r\n      if (item.priority <= 1) {\r\n        complexity = 'High';\r\n      } else if (item.priority === 2) {\r\n        complexity = 'Medium';\r\n      } else {\r\n        complexity = 'Low';\r\n      }\r\n    }\r\n    \r\n    // Check for complexity field if available in Azure DevOps fields\r\n    if (item.fields) {\r\n      // Different systems use different field names for complexity/effort\r\n      const complexityFields = [\r\n        'Microsoft.VSTS.Common.Complexity',\r\n        'Microsoft.VSTS.Scheduling.Effort',\r\n        'Custom.Complexity',\r\n        'System.Complexity'\r\n      ];\r\n      \r\n      for (const field of complexityFields) {\r\n        if (item.fields[field]) {\r\n          const fieldValue = item.fields[field];\r\n          if (typeof fieldValue === 'string') {\r\n            if (fieldValue.includes('High') || fieldValue.includes('1')) {\r\n              return 'High';\r\n            } else if (fieldValue.includes('Low') || fieldValue.includes('3')) {\r\n              return 'Low';\r\n            }\r\n          } else if (typeof fieldValue === 'number') {\r\n            if (fieldValue <= 1) {\r\n              return 'High';\r\n            } else if (fieldValue >= 3) {\r\n              return 'Low';\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    \r\n    return complexity;\r\n  }\r\n\r\n  // Helper method to get work item type consistently\r\n  getWorkItemType(item: ExtendedWorkItem): string {\r\n    // Try to get from System.WorkItemType first\r\n    if (item.fields && item.fields['System.WorkItemType']) {\r\n      return item.fields['System.WorkItemType'];\r\n    }\r\n    \r\n    // Fallback to type property\r\n    return item.type || 'Feature';\r\n  }\r\n\r\n  resetForm(): void {\r\n    this.estimationForm.reset({\r\n      type: 'Feature',\r\n      complexity: 'Medium'\r\n    });\r\n    this.error = null;\r\n    this.showResult = false;\r\n    this.estimationResult = null;\r\n  }\r\n\r\n  estimateTaskTime(): void {\r\n    if (this.estimationForm.invalid) {\r\n      // Mark all fields as touched to trigger validation messages\r\n      Object.keys(this.estimationForm.controls).forEach(key => {\r\n        this.estimationForm.get(key)?.markAsTouched();\r\n      });\r\n      return;\r\n    }\r\n    this.loading = true;\r\n    this.error = null;\r\n    this.estimationResult = null;\r\n    this.showResult = false;\r\n    const request: TaskEstimationRequest = {\r\n      title: this.estimationForm.value.title,\r\n      type: this.estimationForm.value.type,\r\n      assignee: this.estimationForm.value.assignee,\r\n      complexity: this.estimationForm.value.complexity\r\n    };\r\n    // Check if we have a selected work item with an ID\r\n    if (this.selectedWorkItem && this.selectedWorkItem.id) {\r\n      // Convert to number if it's a string, or use as is if it's already a number\r\n      const workItemId = typeof this.selectedWorkItem.id === 'string'\r\n        ? parseInt(this.selectedWorkItem.id, 10)\r\n        : this.selectedWorkItem.id;\r\n      \r\n      if (!isNaN(workItemId)) {\r\n        request.workItemId = workItemId;\r\n        \r\n        // First try to get the full work item history from Azure DevOps\r\n        console.log(`Fetching detailed history for work item #${workItemId}`);\r\n        this.taskService.getWorkItemWithHistory(workItemId).subscribe({\r\n          next: (detailedItem) => {\r\n            console.log(`Received detailed work item #${workItemId} with history`);\r\n            \r\n            // Check if we have activity history\r\n            if (detailedItem.activity && detailedItem.activity.length > 0) {\r\n              console.log(`Work item has ${detailedItem.activity.length} historical activities`);\r\n              \r\n              // Use the history to estimate time based on state transitions\r\n              const estimatedTimes = this.calculateEstimatesFromHistory(detailedItem);\r\n              \r\n              // Create result based on historical analysis\r\n              this.estimationResult = {\r\n                estimatedHours: estimatedTimes.total,\r\n                devTimeHours: estimatedTimes.development,\r\n                testTimeHours: estimatedTimes.testing,\r\n                confidenceScore: 0.85, // High confidence since we're using actual history\r\n                factors: [\r\n                  `Based on actual work item #${workItemId} history`,\r\n                  `Task type: ${request.type}`,\r\n                  `${request.complexity} complexity`,\r\n                  `Similar work item pattern analysis`\r\n                ]\r\n              };\r\n              \r\n              this.showResult = true;\r\n              this.loading = false;\r\n              this.devTimeEstimate = this.estimationResult.devTimeHours || 0;\r\n              this.testTimeEstimate = this.estimationResult.testTimeHours || 0;\r\n              this.totalEstimate = this.estimationResult.estimatedHours;\r\n            } else {\r\n              console.log('No activity history available, falling back to iteration-based estimation');\r\n              this.estimateFromIterationHistory(request);\r\n            }\r\n          },\r\n          error: (err) => {\r\n            console.error('Error fetching work item history:', err);\r\n            console.log('Falling back to iteration-based estimation');\r\n            this.estimateFromIterationHistory(request);\r\n          }\r\n        });\r\n        \r\n        return; // Exit early since we're handling the estimation in the subscription\r\n      }\r\n    }\r\n    \r\n    // If we don't have a work item ID or failed to retrieve it,\r\n    // fall back to our previous approach with iteration history\r\n    this.estimateFromIterationHistory(request);\r\n  }\r\n\r\n  /**\r\n   * Estimate task time using the iteration history approach (our previous implementation)\r\n   */\r\n  private estimateFromIterationHistory(request: TaskEstimationRequest): void {\r\n    // Use iteration path for historical data analysis if available\r\n    const iterationPath = (this.selectedWorkItem && this.selectedWorkItem.iterationPath) || this.manualIterationPath;\r\n    \r\n    if (iterationPath) {\r\n      request.includeHistory = true; // Signal to include work history analysis\r\n      \r\n      console.log('Estimating using work items from iteration: ' + iterationPath);\r\n      \r\n      // Get work items from this iteration for analysis\r\n      this.taskService.getTaskHistory(iterationPath).subscribe({\r\n        next: (historyItems: WorkItem[]) => {\r\n          console.log(`Retrieved ${historyItems.length} work items from iteration ${iterationPath}`);\r\n          \r\n          if (historyItems.length === 0) {\r\n            // If no historical items found, fall back to standard estimation\r\n            console.log('No historical items found, using standard estimation');\r\n            this.performStandardEstimation(request);\r\n            return;\r\n          }\r\n          \r\n          // Since we might not have actual timing data from the API,\r\n          // we'll analyze the items we have and infer timing data\r\n          const estimatedHistoricalItems = this.inferTimingData(historyItems, request.type, request.complexity);\r\n          \r\n          // Set historical data in the request\r\n          request.historicalItems = estimatedHistoricalItems;\r\n          \r\n          // Check if we have enough data to make a history-based estimate\r\n          if (estimatedHistoricalItems.length > 0) {\r\n            console.log('Using inferred historical data for estimation');\r\n            \r\n            // Calculate time estimates based on the historical data\r\n            const similarItems = this.findSimilarItems(estimatedHistoricalItems, request);\r\n            \r\n            if (similarItems.length > 0) {\r\n              // Calculate average times from similar items\r\n              const avgTotal = similarItems.reduce((sum: number, item: WorkItem) => sum + (item.actualHours || 0), 0) / similarItems.length;\r\n              const avgDev = similarItems.reduce((sum: number, item: WorkItem) => sum + (item.developmentHours || 0), 0) / similarItems.length;\r\n              const avgTest = similarItems.reduce((sum: number, item: WorkItem) => sum + (item.testingHours || 0), 0) / similarItems.length;\r\n              \r\n              // Create a result based on historical averages\r\n              this.estimationResult = {\r\n                estimatedHours: Number(avgTotal.toFixed(1)),\r\n                devTimeHours: Number(avgDev.toFixed(1)),\r\n                testTimeHours: Number(avgTest.toFixed(1)),\r\n                confidenceScore: this.calculateConfidenceScore(similarItems.length, historyItems.length),\r\n                factors: [\r\n                  `Task type: ${request.type}`,\r\n                  `${request.complexity} complexity`,\r\n                  `Based on ${similarItems.length} similar completed items`,\r\n                  `Assignee ${request.assignee || 'unassigned'}`\r\n                ]\r\n              };\r\n              \r\n              this.showResult = true;\r\n              this.loading = false;\r\n              this.devTimeEstimate = this.estimationResult.devTimeHours || 0;\r\n              this.testTimeEstimate = this.estimationResult.testTimeHours || 0;\r\n              this.totalEstimate = this.estimationResult.estimatedHours;\r\n            } else {\r\n              // No similar items found, use standard estimation\r\n              this.performStandardEstimation(request);\r\n            }\r\n          } else {\r\n            // Not enough historical data, fall back to standard estimation\r\n            this.performStandardEstimation(request);\r\n          }\r\n        },\r\n        error: (err: any) => {\r\n          console.error('Error loading work item history:', err);\r\n          console.log('Falling back to standard estimation');\r\n          this.performStandardEstimation(request);\r\n        }\r\n      });\r\n    } else {\r\n      // Fallback to standard estimation without work history\r\n      this.performStandardEstimation(request);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Perform standard estimation without using historical data\r\n   */\r\n  private performStandardEstimation(request: TaskEstimationRequest): void {\r\n    this.estimationService.estimateTaskTime(request).subscribe({\r\n      next: (result) => {\r\n        this.estimationResult = result;\r\n        this.showResult = true;\r\n        this.calculateTimeEstimates(result.estimatedHours);\r\n        this.loading = false;\r\n      },\r\n      error: (err) => {\r\n        console.error('Error estimating task time:', err);\r\n        this.error = 'Failed to estimate task time. Please try again.';\r\n        this.loading = false;\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Infer timing data for historical work items\r\n   * This adds estimated development and testing hours to work items\r\n   */\r\n  private inferTimingData(items: WorkItem[], taskType: string, complexity: string): WorkItem[] {\r\n    return items.map(item => {\r\n      // Clone the item to avoid modifying the original\r\n      const processedItem: WorkItem = { ...item };\r\n      \r\n      // If the item already has timing data, use it\r\n      if (item.actualHours && item.developmentHours && item.testingHours) {\r\n        return processedItem;\r\n      }\r\n      \r\n      // Calculate base hours based on type and complexity\r\n      const baseHours = this.getBaseHoursByType(item.type || taskType);\r\n      const multiplier = this.getComplexityMultiplier(complexity);\r\n      \r\n      // Estimate total hours\r\n      const estimatedTotal = baseHours * multiplier;\r\n      \r\n      // Estimate dev/test split\r\n      const devRatio = complexity === 'High' ? 0.7 : (complexity === 'Low' ? 0.6 : 0.65);\r\n      const devHours = estimatedTotal * devRatio;\r\n      const testHours = estimatedTotal - devHours;\r\n      \r\n      // Add the estimated hours to the item\r\n      processedItem.actualHours = Number(estimatedTotal.toFixed(1));\r\n      processedItem.developmentHours = Number(devHours.toFixed(1));\r\n      processedItem.testingHours = Number(testHours.toFixed(1));\r\n      \r\n      return processedItem;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Find similar work items based on type and complexity\r\n   */\r\n  private findSimilarItems(items: WorkItem[], request: TaskEstimationRequest): WorkItem[] {\r\n    // Filter items by type and complexity\r\n    return items.filter(item => {\r\n      // Match by type\r\n      const typeMatch = item.type?.toLowerCase() === request.type.toLowerCase();\r\n      \r\n      // Match by complexity (if available)\r\n      const itemComplexity = this.determineComplexity(item as ExtendedWorkItem);\r\n      const complexityMatch = itemComplexity.toLowerCase() === request.complexity.toLowerCase();\r\n      \r\n      // We need both to match for a \"similar\" item\r\n      return typeMatch && complexityMatch;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Calculate confidence score based on sample size\r\n   */\r\n  private calculateConfidenceScore(similarCount: number, totalCount: number): number {\r\n    // Base confidence on the number of similar items vs total items\r\n    if (similarCount === 0) return 0.5;\r\n    \r\n    // More similar items = higher confidence\r\n    const baseConfidence = Math.min(0.75, 0.5 + (similarCount / 20));\r\n    \r\n    // Add a bonus if we have a good percentage of the total\r\n    const percentageBonus = similarCount / totalCount > 0.3 ? 0.1 : 0;\r\n    \r\n    // Cap at 0.95 for historical data\r\n    return Math.min(0.95, baseConfidence + percentageBonus);\r\n  }\r\n\r\n  // Calculate development and testing time estimates\r\n  calculateTimeEstimates(totalHours: number): void {\r\n    // Typical distribution: dev 60-70%, testing 30-40%\r\n    const complexity = this.estimationForm.value.complexity;\r\n    let devRatio = 0.65; // Default dev ratio\r\n    \r\n    // Adjust ratio based on complexity\r\n    if (complexity === 'High') {\r\n      devRatio = 0.7; // Higher complexity = more dev time\r\n    } else if (complexity === 'Low') {\r\n      devRatio = 0.6; // Lower complexity = less dev time\r\n    }\r\n    \r\n    this.devTimeEstimate = Math.round(totalHours * devRatio * 10) / 10;\r\n    this.testTimeEstimate = Math.round((totalHours - this.devTimeEstimate) * 10) / 10;\r\n    this.totalEstimate = totalHours;\r\n  }\r\n\r\n  // Format confidence score as percentage\r\n  formatConfidence(score: number): string {\r\n    return `${Math.round(score * 100)}%`;\r\n  }\r\n\r\n  // Get appropriate class for confidence level\r\n  getConfidenceClass(score: number): string {\r\n    if (score >= 0.8) {\r\n      return 'bg-success';\r\n    } else if (score >= 0.6) {\r\n      return 'bg-primary';\r\n    } else if (score >= 0.4) {\r\n      return 'bg-warning';\r\n    } else {\r\n      return 'bg-danger';\r\n    }\r\n  }\r\n\r\n  // Get assignee name for display\r\n  getAssigneeName(item: ExtendedWorkItem): string {\r\n    let displayName = '';\r\n    \r\n    // Try to get from System.AssignedTo first\r\n    if (item.fields && item.fields['System.AssignedTo']) {\r\n      const assignedTo = item.fields['System.AssignedTo'];\r\n      if (typeof assignedTo === 'string') {\r\n        displayName = assignedTo;\r\n      } else if (typeof assignedTo === 'object' && assignedTo !== null) {\r\n        if (assignedTo.displayName) {\r\n          displayName = assignedTo.displayName;\r\n        }\r\n      }\r\n    }\r\n    \r\n    // Fallback to assignedTo property\r\n    if (!displayName && item.assignedTo) {\r\n      if (typeof item.assignedTo === 'string') {\r\n        displayName = item.assignedTo;\r\n      } else if (typeof item.assignedTo === 'object' && item.assignedTo !== null) {\r\n        const assigneeObj = item.assignedTo as any;\r\n        displayName = assigneeObj.displayName || assigneeObj.name || '';\r\n      }\r\n    }\r\n    \r\n    // Find matching team member for consistent display\r\n    if (displayName) {\r\n      return this.findMatchingTeamMember(displayName);\r\n    }\r\n    \r\n    return '';\r\n  }\r\n\r\n  // Get the clean state display for a work item\r\n  getStateDisplay(item: ExtendedWorkItem): string {\r\n    // First check fields for System.State\r\n    if (item.fields && item.fields['System.State']) {\r\n      const state = item.fields['System.State'];\r\n      if (typeof state === 'string') {\r\n        // Remove \"Unknown\" prefix if present\r\n        return state.replace(/unknown/i, '').trim();\r\n      }\r\n    }\r\n    \r\n    // Check for status field in the item or fields\r\n    if ((item as any).status) {\r\n      return typeof (item as any).status === 'string' ? (item as any).status : '';\r\n    }\r\n    \r\n    if (item.fields && item.fields['status']) {\r\n      return typeof item.fields['status'] === 'string' ? item.fields['status'] : '';\r\n    }\r\n    \r\n    // Fallback to item.state if available\r\n    if (item.state) {\r\n      return item.state.replace(/unknown/i, '').trim();\r\n    }\r\n    \r\n    return 'N/A'; // Default if no state available\r\n  }\r\n\r\n  /**\r\n   * Get base hours for estimation by work item type\r\n   */\r\n  private getBaseHoursByType(type: string | undefined): number {\r\n    const baseHoursByType: {[key: string]: number} = {\r\n      'Bug': 4,\r\n      'Task': 3,\r\n      'Feature': 8,\r\n      'User Story': 5,\r\n      'Change Request': 4,\r\n      'Requirement': 6,\r\n      'Documentation': 2,\r\n      'Epic': 20\r\n    };\r\n    \r\n    return type ? (baseHoursByType[type] || 4) : 4; // Default if type not found\r\n  }\r\n  \r\n  /**\r\n   * Get multiplier based on complexity\r\n   */\r\n  private getComplexityMultiplier(complexity: string): number {\r\n    const multipliers: {[key: string]: number} = {\r\n      'Low': 0.6,\r\n      'Medium': 1.0,\r\n      'High': 1.5\r\n    };\r\n    \r\n    return multipliers[complexity] || 1.0;\r\n  }\r\n\r\n  /**\r\n   * Calculate time estimates based on the work item's actual state transition history\r\n   * This analyzes the time spent in each state to estimate development and testing times\r\n   */\r\n  private calculateEstimatesFromHistory(workItem: WorkItemDetails): { total: number, development: number, testing: number } {\r\n    console.log('Calculating estimates from work item history');\r\n    \r\n    // Default result\r\n    const result = { \r\n      total: 0, \r\n      development: 0, \r\n      testing: 0 \r\n    };\r\n    \r\n    // Step 1: Extract state transitions from activity history\r\n    const stateTransitions = workItem.activity?.filter((a: ActivityLog) => a.field === 'State' || a.field === 'System.State') || [];\r\n    console.log(`Found ${stateTransitions.length} state transitions`);\r\n    \r\n    if (stateTransitions.length === 0) {\r\n      // No state transitions found, estimate based on work item type and complexity\r\n      const complexity = this.determineComplexity(workItem as ExtendedWorkItem);\r\n      const baseHours = this.getBaseHoursByType(this.getWorkItemType(workItem as ExtendedWorkItem));\r\n      const multiplier = this.getComplexityMultiplier(complexity);\r\n      \r\n      result.total = Number((baseHours * multiplier).toFixed(1));\r\n      result.development = Number((result.total * 0.65).toFixed(1));\r\n      result.testing = Number((result.total * 0.35).toFixed(1));\r\n      \r\n      return result;\r\n    }\r\n    \r\n    // Sort transitions by date\r\n    stateTransitions.sort((a: ActivityLog, b: ActivityLog) => {\r\n      const dateA = new Date(a.changedDate).getTime();\r\n      const dateB = new Date(b.changedDate).getTime();\r\n      return dateA - dateB;\r\n    });\r\n    \r\n    // Step 2: Create a timeline of state changes with durations\r\n    const timeline: { state: string, startDate: Date, endDate?: Date, durationHours?: number }[] = [];\r\n    \r\n    // Add each transition\r\n    stateTransitions.forEach((transition: ActivityLog, index: number) => {\r\n      const currentState = transition.newValue || '';\r\n      const startDate = new Date(transition.changedDate);\r\n      \r\n      // Add to timeline\r\n      timeline.push({\r\n        state: currentState,\r\n        startDate: startDate\r\n      });\r\n      \r\n      // Set end date for previous state\r\n      if (index > 0) {\r\n        timeline[index - 1].endDate = startDate;\r\n        \r\n        // Calculate duration in hours for previous state\r\n        const prevStartDate = timeline[index - 1].startDate;\r\n        const durationMs = startDate.getTime() - prevStartDate.getTime();\r\n        const durationHours = durationMs / (1000 * 60 * 60);\r\n        \r\n        // Account for work hours (8 hours per day, 5 days per week)\r\n        // This is a simplification - in reality, you'd want to account for weekends and working hours\r\n        let adjustedHours = durationHours;\r\n        \r\n        // If duration is more than 16 hours, assume some of it is non-working time\r\n        if (durationHours > 16) {\r\n          // Roughly estimate working hours\r\n          const days = Math.floor(durationHours / 24);\r\n          const workDays = Math.max(Math.ceil(days * 5/7), 1); // Estimate work days (5/7 of total days)\r\n          adjustedHours = workDays * 8 + (durationHours % 24); // 8 hours per work day + remainder\r\n          \r\n          // Cap at a reasonable value to prevent outliers\r\n          adjustedHours = Math.min(adjustedHours, durationHours * 0.6);\r\n        }\r\n        \r\n        timeline[index - 1].durationHours = Number(adjustedHours.toFixed(1));\r\n      }\r\n    });\r\n\r\n    // Add current state if item is not completed\r\n    if (workItem.state !== 'Closed' && workItem.state !== 'Done' && workItem.state !== 'Completed') {\r\n      // Calculate duration to now for the last state\r\n      const lastIndex = timeline.length - 1;\r\n      if (lastIndex >= 0) {\r\n        const now = new Date();\r\n        timeline[lastIndex].endDate = now;\r\n        \r\n        const durationMs = now.getTime() - timeline[lastIndex].startDate.getTime();\r\n        const durationHours = durationMs / (1000 * 60 * 60);\r\n        \r\n        // Apply same adjustment for work hours\r\n        let adjustedHours = durationHours;\r\n        if (durationHours > 16) {\r\n          const days = Math.floor(durationHours / 24);\r\n          const workDays = Math.max(Math.ceil(days * 5/7), 1);\r\n          adjustedHours = workDays * 8 + (durationHours % 24);\r\n          adjustedHours = Math.min(adjustedHours, durationHours * 0.6);\r\n        }\r\n        \r\n        timeline[lastIndex].durationHours = Number(adjustedHours.toFixed(1));\r\n      }\r\n    }\r\n    \r\n    // Step 3: Categorize times as development or testing\r\n    timeline.forEach(entry => {\r\n      if (!entry.durationHours) return;\r\n      \r\n      const state = entry.state.toLowerCase();\r\n      \r\n      // Categorize states\r\n      if (state.includes('new') || state.includes('proposed') || state.includes('backlog')) {\r\n        // Planning time - not counted in the estimate\r\n      } else if (state.includes('active') || state.includes('progress') || state.includes('development')) {\r\n        // Development time\r\n        result.development += entry.durationHours;\r\n      } else if (state.includes('review') || state.includes('test') || state.includes('qa')) {\r\n        // Testing/Review time\r\n        result.testing += entry.durationHours;\r\n      } else if (state.includes('resolved') || state.includes('done') || state.includes('closed')) {\r\n        // Completion time - typically minimal, add to testing\r\n        result.testing += entry.durationHours * 0.5;\r\n      } else {\r\n        // Unknown state, distribute proportionally\r\n        result.development += entry.durationHours * 0.6;\r\n        result.testing += entry.durationHours * 0.4;\r\n      }\r\n    });\r\n    \r\n    // Step 4: Calculate total time\r\n    result.total = Number((result.development + result.testing).toFixed(1));\r\n    \r\n    // Ensure we have a minimum reasonable value\r\n    if (result.total < 0.5) {\r\n      // If calculated time is too small, use type/complexity approach as fallback\r\n      const complexity = this.determineComplexity(workItem as ExtendedWorkItem);\r\n      const baseHours = this.getBaseHoursByType(this.getWorkItemType(workItem as ExtendedWorkItem));\r\n      const multiplier = this.getComplexityMultiplier(complexity);\r\n      \r\n      result.total = Number((baseHours * multiplier).toFixed(1));\r\n      result.development = Number((result.total * 0.65).toFixed(1));\r\n      result.testing = Number((result.total * 0.35).toFixed(1));\r\n    }\r\n    \r\n    // Round to 1 decimal place\r\n    result.development = Number(result.development.toFixed(1));\r\n    result.testing = Number(result.testing.toFixed(1));\r\n    \r\n    console.log(`Estimated from history: Total=${result.total}, Dev=${result.development}, Test=${result.testing}`);\r\n    return result;\r\n  }\r\n} ","<div class=\"container-fluid p-4\">\r\n  <div class=\"row mb-4\">\r\n    <div class=\"col-12\">\r\n      <h2 class=\"mb-0\">ML-Based Task Estimation</h2>\r\n      <p class=\"text-muted mt-2\">Estimate task duration using machine learning predictions based on historical data</p>\r\n    </div>\r\n  </div>\r\n\r\n  <!-- Iteration Path Selection -->\r\n  <div class=\"row mb-4\">\r\n    <div class=\"col-12\">\r\n      <div class=\"card\">\r\n        <div class=\"card-header\">\r\n          <h4 class=\"card-title mb-0\">Enter Iteration Path</h4>\r\n        </div>\r\n        <div class=\"card-body\">\r\n          <div class=\"row g-3 align-items-center\">\r\n            <div class=\"col-md-6\">\r\n              <div class=\"input-group\">\r\n                <label class=\"input-group-text\" for=\"manualIterationPath\">Iteration Path</label>\r\n                <input \r\n                  type=\"text\" \r\n                  class=\"form-control\" \r\n                  id=\"manualIterationPath\" \r\n                  [(ngModel)]=\"manualIterationPath\"\r\n                  placeholder=\"Enter iteration path (e.g. Techoil\\2.3.23)\" \r\n                  aria-label=\"Manual Iteration Path\">\r\n                <button \r\n                  class=\"btn btn-outline-primary\" \r\n                  type=\"button\" \r\n                  (click)=\"loadWorkItemsByIteration()\"\r\n                  [disabled]=\"!manualIterationPath\">\r\n                  <i class=\"bi bi-search\"></i> Load Items\r\n                </button>\r\n              </div>\r\n              <div *ngIf=\"iterationError\" class=\"text-danger mt-2\">\r\n                <small>{{ iterationError }}</small>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"row\">\r\n    <!-- Work Items List -->\r\n    <div class=\"col-md-6\">\r\n      <div class=\"card\">\r\n        <div class=\"card-header d-flex justify-content-between align-items-center\">\r\n          <h4 class=\"card-title mb-0\">Work Items</h4>\r\n          <span *ngIf=\"workItems.length > 0\" class=\"badge bg-primary\">{{ workItems.length }} items</span>\r\n        </div>\r\n        <div class=\"card-body\">\r\n          <!-- Loading indicator -->\r\n          <div *ngIf=\"loadingIterationItems\" class=\"text-center py-4\">\r\n            <div class=\"spinner-border text-primary\" role=\"status\">\r\n              <span class=\"visually-hidden\">Loading work items...</span>\r\n            </div>\r\n            <p class=\"mt-2 text-muted\">Loading work items...</p>\r\n          </div>\r\n          \r\n          <!-- No items message -->\r\n          <div *ngIf=\"!loadingIterationItems && workItems.length === 0 && !iterationError\" class=\"text-center py-4\">\r\n            <p class=\"text-muted\">No work items found. Please select an iteration path and click \"Load Items\".</p>\r\n          </div>\r\n          \r\n          <!-- Work items table -->\r\n          <div *ngIf=\"!loadingIterationItems && workItems.length > 0\" class=\"table-responsive\">\r\n            <table class=\"table table-hover table-striped\">\r\n              <thead>\r\n                <tr>\r\n                  <th scope=\"col\">ID</th>\r\n                  <th scope=\"col\">Type</th>\r\n                  <th scope=\"col\">Title</th>\r\n                  <th scope=\"col\">Assignee</th>\r\n                  <th scope=\"col\">State</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                <tr *ngFor=\"let item of workItems\" \r\n                    [class.table-primary]=\"selectedWorkItem?.id === item.id\"\r\n                    (click)=\"selectWorkItem(item)\"\r\n                    style=\"cursor: pointer;\">\r\n                  <td class=\"fw-bold\">#{{ item.id }}</td>\r\n                  <td>\r\n                    <span class=\"badge rounded-pill\" [ngClass]=\"{\r\n                      'bg-danger': item.type === 'Bug' || (item.fields && item.fields['System.WorkItemType'] === 'Bug'),\r\n                      'bg-primary': item.type === 'Feature' || (item.fields && item.fields['System.WorkItemType'] === 'Feature'),\r\n                      'bg-warning': item.type === 'Change Request' || (item.fields && item.fields['System.WorkItemType'] === 'Change Request'),\r\n                      'bg-info': item.type === 'Test' || (item.fields && item.fields['System.WorkItemType'] === 'Test'),\r\n                      'bg-success': item.type === 'Requirement' || (item.fields && item.fields['System.WorkItemType'] === 'Requirement'),\r\n                      'bg-dark text-light': item.type === 'User Story' || (item.fields && item.fields['System.WorkItemType'] === 'User Story'),\r\n                      'bg-secondary': !item.type && (!item.fields || !item.fields['System.WorkItemType'])\r\n                    }\">{{ (item.fields && item.fields['System.WorkItemType']) || item.type || 'Task' }}</span>\r\n                  </td>\r\n                  <td>{{ item.title }}</td>\r\n                  <td><small><i class=\"bi bi-person me-1\"></i>{{ getAssigneeName(item) || 'Unassigned' }}</small></td>\r\n                  <td>\r\n                    <span class=\"badge\" [ngClass]=\"{\r\n                      'badge-code-review': getStateDisplay(item) && getStateDisplay(item).toLowerCase() === 'code review',\r\n                      'badge-dev-new': getStateDisplay(item) && getStateDisplay(item).toLowerCase() === 'dev-new',\r\n                      'bg-info': getStateDisplay(item) && getStateDisplay(item).toLowerCase().includes('review') && getStateDisplay(item).toLowerCase() !== 'code review',\r\n                      'bg-primary': getStateDisplay(item) && getStateDisplay(item).toLowerCase().includes('progress'),\r\n                      'bg-success': getStateDisplay(item) && (getStateDisplay(item).toLowerCase().includes('complete') || \r\n                                   getStateDisplay(item).toLowerCase().includes('done')),\r\n                      'bg-warning': getStateDisplay(item) && (getStateDisplay(item).toLowerCase().includes('pending') || \r\n                                   getStateDisplay(item).toLowerCase().includes('wait')),\r\n                      'bg-danger': getStateDisplay(item) && (getStateDisplay(item).toLowerCase().includes('fail') || \r\n                                 getStateDisplay(item).toLowerCase().includes('block')),\r\n                      'bg-dark': getStateDisplay(item) && getStateDisplay(item).toLowerCase().includes('new') && getStateDisplay(item).toLowerCase() !== 'dev-new',\r\n                      'badge-ready': getStateDisplay(item) && getStateDisplay(item).toLowerCase().includes('ready'),\r\n                      'badge-assigned': getStateDisplay(item) && getStateDisplay(item).toLowerCase().includes('assign'),\r\n                      'bg-info text-white': getStateDisplay(item) && (\r\n                        getStateDisplay(item).toLowerCase().includes('test') ||\r\n                        (getStateDisplay(item).toLowerCase().includes('review') && getStateDisplay(item).toLowerCase() !== 'code review')),\r\n                      'badge-na': !getStateDisplay(item) || getStateDisplay(item) === 'N/A'\r\n                    }\">{{ getStateDisplay(item) || 'N/A' }}</span>\r\n                  </td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Task Estimation Form -->\r\n    <div class=\"col-md-6\">\r\n      <div class=\"card\">\r\n        <div class=\"card-header\">\r\n          <h4 class=\"card-title mb-0\">\r\n            <span *ngIf=\"selectedWorkItem\">Task #{{ selectedWorkItem.id }} Details</span>\r\n            <span *ngIf=\"!selectedWorkItem\">Task Details</span>\r\n          </h4>\r\n        </div>\r\n        <div class=\"card-body\">\r\n          <form [formGroup]=\"estimationForm\" (ngSubmit)=\"estimateTaskTime()\">\r\n            <!-- Task Title -->\r\n            <div class=\"mb-3\">\r\n              <label for=\"taskTitle\" class=\"form-label\">Task Title</label>\r\n              <div class=\"input-group\">\r\n                <input \r\n                  type=\"text\" \r\n                  class=\"form-control\" \r\n                  id=\"taskTitle\" \r\n                  formControlName=\"title\"\r\n                  placeholder=\"Enter or select task title\"\r\n                  [ngClass]=\"{'is-valid': selectedWorkItem !== null}\">\r\n                <button \r\n                  *ngIf=\"estimationForm.get('title')?.value\"\r\n                  class=\"btn btn-outline-secondary\" \r\n                  type=\"button\"\r\n                  (click)=\"resetForm()\">\r\n                  <i class=\"bi bi-x-lg\"></i>\r\n                </button>\r\n              </div>\r\n              <div *ngIf=\"estimationForm.get('title')?.invalid && estimationForm.get('title')?.touched\" class=\"text-danger mt-1\">\r\n                <small *ngIf=\"estimationForm.get('title')?.errors?.['required']\">Title is required</small>\r\n                <small *ngIf=\"estimationForm.get('title')?.errors?.['minlength']\">Title must be at least 5 characters</small>\r\n              </div>\r\n              <div *ngIf=\"selectedWorkItem\" class=\"text-success mt-1\">\r\n                <small>Found matching work item #{{ selectedWorkItem.id }}</small>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"row\">\r\n              <div class=\"col-md-6\">\r\n                <!-- Task Type -->\r\n                <div class=\"mb-3\">\r\n                  <label for=\"taskType\" class=\"form-label\">Task Type</label>\r\n                  <select class=\"form-select\" id=\"taskType\" formControlName=\"type\">\r\n                    <option *ngFor=\"let type of taskTypes\" [value]=\"type\">{{ type }}</option>\r\n                  </select>\r\n                </div>\r\n              </div>\r\n              \r\n              <div class=\"col-md-6\">\r\n                <!-- Assignee -->\r\n                <div class=\"mb-3\">\r\n                  <label for=\"assignee\" class=\"form-label\">Assignee</label>\r\n                  <select class=\"form-select\" id=\"assignee\" formControlName=\"assignee\">\r\n                    <option value=\"\">-- Unassigned --</option>\r\n                    <option *ngFor=\"let member of teamMembers\" [value]=\"member\">{{ member }}</option>\r\n                  </select>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Complexity -->\r\n            <div class=\"mb-3\">\r\n              <label class=\"form-label\">Complexity</label>\r\n              <div class=\"d-flex\">\r\n                <div class=\"form-check me-3\" *ngFor=\"let level of complexityLevels\">\r\n                  <input \r\n                    class=\"form-check-input\" \r\n                    type=\"radio\" \r\n                    [id]=\"'complexity-' + level.toLowerCase()\" \r\n                    [value]=\"level\" \r\n                    formControlName=\"complexity\">\r\n                  <label class=\"form-check-label\" [for]=\"'complexity-' + level.toLowerCase()\">\r\n                    {{ level }}\r\n                  </label>\r\n                </div>\r\n              </div>\r\n              <div *ngIf=\"selectedWorkItem\" class=\"text-muted mt-1\">\r\n                <small><i class=\"bi bi-info-circle\"></i> Complexity automatically predicted based on work item attributes</small>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Action Buttons -->\r\n            <div class=\"d-flex justify-content-between mt-4\">\r\n              <button type=\"button\" class=\"btn btn-secondary\" (click)=\"resetForm()\">\r\n                <i class=\"bi bi-arrow-counterclockwise\"></i> Reset\r\n              </button>\r\n              <button type=\"submit\" class=\"btn btn-primary\" [disabled]=\"loading\">\r\n                <span *ngIf=\"!loading\">\r\n                  <i class=\"bi bi-stopwatch\"></i> Estimate Time\r\n                </span>\r\n                <span *ngIf=\"loading\">\r\n                  <span class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n                  Estimating...\r\n                </span>\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"row mt-4\">\r\n    <div class=\"col-md-12\">\r\n      <!-- Error Display -->\r\n      <div *ngIf=\"error\" class=\"alert alert-danger mb-4\">\r\n        {{ error }}\r\n      </div>\r\n\r\n      <!-- Estimation Results -->\r\n      <div *ngIf=\"showResult && estimationResult\" class=\"card\">\r\n        <div class=\"card-header bg-primary text-white\">\r\n          <h4 class=\"card-title mb-0\">Estimation Results</h4>\r\n        </div>\r\n        <div class=\"card-body\">\r\n          <div class=\"row\">\r\n            <div class=\"col-md-6\">\r\n              <div class=\"mb-4 text-center\">\r\n                <h2 class=\"display-4 mb-0\">{{ estimationResult.estimatedHours }} hours</h2>\r\n                <p class=\"text-muted\">Total estimated time</p>\r\n              </div>\r\n\r\n              <div class=\"row text-center mb-4\">\r\n                <div class=\"col-6\">\r\n                  <div class=\"p-3 bg-light rounded\">\r\n                    <h3 class=\"mb-0\">{{ devTimeEstimate }}</h3>\r\n                    <p class=\"text-muted mb-0\">Development Time</p>\r\n                  </div>\r\n                </div>\r\n                <div class=\"col-6\">\r\n                  <div class=\"p-3 bg-light rounded\">\r\n                    <h3 class=\"mb-0\">{{ testTimeEstimate }}</h3>\r\n                    <p class=\"text-muted mb-0\">Testing Time</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <div class=\"mb-4\">\r\n                <h5>Prediction Confidence</h5>\r\n                <div class=\"progress\">\r\n                  <div \r\n                    class=\"progress-bar\" \r\n                    [ngClass]=\"getConfidenceClass(estimationResult.confidenceScore)\"\r\n                    [style.width.%]=\"estimationResult.confidenceScore * 100\" \r\n                    role=\"progressbar\" \r\n                    [attr.aria-valuenow]=\"estimationResult.confidenceScore * 100\" \r\n                    aria-valuemin=\"0\" \r\n                    aria-valuemax=\"100\">\r\n                    {{ formatConfidence(estimationResult.confidenceScore) }}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"col-md-6\">\r\n              <h5>Factors Considered</h5>\r\n              <ul class=\"list-group\">\r\n                <li class=\"list-group-item\" *ngFor=\"let factor of estimationResult.factors\">\r\n                  {{ factor }}\r\n                </li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"card-footer text-muted small\">\r\n          <i class=\"bi bi-info-circle\"></i> These estimates are based on historical work item data from Azure DevOps, analyzing completed tasks with similar characteristics.\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Placeholder when no result is shown -->\r\n      <div *ngIf=\"!showResult && !error\" class=\"card bg-light\">\r\n        <div class=\"card-body text-center p-5\">\r\n          <i class=\"bi bi-graph-up display-1 text-muted\"></i>\r\n          <h4 class=\"mt-3\">Task Time Prediction</h4>\r\n          <p class=\"text-muted\">Fill in the task details and click \"Estimate Time\" to get an ML-based time estimate</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div> "]},"metadata":{},"sourceType":"module","externalDependencies":[]}